[2026-02-11 10:52:53.749] SSH LOG FILE CLEARED - Starting new project execution
================================================================================

2026-02-11 10:52:53 [INFO] SSH log file cleared at 2026-02-11 10:52:53.749
2026-02-11 10:52:53 [INFO] 
================================================================================
[2026-02-11 10:52:53.980] SSH CONNECTION: login - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user
Auth Type: password
Connection Type: ssh
================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.130] SSH CHECK: SUDO - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo -n id

>>> EXIT CODE: 0

>>> STDOUT:
uid=0(root) gid=0(root) группы=0(root)

================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.260] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/sssd/sssd.conf

>>> EXIT CODE: 0

>>> STDOUT:
[sssd]
config_version=2
services = pam

[domain/ad.example.com]
auth_provider = ad

simple_allow_users = user1,user2,user3
simple_allow_groups = group1,group1,group3


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.310] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 9d1c22b4-713e-4b7f-ba5c-1385c25bf586
Script Name: sssd.conf - users

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash
# ФИНАЛЬНАЯ ИСПРАВЛЕННАЯ ВЕРСИЯ
# Исправлены все проблемы:
# 1. Правильное регулярное выражение [^#[:space:]] вместо [^#]
# 2. Безопасная обработка многострочных переменных
# 3. Убрано set -u чтобы избежать проблем с переменными окружения

set -eo pipefail  # Убрали -u чтобы избежать проблем

# CHECK_OUTPUT — уже содержит вывод команды с хоста
# ETALON_INPUT — эталонные данные

# Безопасная проверка переменных (обрабатывает многострочные значения)
if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

if [ -z "${ETALON_INPUT:-}" ]; then
    exit 51
fi
... (total 112 lines, 3894 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 166 chars, 10 lines:
[sssd]
config_version=2
services = pam

[domain/ad.example.com]
auth_provider = ad

simple_allow_users = user1,user2,user3
simple_allow_groups = group1,group1,group3


>>> REFERENCE DATA (ETALON_INPUT) - 19 chars, 3 lines:
user1
user2
user123

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (209 chars):
ACTUAL_DATA: user1,user2,user3
DEBUG: actual_normalized='user1,user2,user3'
DEBUG: expected_normalized='user1,user123,user2'
DEBUG: expected_count=3, actual_count=3
DEBUG: элемент 'user123' не найден в actual


>>> STDERR (2217 chars):
+ set -eo pipefail
+ '[' -z '[sssd]
config_version=2
services = pam

[domain/ad.example.com]
auth_provider = ad

simple_allow_users = user1,user2,user3
simple_allow_groups = group1,group1,group3
' ']'
+ '[' -z 'user1
user2
user123' ']'
++ echo '[sssd]
config_version=2
services = pam

[domain/ad.example.com]
auth_provider = ad

simple_allow_users = user1,user2,user3
simple_allow_groups = group1,group1,group3
'
++ grep -E '^[[:space:]]*simple_allow_users[[:space:]]*='
++ grep -vE '^[[:space:]]*#'
+ line='simple_allow_users = user1,user2,user3'
+ [[ -z simple_allow_users = user1,user2,user3 ]]
++ echo 'simple_allow_users = user1,user2,user3'
++ sed 's/^[^=]*=//'
++ tr -d ' '
+ actual=user1,user2,user3
++ normalize 'user1
user2
user123'
++ local 'input=user1
user2
user123'
++ echo 'user1
user2
user123'
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ expected_normalized=user1,user123,user2
++ normalize user1,user2,user3
++ local input=user1,user2,user3
++ echo user1,user2,user3
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ sort -u
++ tr '\n' ,
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sed 's/,$//'
+ actual_normalized=user1,user2,user3
+ echo 'ACTUAL_DATA: user1,user2,user3'
+ echo 'DEBUG: actual_normalized='\''user1,user2,user3'\'''
+ echo 'DEBUG: expected_normalized='\''user1,user123,user2'\'''
+ IFS=,
+ read -ra expected_array
+ IFS=,
+ read -ra actual_array
+ expected_count=3
+ actual_count=3
+ echo 'DEBUG: expected_count=3, actual_count=3'
+ [[ 3 -ne 3 ]]
+ all_found=true
+ for expected_item in "${expected_array[@]}"
+ found=false
+ for actual_item in "${actual_array[@]}"
+ [[ user1 == \u\s\e\r\1 ]]
+ found=true
+ break
+ [[ true == false ]]
+ for expected_item in "${expected_array[@]}"
+ found=false
+ for actual_item in "${actual_array[@]}"
+ [[ user123 == \u\s\e\r\1 ]]
+ for actual_item in "${actual_array[@]}"
+ [[ user123 == \u\s\e\r\2 ]]
+ for actual_item in "${actual_array[@]}"
+ [[ user123 == \u\s\e\r\3 ]]
+ [[ false == false ]]
+ all_found=false
+ echo 'DEBUG: элемент '\''user123'\'' не найден в actual'
+ break
+ [[ false == true ]]
+ exit 44

================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.438] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/pam.d/common-auth

>>> EXIT CODE: 0

>>> STDOUT:
#
# /etc/pam.d/common-auth - authentication settings common to all services
#
# This file is included from other service-specific PAM config files,
# and should contain a list of the authentication modules that define
# the central authentication scheme for use on the system
# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
# traditional Unix authentication mechanisms.
#
# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
# To take advantage of this, it is recommended that you configure any
# local modules either before or after the default block, and use
# pam-auth-update to manage selection of other modules.  See
# pam-auth-update(8) for details.

# here are the per-package modules (the "Primary" block)
auth	[success=ignore default=2]	pam_localuser.so 
auth	[success=1 default=ignore]	pam_succeed_if.so quiet user ingroup astra-admin
auth	[success=ignore default=die]	pam_tally.so per_user deny=8
auth	[success=1 default=ignore]	pam_unix.so nullok_secure try_first_pass
# here's the fallback if no module succeeds
auth	requisite			pam_deny.so
# prime the stack with a positive return value if there isn't one already;
# this avoids us returning an error just because nothing sets a success code
# since the modules above will each just jump around
auth	required			pam_permit.so
# and here are more per-package modules (the "Additional" block)
# end of pam-auth-update config
#require_membership_of = group1,group2


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.462] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 91e008dd-57f4-4c34-8caf-9ebb4a84bb45
Script Name: winbind - groups

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail  

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

if [ -z "${ETALON_INPUT:-}" ]; then
    exit 51
fi

# Ищем строку с require_membership_of= (может быть в контексте pam_winbind.so или отдельно)
# Сначала попробуем найти в контексте pam_winbind.so (собираем многострочную строку)
pam_line="$(echo "$CHECK_OUTPUT" \
    | awk '
        /pam_winbind\.so/ {
            inblock=1
        }
        inblock {
... (total 131 lines, 4485 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 1469 chars, 30 lines:
#
# /etc/pam.d/common-auth - authentication settings common to all services
#
# This file is included from other service-specific PAM config files,
# and should contain a list of the authentication modules that define
# the central authentication scheme for use on the system
# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
# traditional Unix authentication mechanisms.
#
# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
# To take advantage of this, it is recommended that you configure any
# local modules either before or after the default block, and use
# pam-auth-update to manage selection of other modules.  See
# pam-auth-update(8) for details.

# here are the per-package modules (the "Primary" block)
auth	[success=ignore default=2]	pam_localuser.so 
auth	[success=1 default=ignore]	pam_succeed_if.so quiet user ingroup astra-admin
auth	[success=ignore default=die]	pam_tally.so per_user deny=8
auth	[success=1 default=ignore]	pam_unix.so nullok_secure try_first_pass
# here's the fallback if no module succeeds
auth	requisite			pam_deny.so
# prime the stack with a positive return value if there isn't one already;
# this avoids us returning an error just because nothing sets a success code
# since the modules above will each just jump around
auth	required			pam_permit.so
# and here are more per-package modules (the "Additional" block)
# end of pam-auth-update config
#require_membership_of = group1,group2


>>> REFERENCE DATA (ETALON_INPUT) - 24 chars, 4 lines:
group1
gorpu2
root
cdrom

>>> EXIT CODE: 42 (Строка закомментирована)

>>> STDOUT (0 chars):
(empty)

>>> STDERR (6470 chars):
+ set -eo pipefail
+ '[' -z '#
# /etc/pam.d/common-auth - authentication settings common to all services
#
# This file is included from other service-specific PAM config files,
# and should contain a list of the authentication modules that define
# the central authentication scheme for use on the system
# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
# traditional Unix authentication mechanisms.
#
# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
# To take advantage of this, it is recommended that you configure any
# local modules either before or after the default block, and use
# pam-auth-update to manage selection of other modules.  See
# pam-auth-update(8) for details.

# here are the per-package modules (the "Primary" block)
auth	[success=ignore default=2]	pam_localuser.so 
auth	[success=1 default=ignore]	pam_succeed_if.so quiet user ingroup astra-admin
auth	[success=ignore default=die]	pam_tally.so per_user deny=8
auth	[success=1 default=ignore]	pam_unix.so nullok_secure try_first_pass
# here'\''s the fallback if no module succeeds
auth	requisite			pam_deny.so
# prime the stack with a positive return value if there isn'\''t one already;
# this avoids us returning an error just because nothing sets a success code
# since the modules above will each just jump around
auth	required			pam_permit.so
# and here are more per-package modules (the "Additional" block)
# end of pam-auth-update config
#require_membership_of = group1,group2
' ']'
+ '[' -z 'group1
gorpu2
root
cdrom' ']'
++ echo '#
# /etc/pam.d/common-auth - authentication settings common to all services
#
# This file is included from other service-specific PAM config files,
# and should contain a list of the authentication modules that define
# the central authentication scheme for use on the system
# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
# traditional Unix authentication mechanisms.
#
# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
# To take advantage of this, it is recommended that you configure any
# local modules either before or after the default block, and use
# pam-auth-update to manage selection of other modules.  See
# pam-auth-update(8) for details.

# here are the per-package modules (the "Primary" block)
auth	[success=ignore default=2]	pam_localuser.so 
auth	[success=1 default=ignore]	pam_succeed_if.so quiet user ingroup astra-admin
auth	[success=ignore default=die]	pam_tally.so per_user deny=8
auth	[success=1 default=ignore]	pam_unix.so nullok_secure try_first_pass
# here'\''s the fallback if no module succeeds
auth	requisite			pam_deny.so
# prime the stack with a positive return value if there isn'\''t one already;
# this avoids us returning an error just because nothing sets a success code
# since the modules above will each just jump around
auth	required			pam_permit.so
# and here are more per-package modules (the "Additional" block)
# end of pam-auth-update config
#require_membership_of = group1,group2
'
++ awk '
        /pam_winbind\.so/ {
            inblock=1
        }
        inblock {
            line = line $0 " "
            if ($0 !~ /\\[[:space:]]*$/) {
                print line
                exit
            }
            next
        }
    '
+ pam_line=
+ [[ -n '' ]]
++ echo '#
# /etc/pam.d/common-auth - authentication settings common to all services
#
# This file is included from other service-specific PAM config files,
# and should contain a list of the authentication modules that define
# the central authentication scheme for use on the system
# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
# traditional Unix authentication mechanisms.
#
# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
# To take advantage of this, it is recommended that you configure any
# local modules either before or after the default block, and use
# pam-auth-update to manage selection of other modules.  See
# pam-auth-update(8) for details.

# here are the per-package modules (the "Primary" block)
auth	[success=ignore default=2]	pam_localuser.so 
auth	[success=1 default=ignore]	pam_succeed_if.so quiet user ingroup astra-admin
auth	[success=ignore default=die]	pam_tally.so per_user deny=8
auth	[success=1 default=ignore]	pam_unix.so nullok_secure try_first_pass
# here'\''s the fallback if no module succeeds
auth	requisite			pam_deny.so
# prime the stack with a positive return value if there isn'\''t one already;
# this avoids us returning an error just because nothing sets a success code
# since the modules above will each just jump around
auth	required			pam_permit.so
# and here are more per-package modules (the "Additional" block)
# end of pam-auth-update config
#require_membership_of = group1,group2
'
++ grep -E 'require_membership_of[[:space:]]*='
++ grep -vE '^[[:space:]]*#'
++ true
+ line=
+ [[ -z '' ]]
+ echo '#
# /etc/pam.d/common-auth - authentication settings common to all services
#
# This file is included from other service-specific PAM config files,
# and should contain a list of the authentication modules that define
# the central authentication scheme for use on the system
# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
# traditional Unix authentication mechanisms.
#
# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
# To take advantage of this, it is recommended that you configure any
# local modules either before or after the default block, and use
# pam-auth-update to manage selection of other modules.  See
# pam-auth-update(8) for details.

# here are the per-package modules (the "Primary" block)
auth	[success=ignore default=2]	pam_localuser.so 
auth	[success=1 default=ignore]	pam_succeed_if.so quiet user ingroup astra-admin
auth	[success=ignore default=die]	pam_tally.so per_user deny=8
auth	[success=1 default=ignore]	pam_unix.so nullok_secure try_first_pass
# here'\''s the fallback if no module succeeds
auth	requisite			pam_deny.so
# prime the stack with a positive return value if there isn'\''t one already;
# this avoids us returning an error just because nothing sets a success code
# since the modules above will each just jump around
auth	required			pam_permit.so
# and here are more per-package modules (the "Additional" block)
# end of pam-auth-update config
#require_membership_of = group1,group2
'
+ grep -qE '^[[:space:]]*#.*require_membership_of[[:space:]]*='
+ exit 42

================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.594] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo getent passwd

>>> EXIT CODE: 0

>>> STDOUT:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.627] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 497f0cc5-f03a-4a80-8dfa-c45574eed1db
Script Name: getent passwd

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail  

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

if [ -z "${ETALON_INPUT:-}" ]; then
    exit 51
fi

# Парсим вывод getent passwd: извлекаем первый элемент (имя пользователя) до первого двоеточия
# Формат getent passwd: username:password:uid:gid:gecos:home:shell
# Нам нужен только username (первый элемент)
actual_users="$(echo "$CHECK_OUTPUT" | awk -F':' '{print $1}' | grep -v '^$' | sort -u | tr '\n' ',' | sed 's/,$//')"

if [[ -z "$actual_users" ]]; then
    exit 41 # Список пользователей пуст → "Не пройдена"
fi
... (total 85 lines, 2624 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 2100 chars, 39 lines:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash


>>> REFERENCE DATA (ETALON_INPUT) - 19 chars, 3 lines:
user1
user2
user123

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (779 chars):
ACTUAL_DATA: Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data
DEBUG: actual_normalized='Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data'
DEBUG: expected_normalized='user1,user123,user2'
DEBUG: expected_count=3, actual_count=38
DEBUG: количество элементов не совпадает (эталон: 3, actual: 38)


>>> STDERR (7605 chars):
+ set -eo pipefail
+ '[' -z 'root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
' ']'
+ '[' -z 'user1
user2
user123' ']'
++ echo 'root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
'
++ awk -F: '{print $1}'
++ grep -v '^$'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ actual_users=Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data
+ [[ -z Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data ]]
++ normalize 'user1
user2
user123'
++ local 'input=user1
user2
user123'
++ echo 'user1
user2
user123'
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ tr '\n' ,
++ sort -u
++ sed 's/,$//'
+ expected_normalized=user1,user123,user2
++ normalize Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data
++ local input=Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data
++ echo Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ actual_normalized=Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data
+ echo 'ACTUAL_DATA: Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data'
+ echo 'DEBUG: actual_normalized='\''Debian-exim,_apt,astra-orientation,avahi,backup,bin,daemon,dnsmasq,fly-dm,games,gnats,hplip,irc,list,logcheck,lp,mail,man,messagebus,news,nm-openvpn,nobody,ntp,postgres,proxy,pulse,root,saned,sshd,sync,sys,systemd-bus-proxy,systemd-network,systemd-resolve,systemd-timesync,user,uucp,www-data'\'''
+ echo 'DEBUG: expected_normalized='\''user1,user123,user2'\'''
+ IFS=,
+ read -ra expected_array
+ IFS=,
+ read -ra actual_array
+ expected_count=3
+ actual_count=38
+ echo 'DEBUG: expected_count=3, actual_count=38'
+ [[ 3 -ne 38 ]]
+ echo 'DEBUG: количество элементов не совпадает (эталон: 3, actual: 38)'
+ exit 44

================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.765] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo getent group

>>> EXIT CODE: 0

>>> STDOUT:
root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:logcheck
tty:x:5:
disk:x:6:
lp:x:7:
mail:x:8:
news:x:9:
uucp:x:10:
man:x:12:
proxy:x:13:
kmem:x:15:
dialout:x:20:
fax:x:21:
voice:x:22:
cdrom:x:24:user
floppy:x:25:user
tape:x:26:
sudo:x:27:
audio:x:29:pulse,user
dip:x:30:user
www-data:x:33:
backup:x:34:
operator:x:37:
list:x:38:
irc:x:39:
src:x:40:
gnats:x:41:
shadow:x:42:
utmp:x:43:
video:x:44:user
sasl:x:45:
plugdev:x:46:user
staff:x:50:
games:x:60:
users:x:100:
nogroup:x:65534:
systemd-journal:x:101:
systemd-timesync:x:102:
systemd-network:x:103:
systemd-resolve:x:104:
systemd-bus-proxy:x:105:
input:x:106:
crontab:x:107:
netdev:x:108:user
messagebus:x:109:
astra-orientation:x:110:
ssh:x:111:
lpadmin:x:112:user
pulse:x:113:
pulse-access:x:114:
scanner:x:115:saned,user
fly-dm:x:116:
firejail:x:117:
astra-console:x:333:user
Debian-exim:x:118:
ssl-cert:x:119:postgres
postgres:x:120:
lpmac:x:121:
ntp:x:122:
logcheck:x:123:
saned:x:124:
nm-openvpn:x:125:
avahi:x:126:
user:x:1000:
astra-admin:x:1001:user
rdma:x:127:
sambashare:x:128:


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.791] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 9f95b105-b120-413a-a2df-38d890a1b203
Script Name: getent group

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail  

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

if [ -z "${ETALON_INPUT:-}" ]; then
    exit 51
fi

# Парсим вывод getent group: извлекаем первый элемент (имя группы) до первого двоеточия
# Формат getent group: groupname:password:gid:members
# Нам нужен только groupname (первый элемент)
actual_groups="$(echo "$CHECK_OUTPUT" | awk -F':' '{print $1}' | grep -v '^$' | sort -u | tr '\n' ',' | sed 's/,$//')"

if [[ -z "$actual_groups" ]]; then
    exit 41 # Список групп пуст → "Не пройдена"
fi
... (total 85 lines, 2601 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 1044 chars, 71 lines:
root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:logcheck
tty:x:5:
disk:x:6:
lp:x:7:
mail:x:8:
news:x:9:
uucp:x:10:
man:x:12:
proxy:x:13:
kmem:x:15:
dialout:x:20:
fax:x:21:
voice:x:22:
cdrom:x:24:user
floppy:x:25:user
tape:x:26:
sudo:x:27:
audio:x:29:pulse,user
dip:x:30:user
www-data:x:33:
backup:x:34:
operator:x:37:
list:x:38:
irc:x:39:
src:x:40:
gnats:x:41:
shadow:x:42:
utmp:x:43:
video:x:44:user
sasl:x:45:
plugdev:x:46:user
staff:x:50:
games:x:60:
users:x:100:
nogroup:x:65534:
systemd-journal:x:101:
systemd-timesync:x:102:
systemd-network:x:103:
systemd-resolve:x:104:
systemd-bus-proxy:x:105:
input:x:106:
crontab:x:107:
netdev:x:108:user
messagebus:x:109:
astra-orientation:x:110:
ssh:x:111:
lpadmin:x:112:user
pulse:x:113:
pulse-access:x:114:
scanner:x:115:saned,user
fly-dm:x:116:
firejail:x:117:
astra-console:x:333:user
Debian-exim:x:118:
ssl-cert:x:119:postgres
postgres:x:120:
lpmac:x:121:
ntp:x:122:
logcheck:x:123:
saned:x:124:
nm-openvpn:x:125:
avahi:x:126:
user:x:1000:
astra-admin:x:1001:user
rdma:x:127:
sambashare:x:128:


>>> REFERENCE DATA (ETALON_INPUT) - 24 chars, 4 lines:
group1
gorpu2
root
cdrom

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (1250 chars):
ACTUAL_DATA: Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data
DEBUG: actual_normalized='Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data'
DEBUG: expected_normalized='cdrom,gorpu2,group1,root'
DEBUG: expected_count=4, actual_count=70
DEBUG: количество элементов не совпадает (эталон: 4, actual: 70)


>>> STDERR (7388 chars):
+ set -eo pipefail
+ '[' -z 'root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:logcheck
tty:x:5:
disk:x:6:
lp:x:7:
mail:x:8:
news:x:9:
uucp:x:10:
man:x:12:
proxy:x:13:
kmem:x:15:
dialout:x:20:
fax:x:21:
voice:x:22:
cdrom:x:24:user
floppy:x:25:user
tape:x:26:
sudo:x:27:
audio:x:29:pulse,user
dip:x:30:user
www-data:x:33:
backup:x:34:
operator:x:37:
list:x:38:
irc:x:39:
src:x:40:
gnats:x:41:
shadow:x:42:
utmp:x:43:
video:x:44:user
sasl:x:45:
plugdev:x:46:user
staff:x:50:
games:x:60:
users:x:100:
nogroup:x:65534:
systemd-journal:x:101:
systemd-timesync:x:102:
systemd-network:x:103:
systemd-resolve:x:104:
systemd-bus-proxy:x:105:
input:x:106:
crontab:x:107:
netdev:x:108:user
messagebus:x:109:
astra-orientation:x:110:
ssh:x:111:
lpadmin:x:112:user
pulse:x:113:
pulse-access:x:114:
scanner:x:115:saned,user
fly-dm:x:116:
firejail:x:117:
astra-console:x:333:user
Debian-exim:x:118:
ssl-cert:x:119:postgres
postgres:x:120:
lpmac:x:121:
ntp:x:122:
logcheck:x:123:
saned:x:124:
nm-openvpn:x:125:
avahi:x:126:
user:x:1000:
astra-admin:x:1001:user
rdma:x:127:
sambashare:x:128:
' ']'
+ '[' -z 'group1
gorpu2
root
cdrom' ']'
++ echo 'root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:logcheck
tty:x:5:
disk:x:6:
lp:x:7:
mail:x:8:
news:x:9:
uucp:x:10:
man:x:12:
proxy:x:13:
kmem:x:15:
dialout:x:20:
fax:x:21:
voice:x:22:
cdrom:x:24:user
floppy:x:25:user
tape:x:26:
sudo:x:27:
audio:x:29:pulse,user
dip:x:30:user
www-data:x:33:
backup:x:34:
operator:x:37:
list:x:38:
irc:x:39:
src:x:40:
gnats:x:41:
shadow:x:42:
utmp:x:43:
video:x:44:user
sasl:x:45:
plugdev:x:46:user
staff:x:50:
games:x:60:
users:x:100:
nogroup:x:65534:
systemd-journal:x:101:
systemd-timesync:x:102:
systemd-network:x:103:
systemd-resolve:x:104:
systemd-bus-proxy:x:105:
input:x:106:
crontab:x:107:
netdev:x:108:user
messagebus:x:109:
astra-orientation:x:110:
ssh:x:111:
lpadmin:x:112:user
pulse:x:113:
pulse-access:x:114:
scanner:x:115:saned,user
fly-dm:x:116:
firejail:x:117:
astra-console:x:333:user
Debian-exim:x:118:
ssl-cert:x:119:postgres
postgres:x:120:
lpmac:x:121:
ntp:x:122:
logcheck:x:123:
saned:x:124:
nm-openvpn:x:125:
avahi:x:126:
user:x:1000:
astra-admin:x:1001:user
rdma:x:127:
sambashare:x:128:
'
++ awk -F: '{print $1}'
++ grep -v '^$'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ actual_groups=Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data
+ [[ -z Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data ]]
++ normalize 'group1
gorpu2
root
cdrom'
++ local 'input=group1
gorpu2
root
cdrom'
++ echo 'group1
gorpu2
root
cdrom'
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ expected_normalized=cdrom,gorpu2,group1,root
++ normalize Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data
++ local input=Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data
++ echo Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ actual_normalized=Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data
+ echo 'ACTUAL_DATA: Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data'
+ echo 'DEBUG: actual_normalized='\''Debian-exim,adm,astra-admin,astra-console,astra-orientation,audio,avahi,backup,bin,cdrom,crontab,daemon,dialout,dip,disk,fax,firejail,floppy,fly-dm,games,gnats,input,irc,kmem,list,logcheck,lp,lpadmin,lpmac,mail,man,messagebus,netdev,news,nm-openvpn,nogroup,ntp,operator,plugdev,postgres,proxy,pulse,pulse-access,rdma,root,sambashare,saned,sasl,scanner,shadow,src,ssh,ssl-cert,staff,sudo,sys,systemd-bus-proxy,systemd-journal,systemd-network,systemd-resolve,systemd-timesync,tape,tty,user,users,utmp,uucp,video,voice,www-data'\'''
+ echo 'DEBUG: expected_normalized='\''cdrom,gorpu2,group1,root'\'''
+ IFS=,
+ read -ra expected_array
+ IFS=,
+ read -ra actual_array
+ expected_count=4
+ actual_count=70
+ echo 'DEBUG: expected_count=4, actual_count=70'
+ [[ 4 -ne 70 ]]
+ echo 'DEBUG: количество элементов не совпадает (эталон: 4, actual: 70)'
+ exit 44

================================================================================

2026-02-11 10:52:54 [INFO] 
================================================================================
[2026-02-11 10:52:54.912] SSH COMMAND EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo klist

>>> EXIT CODE: 1

>>> STDOUT:
(empty)

>>> STDERR:
sudo: klist: command not found

================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.031] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/pam.d/su

>>> EXIT CODE: 0

>>> STDOUT:
session required pam_exec.so seteuid /usr/sbin/mkiosk
#
# The PAM configuration file for the Shadow `su' service
#

# This allows root to su without passwords (normal operation)
auth       sufficient pam_rootok.so

# Uncomment this to force users to be a member of group root
# before they can use `su'. You can also add "group=foo"
# to the end of this line if you want to use a group other
# than the default "root" (but this may have side effect of
# denying "root" user, unless she's a member of "foo" or explicitly
# permitted earlier by e.g. "sufficient pam_rootok.so").
# (Replaces the `SU_WHEEL_ONLY' option from login.defs)
# auth       required   pam_wheel.so

# Uncomment this if you want wheel members to be able to
# su without a password.
# auth       sufficient pam_wheel.so trust

# Uncomment this if you want members of a specific group to not
# be allowed to use su at all.
# auth       required   pam_wheel.so deny group=nosu

# Uncomment and edit /etc/security/time.conf if you need to set
# time restrainst on su usage.
# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs
# as well as /etc/porttime)
# account    requisite  pam_time.so

# This module parses environment configuration file(s)
# and also allows you to use an extended config
# file /etc/security/pam_env.conf.
# 
# parsing /etc/environment needs "readenv=1"
session       required   pam_env.so readenv=1
# locale variables are also kept into /etc/default/locale in etch
# reading this file *in addition to /etc/environment* does not hurt
session       required   pam_env.so readenv=1 envfile=/etc/default/locale

# Defines the MAIL environment variable
# However, userdel also needs MAIL_DIR and MAIL_FILE variables
# in /etc/login.defs to make sure that removing a user 
# also removes the user's mail spool file.
# See comments in /etc/login.defs
#
# "nopen" stands to avoid reporting new mail when su'ing to another user
session    optional   pam_mail.so nopen

# Sets up user limits according to /etc/security/limits.conf
# (Replaces the use of /etc/limits in old login)
session    required   pam_limits.so

# The standard Unix authentication modules, used with
# NIS (man nsswitch) as well as normal /etc/passwd and
# /etc/shadow entries.
@include common-auth
@include common-account
@include common-session
session required pam_parsec_cap.so
session required pam_parsec_aud.so




>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.052] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: a45551bd-3f23-4d6c-8060-35e45e9f87dd
Script Name:  pam_wheel.so

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail  

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Ищем строку с auth required pam_wheel.so в полученных данных
# ИСПРАВЛЕНО: используем два шага для правильного поиска
# Шаг 1: находим все строки с auth required pam_wheel.so (включая закомментированные)
# Шаг 2: исключаем закомментированные строки (которые начинаются с # после пробелов)
# Это правильный способ, так как bash не поддерживает negative lookahead
line="$(echo "$CHECK_OUTPUT" | grep -E 'auth[[:space:]]+required[[:space:]]+pam_wheel\.so' | grep -vE '^[[:space:]]*#' || true)"

if [[ -z "$line" ]]; then
    # Проверим, может закомментирована
    if echo "$CHECK_OUTPUT" | grep -qE '^[[:space:]]*#.*auth[[:space:]]+required[[:space:]]+pam_wheel\.so'; then
        exit 42 # Строка закомментирована → "Не пройдена"
    fi
... (total 27 lines, 993 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 2381 chars, 65 lines:
session required pam_exec.so seteuid /usr/sbin/mkiosk
#
# The PAM configuration file for the Shadow `su' service
#

# This allows root to su without passwords (normal operation)
auth       sufficient pam_rootok.so

# Uncomment this to force users to be a member of group root
# before they can use `su'. You can also add "group=foo"
# to the end of this line if you want to use a group other
# than the default "root" (but this may have side effect of
# denying "root" user, unless she's a member of "foo" or explicitly
# permitted earlier by e.g. "sufficient pam_rootok.so").
# (Replaces the `SU_WHEEL_ONLY' option from login.defs)
# auth       required   pam_wheel.so

# Uncomment this if you want wheel members to be able to
# su without a password.
# auth       sufficient pam_wheel.so trust

# Uncomment this if you want members of a specific group to not
# be allowed to use su at all.
# auth       required   pam_wheel.so deny group=nosu

# Uncomment and edit /etc/security/time.conf if you need to set
# time restrainst on su usage.
# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs
# as well as /etc/porttime)
# account    requisite  pam_time.so

# This module parses environment configuration file(s)
# and also allows you to use an extended config
# file /etc/security/pam_env.conf.
# 
# parsing /etc/environment needs "readenv=1"
session       required   pam_env.so readenv=1
# locale variables are also kept into /etc/default/locale in etch
# reading this file *in addition to /etc/environment* does not hurt
session       required   pam_env.so readenv=1 envfile=/etc/default/locale

# Defines the MAIL environment variable
# However, userdel also needs MAIL_DIR and MAIL_FILE variables
# in /etc/login.defs to make sure that removing a user 
# also removes the user's mail spool file.
# See comments in /etc/login.defs
#
# "nopen" stands to avoid reporting new mail when su'ing to another user
session    optional   pam_mail.so nopen

# Sets up user limits according to /etc/security/limits.conf
# (Replaces the use of /etc/limits in old login)
session    required   pam_limits.so

# The standard Unix authentication modules, used with
# NIS (man nsswitch) as well as normal /etc/passwd and
# /etc/shadow entries.
@include common-auth
@include common-account
@include common-session
session required pam_parsec_cap.so
session required pam_parsec_aud.so




>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 42 (Строка закомментирована)

>>> STDOUT (0 chars):
(empty)

>>> STDERR (7473 chars):
+ set -eo pipefail
+ '[' -z 'session required pam_exec.so seteuid /usr/sbin/mkiosk
#
# The PAM configuration file for the Shadow `su'\'' service
#

# This allows root to su without passwords (normal operation)
auth       sufficient pam_rootok.so

# Uncomment this to force users to be a member of group root
# before they can use `su'\''. You can also add "group=foo"
# to the end of this line if you want to use a group other
# than the default "root" (but this may have side effect of
# denying "root" user, unless she'\''s a member of "foo" or explicitly
# permitted earlier by e.g. "sufficient pam_rootok.so").
# (Replaces the `SU_WHEEL_ONLY'\'' option from login.defs)
# auth       required   pam_wheel.so

# Uncomment this if you want wheel members to be able to
# su without a password.
# auth       sufficient pam_wheel.so trust

# Uncomment this if you want members of a specific group to not
# be allowed to use su at all.
# auth       required   pam_wheel.so deny group=nosu

# Uncomment and edit /etc/security/time.conf if you need to set
# time restrainst on su usage.
# (Replaces the `PORTTIME_CHECKS_ENAB'\'' option from login.defs
# as well as /etc/porttime)
# account    requisite  pam_time.so

# This module parses environment configuration file(s)
# and also allows you to use an extended config
# file /etc/security/pam_env.conf.
# 
# parsing /etc/environment needs "readenv=1"
session       required   pam_env.so readenv=1
# locale variables are also kept into /etc/default/locale in etch
# reading this file *in addition to /etc/environment* does not hurt
session       required   pam_env.so readenv=1 envfile=/etc/default/locale

# Defines the MAIL environment variable
# However, userdel also needs MAIL_DIR and MAIL_FILE variables
# in /etc/login.defs to make sure that removing a user 
# also removes the user'\''s mail spool file.
# See comments in /etc/login.defs
#
# "nopen" stands to avoid reporting new mail when su'\''ing to another user
session    optional   pam_mail.so nopen

# Sets up user limits according to /etc/security/limits.conf
# (Replaces the use of /etc/limits in old login)
session    required   pam_limits.so

# The standard Unix authentication modules, used with
# NIS (man nsswitch) as well as normal /etc/passwd and
# /etc/shadow entries.
@include common-auth
@include common-account
@include common-session
session required pam_parsec_cap.so
session required pam_parsec_aud.so


' ']'
++ echo 'session required pam_exec.so seteuid /usr/sbin/mkiosk
#
# The PAM configuration file for the Shadow `su'\'' service
#

# This allows root to su without passwords (normal operation)
auth       sufficient pam_rootok.so

# Uncomment this to force users to be a member of group root
# before they can use `su'\''. You can also add "group=foo"
# to the end of this line if you want to use a group other
# than the default "root" (but this may have side effect of
# denying "root" user, unless she'\''s a member of "foo" or explicitly
# permitted earlier by e.g. "sufficient pam_rootok.so").
# (Replaces the `SU_WHEEL_ONLY'\'' option from login.defs)
# auth       required   pam_wheel.so

# Uncomment this if you want wheel members to be able to
# su without a password.
# auth       sufficient pam_wheel.so trust

# Uncomment this if you want members of a specific group to not
# be allowed to use su at all.
# auth       required   pam_wheel.so deny group=nosu

# Uncomment and edit /etc/security/time.conf if you need to set
# time restrainst on su usage.
# (Replaces the `PORTTIME_CHECKS_ENAB'\'' option from login.defs
# as well as /etc/porttime)
# account    requisite  pam_time.so

# This module parses environment configuration file(s)
# and also allows you to use an extended config
# file /etc/security/pam_env.conf.
# 
# parsing /etc/environment needs "readenv=1"
session       required   pam_env.so readenv=1
# locale variables are also kept into /etc/default/locale in etch
# reading this file *in addition to /etc/environment* does not hurt
session       required   pam_env.so readenv=1 envfile=/etc/default/locale

# Defines the MAIL environment variable
# However, userdel also needs MAIL_DIR and MAIL_FILE variables
# in /etc/login.defs to make sure that removing a user 
# also removes the user'\''s mail spool file.
# See comments in /etc/login.defs
#
# "nopen" stands to avoid reporting new mail when su'\''ing to another user
session    optional   pam_mail.so nopen

# Sets up user limits according to /etc/security/limits.conf
# (Replaces the use of /etc/limits in old login)
session    required   pam_limits.so

# The standard Unix authentication modules, used with
# NIS (man nsswitch) as well as normal /etc/passwd and
# /etc/shadow entries.
@include common-auth
@include common-account
@include common-session
session required pam_parsec_cap.so
session required pam_parsec_aud.so


'
++ grep -E 'auth[[:space:]]+required[[:space:]]+pam_wheel\.so'
++ grep -vE '^[[:space:]]*#'
++ true
+ line=
+ [[ -z '' ]]
+ echo 'session required pam_exec.so seteuid /usr/sbin/mkiosk
#
# The PAM configuration file for the Shadow `su'\'' service
#

# This allows root to su without passwords (normal operation)
auth       sufficient pam_rootok.so

# Uncomment this to force users to be a member of group root
# before they can use `su'\''. You can also add "group=foo"
# to the end of this line if you want to use a group other
# than the default "root" (but this may have side effect of
# denying "root" user, unless she'\''s a member of "foo" or explicitly
# permitted earlier by e.g. "sufficient pam_rootok.so").
# (Replaces the `SU_WHEEL_ONLY'\'' option from login.defs)
# auth       required   pam_wheel.so

# Uncomment this if you want wheel members to be able to
# su without a password.
# auth       sufficient pam_wheel.so trust

# Uncomment this if you want members of a specific group to not
# be allowed to use su at all.
# auth       required   pam_wheel.so deny group=nosu

# Uncomment and edit /etc/security/time.conf if you need to set
# time restrainst on su usage.
# (Replaces the `PORTTIME_CHECKS_ENAB'\'' option from login.defs
# as well as /etc/porttime)
# account    requisite  pam_time.so

# This module parses environment configuration file(s)
# and also allows you to use an extended config
# file /etc/security/pam_env.conf.
# 
# parsing /etc/environment needs "readenv=1"
session       required   pam_env.so readenv=1
# locale variables are also kept into /etc/default/locale in etch
# reading this file *in addition to /etc/environment* does not hurt
session       required   pam_env.so readenv=1 envfile=/etc/default/locale

# Defines the MAIL environment variable
# However, userdel also needs MAIL_DIR and MAIL_FILE variables
# in /etc/login.defs to make sure that removing a user 
# also removes the user'\''s mail spool file.
# See comments in /etc/login.defs
#
# "nopen" stands to avoid reporting new mail when su'\''ing to another user
session    optional   pam_mail.so nopen

# Sets up user limits according to /etc/security/limits.conf
# (Replaces the use of /etc/limits in old login)
session    required   pam_limits.so

# The standard Unix authentication modules, used with
# NIS (man nsswitch) as well as normal /etc/passwd and
# /etc/shadow entries.
@include common-auth
@include common-account
@include common-session
session required pam_parsec_cap.so
session required pam_parsec_aud.so


'
+ grep -qE '^[[:space:]]*#.*auth[[:space:]]+required[[:space:]]+pam_wheel\.so'
+ exit 42

================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.187] SSH COMMAND EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo getent group wheel

>>> EXIT CODE: 2

>>> STDOUT:
(empty)

>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.194] PROCESSOR SCRIPT EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 7fa4ac76-bea2-4466-9021-bd748c1c49f2
Script Name: wheel

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail  

# CHECK_OUTPUT может быть пустым, если группа не найдена - это нормально
# Не проверяем на обязательность переменной, так как пустой вывод = группа не найдена = успех

# Парсим вывод getent group wheel
# Формат getent group wheel: groupname:password:gid:members
# Примеры:
#   wheel:x:10:          - группа без пользователей (пустое поле members)
#   wheel:x:10:user1     - группа с одним пользователем
#   wheel:x:10:user1,user2 - группа с несколькими пользователями

# Проверяем, что группа найдена (вывод не пустой)
if [[ -z "${CHECK_OUTPUT:-}" ]] || [[ "$CHECK_OUTPUT" =~ ^[[:space:]]*$ ]]; then
    # Группа не существует - проверка пройдена
    echo "Пройдена"
    exit 0
fi
... (total 35 lines, 1243 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 0 chars, 1 lines:
(empty)

>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 0 (SUCCESS)

>>> STDOUT (9 chars):
Пройдена


>>> STDERR (58 chars):
+ set -eo pipefail
+ [[ -z '' ]]
+ echo Пройдена
+ exit 0

================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.318] SSH COMMAND EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
su user

>>> EXIT CODE: 1

>>> STDOUT:
(empty)

>>> STDERR:
su: должен запускаться из терминала

================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.336] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 8aea6212-ce36-4211-8e1c-890e085af7f2
Script Name: su

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "sudo su user" с хоста
# Команда на хосте должна быть выполнена как: echo "" | timeout 10 sudo su user
# Это предотвращает зависание интерактивной сессии и проверяет запрос пароля
# CHECK_OUTPUT может быть пустым, если команда не выполнилась - это нормально для проверки

# Нормализуем в нижний регистр для упрощения поиска
lower_output="$(printf '%s\n' "$CHECK_OUTPUT" | tr '[:upper:]' '[:lower:]')"

# Проверяем наличие запроса пароля в выводе
# Признаки запроса пароля:
# - "password:" или "password for"
# - "[sudo] password for"
# - "пароль" (русский)
# - "введите пароль"
# - "enter password"

... (total 45 lines, 1295 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 0 chars, 1 lines:
(empty)

>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (12 chars):
Не пройдена


>>> STDERR (278 chars):
+ set -eo pipefail
++ printf '%s\n' ''
++ tr '[:upper:]' '[:lower:]'
+ lower_output=
+ echo ''
+ grep -qE '(password|пароль)'
+ echo ''
+ grep -qE '\[sudo\] password for'
+ echo ''
+ grep -qi 'введите пароль'
+ echo ''
+ grep -qi 'enter password'
+ echo 'Не пройдена'
+ exit 44

================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.460] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo -u user cat /etc/passwd

>>> EXIT CODE: 0

>>> STDOUT:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.482] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: dfb1638b-644a-433e-be34-b0bb73162123
Script Name: sudo -u user

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "sudo -u user cat /etc/shadow" с хоста
# Команда на хосте должна быть выполнена как: echo "" | timeout 10 sudo -u user cat /etc/shadow
# Это предотвращает зависание и проверяет запрос пароля
# CHECK_OUTPUT может быть пустым, если команда не выполнилась - это нормально для проверки

# Нормализуем в нижний регистр для упрощения поиска
lower_output="$(printf '%s\n' "$CHECK_OUTPUT" | tr '[:upper:]' '[:lower:]')"

# Проверяем наличие запроса пароля в выводе
# Признаки запроса пароля:
# - "password:" или "password for"
# - "[sudo] password for"
# - "пароль" (русский)
# - "введите пароль"
# - "enter password"

... (total 56 lines, 1863 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 2100 chars, 39 lines:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (12 chars):
Не пройдена


>>> STDERR (15021 chars):
+ set -eo pipefail
++ printf '%s\n' 'root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
'
++ tr '[:upper:]' '[:lower:]'
+ lower_output='root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:mailing list manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:gnats bug-reporting system (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd time synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd network management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd bus proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:pulseaudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:postgresql administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:networkmanager openvpn,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:hplip system user,,,:/run/hplip:/bin/false
avahi:x:117:126:avahi mdns daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash'
+ echo 'root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:mailing list manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:gnats bug-reporting system (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd time synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd network management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd bus proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:pulseaudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:postgresql administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:networkmanager openvpn,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:hplip system user,,,:/run/hplip:/bin/false
avahi:x:117:126:avahi mdns daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash'
+ grep -qE '(password|пароль)'
+ echo 'root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:mailing list manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:gnats bug-reporting system (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd time synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd network management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd bus proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:pulseaudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:postgresql administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:networkmanager openvpn,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:hplip system user,,,:/run/hplip:/bin/false
avahi:x:117:126:avahi mdns daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash'
+ grep -qE '\[sudo\] password for'
+ echo 'root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
'
+ grep -qi 'введите пароль'
+ echo 'root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
'
+ grep -qi 'enter password'
+ echo 'root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
'
+ grep -qE '^[^:]+:[^:]*:[0-9]*:'
+ echo 'Не пройдена'
+ exit 44

================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.620] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo grep PASS /etc/login.defs;sudo grep LOGIN /etc/login.defs


>>> EXIT CODE: 0

>>> STDOUT:
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
#PASS_CHANGE_TRIES
#PASS_ALWAYS_WARN
#PASS_MIN_LEN
#PASS_MAX_LEN
# NO_PASSWORD_CONSOLE
LOG_OK_LOGINS		no
HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins
LOGIN_RETRIES		5
LOGIN_TIMEOUT		60
#NOLOGINS_FILE
# LOGIN_STRING


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.643] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 67f008f5-987d-45b7-8395-4c75d62ec371
Script Name: login.defs

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команд "grep PASS /etc/login.defs; grep LOGIN /etc/login.defs"
# Ищем значения:
#   PASS_MIN_DAYS – 1
#   PASS_WARN_AGE – 14
#   LOGIN_RETRIES = 10
#   LOGIN_TIMEOUT = 1800

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Функция для извлечения значения параметра из вывода
# Формат в файле может быть: PARAM_NAME value или PARAM_NAME=value или PARAM_NAME	value
# Исключаем закомментированные строки (начинающиеся с #)
get_param_value() {
    local param_name="$1"
... (total 81 lines, 2568 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 488 chars, 19 lines:
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
#PASS_CHANGE_TRIES
#PASS_ALWAYS_WARN
#PASS_MIN_LEN
#PASS_MAX_LEN
# NO_PASSWORD_CONSOLE
LOG_OK_LOGINS		no
HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins
LOGIN_RETRIES		5
LOGIN_TIMEOUT		60
#NOLOGINS_FILE
# LOGIN_STRING


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (169 chars):
Неверные значения:
  PASS_MIN_DAYS=0 (ожидается: 1)
  PASS_WARN_AGE=7 (ожидается: 14)
  LOGIN_RETRIES=5 (ожидается: 10)
  LOGIN_TIMEOUT=60 (ожидается: 1800)
Не пройдена


>>> STDERR (4322 chars):
+ set -eo pipefail
+ '[' -z '#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
#PASS_CHANGE_TRIES
#PASS_ALWAYS_WARN
#PASS_MIN_LEN
#PASS_MAX_LEN
# NO_PASSWORD_CONSOLE
LOG_OK_LOGINS		no
HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins
LOGIN_RETRIES		5
LOGIN_TIMEOUT		60
#NOLOGINS_FILE
# LOGIN_STRING
' ']'
+ errors=()
+ missing_params=()
++ get_param_value PASS_MIN_DAYS
++ local param_name=PASS_MIN_DAYS
++ echo '#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
#PASS_CHANGE_TRIES
#PASS_ALWAYS_WARN
#PASS_MIN_LEN
#PASS_MAX_LEN
# NO_PASSWORD_CONSOLE
LOG_OK_LOGINS		no
HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins
LOGIN_RETRIES		5
LOGIN_TIMEOUT		60
#NOLOGINS_FILE
# LOGIN_STRING
'
++ grep -iE '^[[:space:]]*PASS_MIN_DAYS[[:space:]=]+'
++ grep -vE '^[[:space:]]*#'
++ sed -E 's/^[[:space:]]*PASS_MIN_DAYS[[:space:]=]+([0-9]+).*/\1/'
++ head -1
+ pass_min_days=0
+ [[ -z 0 ]]
+ [[ 0 != \1 ]]
+ errors+=("PASS_MIN_DAYS=$pass_min_days (ожидается: 1)")
++ get_param_value PASS_WARN_AGE
++ local param_name=PASS_WARN_AGE
++ echo '#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
#PASS_CHANGE_TRIES
#PASS_ALWAYS_WARN
#PASS_MIN_LEN
#PASS_MAX_LEN
# NO_PASSWORD_CONSOLE
LOG_OK_LOGINS		no
HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins
LOGIN_RETRIES		5
LOGIN_TIMEOUT		60
#NOLOGINS_FILE
# LOGIN_STRING
'
++ grep -iE '^[[:space:]]*PASS_WARN_AGE[[:space:]=]+'
++ grep -vE '^[[:space:]]*#'
++ sed -E 's/^[[:space:]]*PASS_WARN_AGE[[:space:]=]+([0-9]+).*/\1/'
++ head -1
+ pass_warn_age=7
+ [[ -z 7 ]]
+ [[ 7 != \1\4 ]]
+ errors+=("PASS_WARN_AGE=$pass_warn_age (ожидается: 14)")
++ get_param_value LOGIN_RETRIES
++ local param_name=LOGIN_RETRIES
++ echo '#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
#PASS_CHANGE_TRIES
#PASS_ALWAYS_WARN
#PASS_MIN_LEN
#PASS_MAX_LEN
# NO_PASSWORD_CONSOLE
LOG_OK_LOGINS		no
HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins
LOGIN_RETRIES		5
LOGIN_TIMEOUT		60
#NOLOGINS_FILE
# LOGIN_STRING
'
++ grep -iE '^[[:space:]]*LOGIN_RETRIES[[:space:]=]+'
++ grep -vE '^[[:space:]]*#'
++ sed -E 's/^[[:space:]]*LOGIN_RETRIES[[:space:]=]+([0-9]+).*/\1/'
++ head -1
+ login_retries=5
+ [[ -z 5 ]]
+ [[ 5 != \1\0 ]]
+ errors+=("LOGIN_RETRIES=$login_retries (ожидается: 10)")
++ get_param_value LOGIN_TIMEOUT
++ local param_name=LOGIN_TIMEOUT
++ echo '#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
#PASS_CHANGE_TRIES
#PASS_ALWAYS_WARN
#PASS_MIN_LEN
#PASS_MAX_LEN
# NO_PASSWORD_CONSOLE
LOG_OK_LOGINS		no
HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins
LOGIN_RETRIES		5
LOGIN_TIMEOUT		60
#NOLOGINS_FILE
# LOGIN_STRING
'
++ grep -iE '^[[:space:]]*LOGIN_TIMEOUT[[:space:]=]+'
++ grep -vE '^[[:space:]]*#'
++ sed -E 's/^[[:space:]]*LOGIN_TIMEOUT[[:space:]=]+([0-9]+).*/\1/'
++ head -1
+ login_timeout=60
+ [[ -z 60 ]]
+ [[ 60 != \1\8\0\0 ]]
+ errors+=("LOGIN_TIMEOUT=$login_timeout (ожидается: 1800)")
+ [[ 0 -gt 0 ]]
+ [[ 4 -gt 0 ]]
+ [[ 0 -gt 0 ]]
+ [[ 4 -gt 0 ]]
+ echo 'Неверные значения:'
+ for error in "${errors[@]}"
+ echo '  PASS_MIN_DAYS=0 (ожидается: 1)'
+ for error in "${errors[@]}"
+ echo '  PASS_WARN_AGE=7 (ожидается: 14)'
+ for error in "${errors[@]}"
+ echo '  LOGIN_RETRIES=5 (ожидается: 10)'
+ for error in "${errors[@]}"
+ echo '  LOGIN_TIMEOUT=60 (ожидается: 1800)'
+ echo 'Не пройдена'
+ exit 44

================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.769] SSH COMMAND EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/pam.d/system-auth

>>> EXIT CODE: 1

>>> STDOUT:
(empty)

>>> STDERR:
cat: /etc/pam.d/system-auth: Нет такого файла или каталога

================================================================================

2026-02-11 10:52:55 [INFO] 
================================================================================
[2026-02-11 10:52:55.900] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/shadow

>>> EXIT CODE: 0

>>> STDOUT:
root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:56 [INFO] 
================================================================================
[2026-02-11 10:52:56.084] PROCESSOR SCRIPT EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Script ID: ef909cf2-f6d0-46f0-836d-d43fb4425ff1
Script Name: Encrypted_passwords

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "sudo cat /etc/shadow"
# Проверяем, что все пароли в файле /etc/shadow хранятся в зашифрованном виде
# Формат /etc/shadow: username:password_hash:last_change:min:max:warn:inactive:expire:reserved

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Функция для проверки, является ли пароль зашифрованным
# Пароль считается зашифрованным, если:
# - Начинается с $ (современные хеши: $1$, $2a$, $5$, $6$ и т.д.)
# - Равен * или ! (заблокированный аккаунт)
# - Имеет формат старых хешей (DES - 13 символов, MD5 - начинается с $1$)
is_encrypted() {
    local password_hash="$1"
    
... (total 85 lines, 2522 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 1308 chars, 39 lines:
root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 0 (SUCCESS)

>>> STDOUT (9 chars):
Пройдена


>>> STDERR (19227 chars):
+ set -eo pipefail
+ '[' -z 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
' ']'
+ errors=()
+ line_number=0
+ IFS=
+ read -r line
+ line_number=1
+ [[ -z root:!:20397:0:99999:7::: ]]
+ [[ root:!:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'root:!:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=root
++ echo 'root:!:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='!'
+ [[ -z root ]]
+ is_encrypted '!'
+ local 'password_hash=!'
+ [[ -z ! ]]
+ [[ ! == \* ]]
+ [[ ! == \! ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=2
+ [[ -z daemon:*:20397:0:99999:7::: ]]
+ [[ daemon:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'daemon:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=daemon
++ echo 'daemon:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z daemon ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=3
+ [[ -z bin:*:20397:0:99999:7::: ]]
+ [[ bin:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'bin:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=bin
++ echo 'bin:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z bin ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=4
+ [[ -z sys:*:20397:0:99999:7::: ]]
+ [[ sys:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sys:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=sys
++ echo 'sys:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z sys ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=5
+ [[ -z sync:*:20397:0:99999:7::: ]]
+ [[ sync:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sync:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=sync
++ echo 'sync:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z sync ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=6
+ [[ -z games:*:20397:0:99999:7::: ]]
+ [[ games:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'games:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=games
++ echo 'games:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z games ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=7
+ [[ -z man:*:20397:0:99999:7::: ]]
+ [[ man:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'man:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=man
++ echo 'man:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z man ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=8
+ [[ -z lp:*:20397:0:99999:7::: ]]
+ [[ lp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'lp:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=lp
++ echo 'lp:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z lp ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=9
+ [[ -z mail:*:20397:0:99999:7::: ]]
+ [[ mail:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'mail:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=mail
++ echo 'mail:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z mail ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=10
+ [[ -z news:*:20397:0:99999:7::: ]]
+ [[ news:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'news:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=news
++ echo 'news:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z news ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=11
+ [[ -z uucp:*:20397:0:99999:7::: ]]
+ [[ uucp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'uucp:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=uucp
++ echo 'uucp:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z uucp ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=12
+ [[ -z proxy:*:20397:0:99999:7::: ]]
+ [[ proxy:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'proxy:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=proxy
++ echo 'proxy:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z proxy ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=13
+ [[ -z www-data:*:20397:0:99999:7::: ]]
+ [[ www-data:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'www-data:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=www-data
++ echo 'www-data:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z www-data ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=14
+ [[ -z backup:*:20397:0:99999:7::: ]]
+ [[ backup:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'backup:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=backup
++ echo 'backup:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z backup ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=15
+ [[ -z list:*:20397:0:99999:7::: ]]
+ [[ list:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'list:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=list
++ echo 'list:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z list ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=16
+ [[ -z irc:*:20397:0:99999:7::: ]]
+ [[ irc:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'irc:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=irc
++ echo 'irc:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z irc ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=17
+ [[ -z gnats:*:20397:0:99999:7::: ]]
+ [[ gnats:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'gnats:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=gnats
++ echo 'gnats:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z gnats ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=18
+ [[ -z nobody:*:20397:0:99999:7::: ]]
+ [[ nobody:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'nobody:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=nobody
++ echo 'nobody:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z nobody ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=19
+ [[ -z systemd-timesync:*:20397:0:99999:7::: ]]
+ [[ systemd-timesync:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-timesync:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=systemd-timesync
++ echo 'systemd-timesync:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z systemd-timesync ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=20
+ [[ -z systemd-network:*:20397:0:99999:7::: ]]
+ [[ systemd-network:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-network:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=systemd-network
++ echo 'systemd-network:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z systemd-network ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=21
+ [[ -z systemd-resolve:*:20397:0:99999:7::: ]]
+ [[ systemd-resolve:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-resolve:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=systemd-resolve
++ echo 'systemd-resolve:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z systemd-resolve ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=22
+ [[ -z systemd-bus-proxy:*:20397:0:99999:7::: ]]
+ [[ systemd-bus-proxy:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-bus-proxy:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=systemd-bus-proxy
++ echo 'systemd-bus-proxy:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z systemd-bus-proxy ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=23
+ [[ -z _apt:*:20397:0:99999:7::: ]]
+ [[ _apt:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo '_apt:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=_apt
++ echo '_apt:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z _apt ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=24
+ [[ -z messagebus:*:20397:0:99999:7::: ]]
+ [[ messagebus:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'messagebus:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=messagebus
++ echo 'messagebus:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z messagebus ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=25
+ [[ -z astra-orientation:*:20397:0:99999:7::: ]]
+ [[ astra-orientation:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'astra-orientation:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=astra-orientation
++ echo 'astra-orientation:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z astra-orientation ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=26
+ [[ -z pulse:*:20397:0:99999:7::: ]]
+ [[ pulse:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'pulse:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=pulse
++ echo 'pulse:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z pulse ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=27
+ [[ -z fly-dm:*:20397:0:99999:7::: ]]
+ [[ fly-dm:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'fly-dm:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=fly-dm
++ echo 'fly-dm:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z fly-dm ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=28
+ [[ -z Debian-exim:!:20397:0:99999:7::: ]]
+ [[ Debian-exim:!:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'Debian-exim:!:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=Debian-exim
++ awk -F: '{print $2}'
++ echo 'Debian-exim:!:20397:0:99999:7:::'
+ password_hash='!'
+ [[ -z Debian-exim ]]
+ is_encrypted '!'
+ local 'password_hash=!'
+ [[ -z ! ]]
+ [[ ! == \* ]]
+ [[ ! == \! ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=29
+ [[ -z postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7::: ]]
+ [[ postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=postgres
++ echo 'postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/'
+ [[ -z postgres ]]
+ is_encrypted '$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/'
+ local 'password_hash=$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/'
+ [[ -z $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ ]]
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ == \* ]]
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ == \! ]]
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ =~ ^\$ ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=30
+ [[ -z dnsmasq:*:20397:0:99999:7::: ]]
+ [[ dnsmasq:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'dnsmasq:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=dnsmasq
++ echo 'dnsmasq:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z dnsmasq ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=31
+ [[ -z ntp:*:20397:0:99999:7::: ]]
+ [[ ntp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'ntp:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=ntp
++ echo 'ntp:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z ntp ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=32
+ [[ -z logcheck:*:20397:0:99999:7::: ]]
+ [[ logcheck:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'logcheck:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=logcheck
++ echo 'logcheck:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z logcheck ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=33
+ [[ -z saned:*:20397:0:99999:7::: ]]
+ [[ saned:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'saned:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=saned
++ echo 'saned:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z saned ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=34
+ [[ -z nm-openvpn:*:20397:0:99999:7::: ]]
+ [[ nm-openvpn:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'nm-openvpn:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=nm-openvpn
++ echo 'nm-openvpn:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z nm-openvpn ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=35
+ [[ -z hplip:*:20397:0:99999:7::: ]]
+ [[ hplip:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'hplip:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=hplip
++ echo 'hplip:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z hplip ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=36
+ [[ -z avahi:*:20397:0:99999:7::: ]]
+ [[ avahi:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'avahi:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=avahi
++ echo 'avahi:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z avahi ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=37
+ [[ -z sshd:*:20397:0:99999:7::: ]]
+ [[ sshd:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sshd:*:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=sshd
++ echo 'sshd:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z sshd ]]
+ is_encrypted '*'
+ local 'password_hash=*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=38
+ [[ -z user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7::: ]]
+ [[ user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::'
++ awk -F: '{print $1}'
+ username=user
++ echo 'user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/'
+ [[ -z user ]]
+ is_encrypted '$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/'
+ local 'password_hash=$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/'
+ [[ -z $gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/ ]]
+ [[ $gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/ == \* ]]
+ [[ $gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/ == \! ]]
+ [[ $gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/ =~ ^\$ ]]
+ return 0
+ IFS=
+ read -r line
+ line_number=39
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ 0 -gt 0 ]]
+ echo Пройдена
+ exit 0

================================================================================

2026-02-11 10:52:56 [INFO] 
================================================================================
[2026-02-11 10:52:56.231] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/shadow; sudo cat /etc/passwd

>>> EXIT CODE: 0

>>> STDOUT:
root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:56 [INFO] 
================================================================================
[2026-02-11 10:52:56.641] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 22787483-a323-4065-8057-72235cae54e5
Script Name: Все сервисные УЗ с паролями

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "cat /etc/shadow; cat /etc/passwd"
# Проверяем, что для всех сервисных УЗ без параметра /sbin/nologin (false)
# должен быть установлен пароль в файле /etc/shadow
# Формат /etc/passwd: username:password:uid:gid:gecos:home:shell
# Формат /etc/shadow: username:password_hash:last_change:min:max:warn:inactive:expire:reserved

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Разделяем вывод на части /etc/shadow и /etc/passwd
# Определяем по количеству полей:
# /etc/shadow: username:password_hash:... (обычно 2-9 полей)
# /etc/passwd: username:password:uid:gid:gecos:home:shell (ровно 7 полей)

shadow_output=""
... (total 116 lines, 4076 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 3408 chars, 77 lines:
root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (84 chars):
Найдены пользователи без пароля (не имеют /sbin/nologin):
  root
  sync
Не пройдена


>>> STDERR (62880 chars):
+ set -eo pipefail
+ '[' -z 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
' ']'
+ shadow_output=
+ passwd_output=
+ IFS=
+ read -r line
+ [[ -z root:!:20397:0:99999:7::: ]]
+ [[ root:!:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'root:!:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='root:!:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z daemon:*:20397:0:99999:7::: ]]
+ [[ daemon:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'daemon:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='daemon:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z bin:*:20397:0:99999:7::: ]]
+ [[ bin:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'bin:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='bin:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z sys:*:20397:0:99999:7::: ]]
+ [[ sys:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sys:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='sys:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z sync:*:20397:0:99999:7::: ]]
+ [[ sync:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sync:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='sync:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z games:*:20397:0:99999:7::: ]]
+ [[ games:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'games:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='games:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z man:*:20397:0:99999:7::: ]]
+ [[ man:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'man:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='man:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z lp:*:20397:0:99999:7::: ]]
+ [[ lp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'lp:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='lp:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z mail:*:20397:0:99999:7::: ]]
+ [[ mail:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'mail:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='mail:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z news:*:20397:0:99999:7::: ]]
+ [[ news:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'news:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='news:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z uucp:*:20397:0:99999:7::: ]]
+ [[ uucp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'uucp:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='uucp:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z proxy:*:20397:0:99999:7::: ]]
+ [[ proxy:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'proxy:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='proxy:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z www-data:*:20397:0:99999:7::: ]]
+ [[ www-data:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'www-data:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='www-data:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z backup:*:20397:0:99999:7::: ]]
+ [[ backup:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'backup:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='backup:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z list:*:20397:0:99999:7::: ]]
+ [[ list:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'list:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='list:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z irc:*:20397:0:99999:7::: ]]
+ [[ irc:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'irc:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='irc:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z gnats:*:20397:0:99999:7::: ]]
+ [[ gnats:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'gnats:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='gnats:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z nobody:*:20397:0:99999:7::: ]]
+ [[ nobody:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'nobody:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='nobody:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z systemd-timesync:*:20397:0:99999:7::: ]]
+ [[ systemd-timesync:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-timesync:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='systemd-timesync:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z systemd-network:*:20397:0:99999:7::: ]]
+ [[ systemd-network:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-network:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='systemd-network:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z systemd-resolve:*:20397:0:99999:7::: ]]
+ [[ systemd-resolve:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-resolve:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='systemd-resolve:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z systemd-bus-proxy:*:20397:0:99999:7::: ]]
+ [[ systemd-bus-proxy:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-bus-proxy:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='systemd-bus-proxy:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z _apt:*:20397:0:99999:7::: ]]
+ [[ _apt:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo '_apt:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='_apt:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z messagebus:*:20397:0:99999:7::: ]]
+ [[ messagebus:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'messagebus:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='messagebus:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z astra-orientation:*:20397:0:99999:7::: ]]
+ [[ astra-orientation:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'astra-orientation:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='astra-orientation:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z pulse:*:20397:0:99999:7::: ]]
+ [[ pulse:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'pulse:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='pulse:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z fly-dm:*:20397:0:99999:7::: ]]
+ [[ fly-dm:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'fly-dm:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='fly-dm:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z Debian-exim:!:20397:0:99999:7::: ]]
+ [[ Debian-exim:!:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'Debian-exim:!:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='Debian-exim:!:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7::: ]]
+ [[ postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z dnsmasq:*:20397:0:99999:7::: ]]
+ [[ dnsmasq:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'dnsmasq:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='dnsmasq:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z ntp:*:20397:0:99999:7::: ]]
+ [[ ntp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'ntp:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='ntp:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z logcheck:*:20397:0:99999:7::: ]]
+ [[ logcheck:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'logcheck:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='logcheck:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z saned:*:20397:0:99999:7::: ]]
+ [[ saned:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'saned:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='saned:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z nm-openvpn:*:20397:0:99999:7::: ]]
+ [[ nm-openvpn:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'nm-openvpn:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='nm-openvpn:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z hplip:*:20397:0:99999:7::: ]]
+ [[ hplip:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'hplip:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='hplip:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z avahi:*:20397:0:99999:7::: ]]
+ [[ avahi:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'avahi:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='avahi:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z sshd:*:20397:0:99999:7::: ]]
+ [[ sshd:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sshd:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='sshd:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7::: ]]
+ [[ user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z root:x:0:0:root:/root:/bin/bash ]]
+ [[ root:x:0:0:root:/root:/bin/bash =~ ^[[:space:]]*# ]]
++ echo root:x:0:0:root:/root:/bin/bash
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='root:x:0:0:root:/root:/bin/bash
'
+ IFS=
+ read -r line
+ [[ -z daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin ]]
+ [[ daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z bin:x:2:2:bin:/bin:/usr/sbin/nologin ]]
+ [[ bin:x:2:2:bin:/bin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo bin:x:2:2:bin:/bin:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='bin:x:2:2:bin:/bin:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z sys:x:3:3:sys:/dev:/usr/sbin/nologin ]]
+ [[ sys:x:3:3:sys:/dev:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo sys:x:3:3:sys:/dev:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='sys:x:3:3:sys:/dev:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z sync:x:4:65534:sync:/bin:/bin/sync ]]
+ [[ sync:x:4:65534:sync:/bin:/bin/sync =~ ^[[:space:]]*# ]]
++ echo sync:x:4:65534:sync:/bin:/bin/sync
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='sync:x:4:65534:sync:/bin:/bin/sync
'
+ IFS=
+ read -r line
+ [[ -z games:x:5:60:games:/usr/games:/usr/sbin/nologin ]]
+ [[ games:x:5:60:games:/usr/games:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo games:x:5:60:games:/usr/games:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='games:x:5:60:games:/usr/games:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z man:x:6:12:man:/var/cache/man:/usr/sbin/nologin ]]
+ [[ man:x:6:12:man:/var/cache/man:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin ]]
+ [[ lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z mail:x:8:8:mail:/var/mail:/usr/sbin/nologin ]]
+ [[ mail:x:8:8:mail:/var/mail:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z news:x:9:9:news:/var/spool/news:/usr/sbin/nologin ]]
+ [[ news:x:9:9:news:/var/spool/news:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin ]]
+ [[ uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z proxy:x:13:13:proxy:/bin:/usr/sbin/nologin ]]
+ [[ proxy:x:13:13:proxy:/bin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin ]]
+ [[ www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z backup:x:34:34:backup:/var/backups:/usr/sbin/nologin ]]
+ [[ backup:x:34:34:backup:/var/backups:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin ]]
+ [[ list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin ]]
+ [[ irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin ]]
+ [[ gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin ]]
+ [[ nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false ]]
+ [[ systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false ]]
+ [[ systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false ]]
+ [[ systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false ]]
+ [[ systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z _apt:x:104:65534::/nonexistent:/bin/false ]]
+ [[ _apt:x:104:65534::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo _apt:x:104:65534::/nonexistent:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='_apt:x:104:65534::/nonexistent:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z messagebus:x:105:109::/nonexistent:/bin/false ]]
+ [[ messagebus:x:105:109::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo messagebus:x:105:109::/nonexistent:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='messagebus:x:105:109::/nonexistent:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false ]]
+ [[ astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false =~ ^[[:space:]]*# ]]
++ echo astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false ]]
+ [[ pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z fly-dm:x:108:116::/var/lib/fly-dm:/bin/false ]]
+ [[ fly-dm:x:108:116::/var/lib/fly-dm:/bin/false =~ ^[[:space:]]*# ]]
++ echo fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z Debian-exim:x:109:118::/var/spool/exim4:/bin/false ]]
+ [[ Debian-exim:x:109:118::/var/spool/exim4:/bin/false =~ ^[[:space:]]*# ]]
++ echo Debian-exim:x:109:118::/var/spool/exim4:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='Debian-exim:x:109:118::/var/spool/exim4:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash ]]
+ [[ postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash =~ ^[[:space:]]*# ]]
++ echo 'postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
'
+ IFS=
+ read -r line
+ [[ -z dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false ]]
+ [[ dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false =~ ^[[:space:]]*# ]]
++ echo dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z ntp:x:112:122::/nonexistent:/bin/false ]]
+ [[ ntp:x:112:122::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo ntp:x:112:122::/nonexistent:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='ntp:x:112:122::/nonexistent:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false ]]
+ [[ logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z saned:x:114:124::/var/lib/saned:/bin/false ]]
+ [[ saned:x:114:124::/var/lib/saned:/bin/false =~ ^[[:space:]]*# ]]
++ echo saned:x:114:124::/var/lib/saned:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='saned:x:114:124::/var/lib/saned:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false ]]
+ [[ nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false ]]
+ [[ hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false ]]
+ [[ avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z sshd:x:118:65534::/run/sshd:/usr/sbin/nologin ]]
+ [[ sshd:x:118:65534::/run/sshd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z user:x:1000:1000:,,,:/home/user:/bin/bash ]]
+ [[ user:x:1000:1000:,,,:/home/user:/bin/bash =~ ^[[:space:]]*# ]]
++ echo user:x:1000:1000:,,,:/home/user:/bin/bash
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='user:x:1000:1000:,,,:/home/user:/bin/bash
'
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
 ]]
+ [[ -z root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
 ]]
+ users_without_password=()
+ IFS=
+ read -r line
+ [[ -z root:x:0:0:root:/root:/bin/bash ]]
+ [[ root:x:0:0:root:/root:/bin/bash =~ ^[[:space:]]*# ]]
++ echo root:x:0:0:root:/root:/bin/bash
++ awk -F: '{print $1}'
+ username=root
++ echo root:x:0:0:root:/root:/bin/bash
++ awk -F: '{print $7}'
+ shell=/bin/bash
+ [[ -z root ]]
+ [[ -z /bin/bash ]]
+ [[ /bin/bash != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash != \/\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash != \/\s\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash != \/\u\s\r\/\b\i\n\/\f\a\l\s\e ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=root '$1 == user'
++ head -1
+ shadow_line='root:!:20397:0:99999:7:::'
+ [[ -z root:!:20397:0:99999:7::: ]]
++ echo 'root:!:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='!'
+ [[ -z ! ]]
+ [[ ! == \* ]]
+ [[ ! == \! ]]
+ users_without_password+=("$username")
+ IFS=
+ read -r line
+ [[ -z daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin ]]
+ [[ daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=daemon
++ echo daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z daemon ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z bin:x:2:2:bin:/bin:/usr/sbin/nologin ]]
+ [[ bin:x:2:2:bin:/bin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo bin:x:2:2:bin:/bin:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=bin
++ echo bin:x:2:2:bin:/bin:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z bin ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z sys:x:3:3:sys:/dev:/usr/sbin/nologin ]]
+ [[ sys:x:3:3:sys:/dev:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo sys:x:3:3:sys:/dev:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=sys
++ echo sys:x:3:3:sys:/dev:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z sys ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z sync:x:4:65534:sync:/bin:/bin/sync ]]
+ [[ sync:x:4:65534:sync:/bin:/bin/sync =~ ^[[:space:]]*# ]]
++ echo sync:x:4:65534:sync:/bin:/bin/sync
++ awk -F: '{print $1}'
+ username=sync
++ echo sync:x:4:65534:sync:/bin:/bin/sync
++ awk -F: '{print $7}'
+ shell=/bin/sync
+ [[ -z sync ]]
+ [[ -z /bin/sync ]]
+ [[ /bin/sync != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/sync != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/sync != \/\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/sync != \/\s\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/sync != \/\u\s\r\/\b\i\n\/\f\a\l\s\e ]]
++ awk -F: -v user=sync '$1 == user'
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ head -1
+ shadow_line='sync:*:20397:0:99999:7:::'
+ [[ -z sync:*:20397:0:99999:7::: ]]
++ echo 'sync:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ [[ -z * ]]
+ [[ * == \* ]]
+ users_without_password+=("$username")
+ IFS=
+ read -r line
+ [[ -z games:x:5:60:games:/usr/games:/usr/sbin/nologin ]]
+ [[ games:x:5:60:games:/usr/games:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo games:x:5:60:games:/usr/games:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=games
++ echo games:x:5:60:games:/usr/games:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z games ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z man:x:6:12:man:/var/cache/man:/usr/sbin/nologin ]]
+ [[ man:x:6:12:man:/var/cache/man:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=man
++ echo man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z man ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin ]]
+ [[ lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=lp
++ echo lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z lp ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z mail:x:8:8:mail:/var/mail:/usr/sbin/nologin ]]
+ [[ mail:x:8:8:mail:/var/mail:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=mail
++ echo mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z mail ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z news:x:9:9:news:/var/spool/news:/usr/sbin/nologin ]]
+ [[ news:x:9:9:news:/var/spool/news:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=news
++ echo news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z news ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin ]]
+ [[ uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=uucp
++ echo uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z uucp ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z proxy:x:13:13:proxy:/bin:/usr/sbin/nologin ]]
+ [[ proxy:x:13:13:proxy:/bin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=proxy
++ echo proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z proxy ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin ]]
+ [[ www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=www-data
++ echo www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z www-data ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z backup:x:34:34:backup:/var/backups:/usr/sbin/nologin ]]
+ [[ backup:x:34:34:backup:/var/backups:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=backup
++ echo backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z backup ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin ]]
+ [[ list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin'
++ awk -F: '{print $1}'
+ username=list
++ echo 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin'
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z list ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin ]]
+ [[ irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=irc
++ echo irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z irc ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin ]]
+ [[ gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin'
++ awk -F: '{print $1}'
+ username=gnats
++ echo 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin'
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z gnats ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin ]]
+ [[ nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=nobody
++ echo nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z nobody ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false ]]
+ [[ systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false'
++ awk -F: '{print $1}'
+ username=systemd-timesync
++ echo 'systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z systemd-timesync ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false ]]
+ [[ systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false'
++ awk -F: '{print $1}'
+ username=systemd-network
++ echo 'systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z systemd-network ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false ]]
+ [[ systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false'
++ awk -F: '{print $1}'
+ username=systemd-resolve
++ echo 'systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z systemd-resolve ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false ]]
+ [[ systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false'
++ awk -F: '{print $1}'
+ username=systemd-bus-proxy
++ echo 'systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z systemd-bus-proxy ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z _apt:x:104:65534::/nonexistent:/bin/false ]]
+ [[ _apt:x:104:65534::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo _apt:x:104:65534::/nonexistent:/bin/false
++ awk -F: '{print $1}'
+ username=_apt
++ echo _apt:x:104:65534::/nonexistent:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z _apt ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z messagebus:x:105:109::/nonexistent:/bin/false ]]
+ [[ messagebus:x:105:109::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo messagebus:x:105:109::/nonexistent:/bin/false
++ awk -F: '{print $1}'
+ username=messagebus
++ echo messagebus:x:105:109::/nonexistent:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z messagebus ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false ]]
+ [[ astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false =~ ^[[:space:]]*# ]]
++ echo astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
++ awk -F: '{print $1}'
+ username=astra-orientation
++ echo astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z astra-orientation ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false ]]
+ [[ pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false'
++ awk -F: '{print $1}'
+ username=pulse
++ echo 'pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z pulse ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z fly-dm:x:108:116::/var/lib/fly-dm:/bin/false ]]
+ [[ fly-dm:x:108:116::/var/lib/fly-dm:/bin/false =~ ^[[:space:]]*# ]]
++ echo fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
++ awk -F: '{print $1}'
+ username=fly-dm
++ echo fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z fly-dm ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z Debian-exim:x:109:118::/var/spool/exim4:/bin/false ]]
+ [[ Debian-exim:x:109:118::/var/spool/exim4:/bin/false =~ ^[[:space:]]*# ]]
++ awk -F: '{print $1}'
++ echo Debian-exim:x:109:118::/var/spool/exim4:/bin/false
+ username=Debian-exim
++ echo Debian-exim:x:109:118::/var/spool/exim4:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z Debian-exim ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash ]]
+ [[ postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash =~ ^[[:space:]]*# ]]
++ echo 'postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash'
++ awk -F: '{print $1}'
+ username=postgres
++ echo 'postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash'
++ awk -F: '{print $7}'
+ shell=/bin/bash
+ [[ -z postgres ]]
+ [[ -z /bin/bash ]]
+ [[ /bin/bash != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash != \/\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash != \/\s\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash != \/\u\s\r\/\b\i\n\/\f\a\l\s\e ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=postgres '$1 == user'
++ head -1
+ shadow_line='postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::'
+ [[ -z postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7::: ]]
++ echo 'postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/'
+ [[ -z $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ ]]
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ == \* ]]
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ == \! ]]
+ IFS=
+ read -r line
+ [[ -z dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false ]]
+ [[ dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false =~ ^[[:space:]]*# ]]
++ echo dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
++ awk -F: '{print $1}'
+ username=dnsmasq
++ echo dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z dnsmasq ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z ntp:x:112:122::/nonexistent:/bin/false ]]
+ [[ ntp:x:112:122::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo ntp:x:112:122::/nonexistent:/bin/false
++ awk -F: '{print $1}'
+ username=ntp
++ echo ntp:x:112:122::/nonexistent:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z ntp ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false ]]
+ [[ logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false'
++ awk -F: '{print $1}'
+ username=logcheck
++ echo 'logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z logcheck ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z saned:x:114:124::/var/lib/saned:/bin/false ]]
+ [[ saned:x:114:124::/var/lib/saned:/bin/false =~ ^[[:space:]]*# ]]
++ echo saned:x:114:124::/var/lib/saned:/bin/false
++ awk -F: '{print $1}'
+ username=saned
++ echo saned:x:114:124::/var/lib/saned:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z saned ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false ]]
+ [[ nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false'
++ awk -F: '{print $1}'
+ username=nm-openvpn
++ echo 'nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z nm-openvpn ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false ]]
+ [[ hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false'
++ awk -F: '{print $1}'
+ username=hplip
++ echo 'hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z hplip ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false ]]
+ [[ avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false'
++ awk -F: '{print $1}'
+ username=avahi
++ echo 'avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z avahi ]]
+ [[ -z /bin/false ]]
+ [[ /bin/false != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false != \/\b\i\n\/\f\a\l\s\e ]]
+ IFS=
+ read -r line
+ [[ -z sshd:x:118:65534::/run/sshd:/usr/sbin/nologin ]]
+ [[ sshd:x:118:65534::/run/sshd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=sshd
++ echo sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z sshd ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ /usr/sbin/nologin != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ IFS=
+ read -r line
+ [[ -z user:x:1000:1000:,,,:/home/user:/bin/bash ]]
+ [[ user:x:1000:1000:,,,:/home/user:/bin/bash =~ ^[[:space:]]*# ]]
++ echo user:x:1000:1000:,,,:/home/user:/bin/bash
++ awk -F: '{print $1}'
+ username=user
++ echo user:x:1000:1000:,,,:/home/user:/bin/bash
++ awk -F: '{print $7}'
+ shell=/bin/bash
+ [[ -z user ]]
+ [[ -z /bin/bash ]]
+ [[ /bin/bash != \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash != \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash != \/\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash != \/\s\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash != \/\u\s\r\/\b\i\n\/\f\a\l\s\e ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=user '$1 == user'
++ head -1
+ shadow_line='user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::'
+ [[ -z user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7::: ]]
++ echo 'user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/'
+ [[ -z $gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/ ]]
+ [[ $gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/ == \* ]]
+ [[ $gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/ == \! ]]
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ 2 -gt 0 ]]
+ echo 'Найдены пользователи без пароля (не имеют /sbin/nologin):'
+ for user in "${users_without_password[@]}"
+ echo '  root'
+ for user in "${users_without_password[@]}"
+ echo '  sync'
+ echo 'Не пройдена'
+ exit 44

================================================================================

2026-02-11 10:52:56 [INFO] 
================================================================================
[2026-02-11 10:52:56.831] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/shadow; sudo cat /etc/passwd

>>> EXIT CODE: 0

>>> STDOUT:
root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:57 [INFO] 
================================================================================
[2026-02-11 10:52:57.532] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: d3fe7e10-e064-4c18-b741-113ffdb3f512
Script Name: Запрет входа под root и встроенными УЗ

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "cat /etc/shadow; cat /etc/passwd"
# Проверяем:
# 1. Убедиться, что установлен запрет входа под УЗ root, задан параметр /sbin/nologin (false)
# 2. В случае если параметр не задан /sbin/nologin проверить, что установлен знак «!» или «*» или «!*», 
#    перед хеш-суммой паролем в файле /etc/shadow
# 3. Убедиться, что интерактивных вход в Систему под встроенными УЗ запрещен, 
#    за исключением случаев, приведенных в ПЭД
# Формат /etc/passwd: username:password:uid:gid:gecos:home:shell
# Формат /etc/shadow: username:password_hash:last_change:min:max:warn:inactive:expire:reserved
# Встроенные УЗ обычно имеют UID < 1000

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Разделяем вывод на части /etc/shadow и /etc/passwd
... (total 143 lines, 4897 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 3408 chars, 77 lines:
root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (156 chars):
Найдены нарушения запрета входа для root и встроенных УЗ:
  postgres: shell разрешает вход (/bin/bash), но пароль не заблокирован в /etc/shadow
Не пройдена


>>> STDERR (121007 chars):
+ set -eo pipefail
+ '[' -z 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
' ']'
+ shadow_output=
+ passwd_output=
+ IFS=
+ read -r line
+ [[ -z root:!:20397:0:99999:7::: ]]
+ [[ root:!:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'root:!:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='root:!:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z daemon:*:20397:0:99999:7::: ]]
+ [[ daemon:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'daemon:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='daemon:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z bin:*:20397:0:99999:7::: ]]
+ [[ bin:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'bin:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='bin:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z sys:*:20397:0:99999:7::: ]]
+ [[ sys:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sys:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='sys:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z sync:*:20397:0:99999:7::: ]]
+ [[ sync:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sync:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='sync:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z games:*:20397:0:99999:7::: ]]
+ [[ games:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'games:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='games:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z man:*:20397:0:99999:7::: ]]
+ [[ man:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'man:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='man:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z lp:*:20397:0:99999:7::: ]]
+ [[ lp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'lp:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='lp:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z mail:*:20397:0:99999:7::: ]]
+ [[ mail:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'mail:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='mail:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z news:*:20397:0:99999:7::: ]]
+ [[ news:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'news:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='news:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z uucp:*:20397:0:99999:7::: ]]
+ [[ uucp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'uucp:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='uucp:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z proxy:*:20397:0:99999:7::: ]]
+ [[ proxy:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'proxy:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='proxy:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z www-data:*:20397:0:99999:7::: ]]
+ [[ www-data:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'www-data:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='www-data:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z backup:*:20397:0:99999:7::: ]]
+ [[ backup:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'backup:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='backup:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z list:*:20397:0:99999:7::: ]]
+ [[ list:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'list:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='list:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z irc:*:20397:0:99999:7::: ]]
+ [[ irc:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'irc:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='irc:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z gnats:*:20397:0:99999:7::: ]]
+ [[ gnats:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'gnats:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='gnats:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z nobody:*:20397:0:99999:7::: ]]
+ [[ nobody:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'nobody:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='nobody:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z systemd-timesync:*:20397:0:99999:7::: ]]
+ [[ systemd-timesync:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-timesync:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='systemd-timesync:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z systemd-network:*:20397:0:99999:7::: ]]
+ [[ systemd-network:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-network:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='systemd-network:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z systemd-resolve:*:20397:0:99999:7::: ]]
+ [[ systemd-resolve:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-resolve:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='systemd-resolve:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z systemd-bus-proxy:*:20397:0:99999:7::: ]]
+ [[ systemd-bus-proxy:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'systemd-bus-proxy:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='systemd-bus-proxy:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z _apt:*:20397:0:99999:7::: ]]
+ [[ _apt:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo '_apt:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='_apt:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z messagebus:*:20397:0:99999:7::: ]]
+ [[ messagebus:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'messagebus:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='messagebus:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z astra-orientation:*:20397:0:99999:7::: ]]
+ [[ astra-orientation:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'astra-orientation:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='astra-orientation:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z pulse:*:20397:0:99999:7::: ]]
+ [[ pulse:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'pulse:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='pulse:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z fly-dm:*:20397:0:99999:7::: ]]
+ [[ fly-dm:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'fly-dm:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='fly-dm:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z Debian-exim:!:20397:0:99999:7::: ]]
+ [[ Debian-exim:!:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'Debian-exim:!:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='Debian-exim:!:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7::: ]]
+ [[ postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z dnsmasq:*:20397:0:99999:7::: ]]
+ [[ dnsmasq:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'dnsmasq:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='dnsmasq:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z ntp:*:20397:0:99999:7::: ]]
+ [[ ntp:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ awk -F: '{print NF}'
++ echo 'ntp:*:20397:0:99999:7:::'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='ntp:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z logcheck:*:20397:0:99999:7::: ]]
+ [[ logcheck:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'logcheck:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='logcheck:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z saned:*:20397:0:99999:7::: ]]
+ [[ saned:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'saned:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='saned:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z nm-openvpn:*:20397:0:99999:7::: ]]
+ [[ nm-openvpn:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'nm-openvpn:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='nm-openvpn:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z hplip:*:20397:0:99999:7::: ]]
+ [[ hplip:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'hplip:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='hplip:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z avahi:*:20397:0:99999:7::: ]]
+ [[ avahi:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'avahi:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='avahi:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z sshd:*:20397:0:99999:7::: ]]
+ [[ sshd:*:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'sshd:*:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='sshd:*:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7::: ]]
+ [[ user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7::: =~ ^[[:space:]]*# ]]
++ echo 'user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::'
++ awk -F: '{print NF}'
+ field_count=9
+ [[ 9 -eq 7 ]]
+ [[ 9 -ge 2 ]]
+ [[ 9 -le 9 ]]
+ shadow_output+='user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
+ IFS=
+ read -r line
+ [[ -z root:x:0:0:root:/root:/bin/bash ]]
+ [[ root:x:0:0:root:/root:/bin/bash =~ ^[[:space:]]*# ]]
++ echo root:x:0:0:root:/root:/bin/bash
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='root:x:0:0:root:/root:/bin/bash
'
+ IFS=
+ read -r line
+ [[ -z daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin ]]
+ [[ daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z bin:x:2:2:bin:/bin:/usr/sbin/nologin ]]
+ [[ bin:x:2:2:bin:/bin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo bin:x:2:2:bin:/bin:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='bin:x:2:2:bin:/bin:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z sys:x:3:3:sys:/dev:/usr/sbin/nologin ]]
+ [[ sys:x:3:3:sys:/dev:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo sys:x:3:3:sys:/dev:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='sys:x:3:3:sys:/dev:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z sync:x:4:65534:sync:/bin:/bin/sync ]]
+ [[ sync:x:4:65534:sync:/bin:/bin/sync =~ ^[[:space:]]*# ]]
++ echo sync:x:4:65534:sync:/bin:/bin/sync
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='sync:x:4:65534:sync:/bin:/bin/sync
'
+ IFS=
+ read -r line
+ [[ -z games:x:5:60:games:/usr/games:/usr/sbin/nologin ]]
+ [[ games:x:5:60:games:/usr/games:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo games:x:5:60:games:/usr/games:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='games:x:5:60:games:/usr/games:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z man:x:6:12:man:/var/cache/man:/usr/sbin/nologin ]]
+ [[ man:x:6:12:man:/var/cache/man:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin ]]
+ [[ lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z mail:x:8:8:mail:/var/mail:/usr/sbin/nologin ]]
+ [[ mail:x:8:8:mail:/var/mail:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z news:x:9:9:news:/var/spool/news:/usr/sbin/nologin ]]
+ [[ news:x:9:9:news:/var/spool/news:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin ]]
+ [[ uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z proxy:x:13:13:proxy:/bin:/usr/sbin/nologin ]]
+ [[ proxy:x:13:13:proxy:/bin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin ]]
+ [[ www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z backup:x:34:34:backup:/var/backups:/usr/sbin/nologin ]]
+ [[ backup:x:34:34:backup:/var/backups:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin ]]
+ [[ list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin ]]
+ [[ irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin ]]
+ [[ gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin ]]
+ [[ nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false ]]
+ [[ systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false ]]
+ [[ systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false ]]
+ [[ systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false ]]
+ [[ systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z _apt:x:104:65534::/nonexistent:/bin/false ]]
+ [[ _apt:x:104:65534::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo _apt:x:104:65534::/nonexistent:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='_apt:x:104:65534::/nonexistent:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z messagebus:x:105:109::/nonexistent:/bin/false ]]
+ [[ messagebus:x:105:109::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo messagebus:x:105:109::/nonexistent:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='messagebus:x:105:109::/nonexistent:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false ]]
+ [[ astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false =~ ^[[:space:]]*# ]]
++ echo astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false ]]
+ [[ pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z fly-dm:x:108:116::/var/lib/fly-dm:/bin/false ]]
+ [[ fly-dm:x:108:116::/var/lib/fly-dm:/bin/false =~ ^[[:space:]]*# ]]
++ echo fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z Debian-exim:x:109:118::/var/spool/exim4:/bin/false ]]
+ [[ Debian-exim:x:109:118::/var/spool/exim4:/bin/false =~ ^[[:space:]]*# ]]
++ echo Debian-exim:x:109:118::/var/spool/exim4:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='Debian-exim:x:109:118::/var/spool/exim4:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash ]]
+ [[ postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash =~ ^[[:space:]]*# ]]
++ echo 'postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
'
+ IFS=
+ read -r line
+ [[ -z dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false ]]
+ [[ dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false =~ ^[[:space:]]*# ]]
++ echo dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z ntp:x:112:122::/nonexistent:/bin/false ]]
+ [[ ntp:x:112:122::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo ntp:x:112:122::/nonexistent:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='ntp:x:112:122::/nonexistent:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false ]]
+ [[ logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z saned:x:114:124::/var/lib/saned:/bin/false ]]
+ [[ saned:x:114:124::/var/lib/saned:/bin/false =~ ^[[:space:]]*# ]]
++ echo saned:x:114:124::/var/lib/saned:/bin/false
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='saned:x:114:124::/var/lib/saned:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false ]]
+ [[ nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false ]]
+ [[ hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false ]]
+ [[ avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false'
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
'
+ IFS=
+ read -r line
+ [[ -z sshd:x:118:65534::/run/sshd:/usr/sbin/nologin ]]
+ [[ sshd:x:118:65534::/run/sshd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
'
+ IFS=
+ read -r line
+ [[ -z user:x:1000:1000:,,,:/home/user:/bin/bash ]]
+ [[ user:x:1000:1000:,,,:/home/user:/bin/bash =~ ^[[:space:]]*# ]]
++ echo user:x:1000:1000:,,,:/home/user:/bin/bash
++ awk -F: '{print NF}'
+ field_count=7
+ [[ 7 -eq 7 ]]
+ passwd_output+='user:x:1000:1000:,,,:/home/user:/bin/bash
'
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
 ]]
+ [[ -z root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/nonexistent:/bin/false
astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false
fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
Debian-exim:x:109:118::/var/spool/exim4:/bin/false
postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
ntp:x:112:122::/nonexistent:/bin/false
logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false
saned:x:114:124::/var/lib/saned:/bin/false
nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false
hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false
avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
user:x:1000:1000:,,,:/home/user:/bin/bash
 ]]
+ violations=()
+ IFS=
+ read -r line
+ [[ -z root:x:0:0:root:/root:/bin/bash ]]
+ [[ root:x:0:0:root:/root:/bin/bash =~ ^[[:space:]]*# ]]
++ echo root:x:0:0:root:/root:/bin/bash
++ awk -F: '{print $1}'
+ username=root
++ echo root:x:0:0:root:/root:/bin/bash
++ awk -F: '{print $3}'
+ uid=0
++ echo root:x:0:0:root:/root:/bin/bash
++ awk -F: '{print $7}'
+ shell=/bin/bash
+ [[ -z root ]]
+ [[ -z 0 ]]
+ [[ -z /bin/bash ]]
+ [[ root == \r\o\o\t ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=root '$1 == user'
++ head -1
+ shadow_line='root:!:20397:0:99999:7:::'
+ [[ -z root:!:20397:0:99999:7::: ]]
++ echo 'root:!:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='!'
+ is_restricted_shell /bin/bash
+ local shell=/bin/bash
+ [[ /bin/bash == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash == \/\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash == \/\s\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash == \/\u\s\r\/\b\i\n\/\f\a\l\s\e ]]
+ is_password_locked '!'
+ local 'password_hash=!'
+ [[ ! == \* ]]
+ [[ ! == \! ]]
+ IFS=
+ read -r line
+ [[ -z daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin ]]
+ [[ daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=daemon
++ echo daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=1
++ echo daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z daemon ]]
+ [[ -z 1 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ daemon == \r\o\o\t ]]
+ [[ 1 =~ ^[0-9]+$ ]]
+ [[ 1 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=daemon '$1 == user'
++ head -1
+ shadow_line='daemon:*:20397:0:99999:7:::'
+ [[ -z daemon:*:20397:0:99999:7::: ]]
++ echo 'daemon:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z bin:x:2:2:bin:/bin:/usr/sbin/nologin ]]
+ [[ bin:x:2:2:bin:/bin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo bin:x:2:2:bin:/bin:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=bin
++ echo bin:x:2:2:bin:/bin:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=2
++ echo bin:x:2:2:bin:/bin:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z bin ]]
+ [[ -z 2 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ bin == \r\o\o\t ]]
+ [[ 2 =~ ^[0-9]+$ ]]
+ [[ 2 -lt 1000 ]]
++ awk -F: -v user=bin '$1 == user'
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ head -1
+ shadow_line='bin:*:20397:0:99999:7:::'
+ [[ -z bin:*:20397:0:99999:7::: ]]
++ echo 'bin:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z sys:x:3:3:sys:/dev:/usr/sbin/nologin ]]
+ [[ sys:x:3:3:sys:/dev:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo sys:x:3:3:sys:/dev:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=sys
++ echo sys:x:3:3:sys:/dev:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=3
++ echo sys:x:3:3:sys:/dev:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z sys ]]
+ [[ -z 3 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ sys == \r\o\o\t ]]
+ [[ 3 =~ ^[0-9]+$ ]]
+ [[ 3 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=sys '$1 == user'
++ head -1
+ shadow_line='sys:*:20397:0:99999:7:::'
+ [[ -z sys:*:20397:0:99999:7::: ]]
++ echo 'sys:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z sync:x:4:65534:sync:/bin:/bin/sync ]]
+ [[ sync:x:4:65534:sync:/bin:/bin/sync =~ ^[[:space:]]*# ]]
++ echo sync:x:4:65534:sync:/bin:/bin/sync
++ awk -F: '{print $1}'
+ username=sync
++ echo sync:x:4:65534:sync:/bin:/bin/sync
++ awk -F: '{print $3}'
+ uid=4
++ echo sync:x:4:65534:sync:/bin:/bin/sync
++ awk -F: '{print $7}'
+ shell=/bin/sync
+ [[ -z sync ]]
+ [[ -z 4 ]]
+ [[ -z /bin/sync ]]
+ [[ sync == \r\o\o\t ]]
+ [[ 4 =~ ^[0-9]+$ ]]
+ [[ 4 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=sync '$1 == user'
++ head -1
+ shadow_line='sync:*:20397:0:99999:7:::'
+ [[ -z sync:*:20397:0:99999:7::: ]]
++ echo 'sync:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/sync
+ local shell=/bin/sync
+ [[ /bin/sync == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/sync == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/sync == \/\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/sync == \/\s\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/sync == \/\u\s\r\/\b\i\n\/\f\a\l\s\e ]]
+ is_password_locked '*'
+ local 'password_hash=*'
+ [[ * == \* ]]
+ IFS=
+ read -r line
+ [[ -z games:x:5:60:games:/usr/games:/usr/sbin/nologin ]]
+ [[ games:x:5:60:games:/usr/games:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo games:x:5:60:games:/usr/games:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=games
++ echo games:x:5:60:games:/usr/games:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=5
++ echo games:x:5:60:games:/usr/games:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z games ]]
+ [[ -z 5 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ games == \r\o\o\t ]]
+ [[ 5 =~ ^[0-9]+$ ]]
+ [[ 5 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=games '$1 == user'
++ head -1
+ shadow_line='games:*:20397:0:99999:7:::'
+ [[ -z games:*:20397:0:99999:7::: ]]
++ echo 'games:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z man:x:6:12:man:/var/cache/man:/usr/sbin/nologin ]]
+ [[ man:x:6:12:man:/var/cache/man:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ awk -F: '{print $1}'
++ echo man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
+ username=man
++ echo man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=6
++ echo man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z man ]]
+ [[ -z 6 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ man == \r\o\o\t ]]
+ [[ 6 =~ ^[0-9]+$ ]]
+ [[ 6 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=man '$1 == user'
++ head -1
+ shadow_line='man:*:20397:0:99999:7:::'
+ [[ -z man:*:20397:0:99999:7::: ]]
++ echo 'man:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin ]]
+ [[ lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=lp
++ echo lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=7
++ echo lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z lp ]]
+ [[ -z 7 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ lp == \r\o\o\t ]]
+ [[ 7 =~ ^[0-9]+$ ]]
+ [[ 7 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=lp '$1 == user'
++ head -1
+ shadow_line='lp:*:20397:0:99999:7:::'
+ [[ -z lp:*:20397:0:99999:7::: ]]
++ echo 'lp:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z mail:x:8:8:mail:/var/mail:/usr/sbin/nologin ]]
+ [[ mail:x:8:8:mail:/var/mail:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=mail
++ echo mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=8
++ echo mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z mail ]]
+ [[ -z 8 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ mail == \r\o\o\t ]]
+ [[ 8 =~ ^[0-9]+$ ]]
+ [[ 8 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=mail '$1 == user'
++ head -1
+ shadow_line='mail:*:20397:0:99999:7:::'
+ [[ -z mail:*:20397:0:99999:7::: ]]
++ echo 'mail:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z news:x:9:9:news:/var/spool/news:/usr/sbin/nologin ]]
+ [[ news:x:9:9:news:/var/spool/news:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=news
++ echo news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=9
++ echo news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z news ]]
+ [[ -z 9 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ news == \r\o\o\t ]]
+ [[ 9 =~ ^[0-9]+$ ]]
+ [[ 9 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=news '$1 == user'
++ head -1
+ shadow_line='news:*:20397:0:99999:7:::'
+ [[ -z news:*:20397:0:99999:7::: ]]
++ echo 'news:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin ]]
+ [[ uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=uucp
++ echo uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=10
++ echo uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z uucp ]]
+ [[ -z 10 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ uucp == \r\o\o\t ]]
+ [[ 10 =~ ^[0-9]+$ ]]
+ [[ 10 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=uucp '$1 == user'
++ head -1
+ shadow_line='uucp:*:20397:0:99999:7:::'
+ [[ -z uucp:*:20397:0:99999:7::: ]]
++ echo 'uucp:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z proxy:x:13:13:proxy:/bin:/usr/sbin/nologin ]]
+ [[ proxy:x:13:13:proxy:/bin:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=proxy
++ echo proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=13
++ echo proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z proxy ]]
+ [[ -z 13 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ proxy == \r\o\o\t ]]
+ [[ 13 =~ ^[0-9]+$ ]]
+ [[ 13 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=proxy '$1 == user'
++ head -1
+ shadow_line='proxy:*:20397:0:99999:7:::'
+ [[ -z proxy:*:20397:0:99999:7::: ]]
++ echo 'proxy:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin ]]
+ [[ www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=www-data
++ echo www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=33
++ echo www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z www-data ]]
+ [[ -z 33 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ www-data == \r\o\o\t ]]
+ [[ 33 =~ ^[0-9]+$ ]]
+ [[ 33 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=www-data '$1 == user'
++ head -1
+ shadow_line='www-data:*:20397:0:99999:7:::'
+ [[ -z www-data:*:20397:0:99999:7::: ]]
++ echo 'www-data:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z backup:x:34:34:backup:/var/backups:/usr/sbin/nologin ]]
+ [[ backup:x:34:34:backup:/var/backups:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=backup
++ echo backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=34
++ awk -F: '{print $7}'
++ echo backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
+ shell=/usr/sbin/nologin
+ [[ -z backup ]]
+ [[ -z 34 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ backup == \r\o\o\t ]]
+ [[ 34 =~ ^[0-9]+$ ]]
+ [[ 34 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=backup '$1 == user'
++ head -1
+ shadow_line='backup:*:20397:0:99999:7:::'
+ [[ -z backup:*:20397:0:99999:7::: ]]
++ echo 'backup:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin ]]
+ [[ list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin'
++ awk -F: '{print $1}'
+ username=list
++ echo 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin'
++ awk -F: '{print $3}'
+ uid=38
++ echo 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin'
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z list ]]
+ [[ -z 38 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ list == \r\o\o\t ]]
+ [[ 38 =~ ^[0-9]+$ ]]
+ [[ 38 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=list '$1 == user'
++ head -1
+ shadow_line='list:*:20397:0:99999:7:::'
+ [[ -z list:*:20397:0:99999:7::: ]]
++ echo 'list:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin ]]
+ [[ irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=irc
++ echo irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=39
++ echo irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z irc ]]
+ [[ -z 39 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ irc == \r\o\o\t ]]
+ [[ 39 =~ ^[0-9]+$ ]]
+ [[ 39 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=irc '$1 == user'
++ head -1
+ shadow_line='irc:*:20397:0:99999:7:::'
+ [[ -z irc:*:20397:0:99999:7::: ]]
++ echo 'irc:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin ]]
+ [[ gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin'
++ awk -F: '{print $1}'
+ username=gnats
++ echo 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin'
++ awk -F: '{print $3}'
+ uid=41
++ echo 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin'
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z gnats ]]
+ [[ -z 41 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ gnats == \r\o\o\t ]]
+ [[ 41 =~ ^[0-9]+$ ]]
+ [[ 41 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=gnats '$1 == user'
++ head -1
+ shadow_line='gnats:*:20397:0:99999:7:::'
+ [[ -z gnats:*:20397:0:99999:7::: ]]
++ echo 'gnats:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin ]]
+ [[ nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=nobody
++ echo nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=65534
++ echo nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z nobody ]]
+ [[ -z 65534 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ nobody == \r\o\o\t ]]
+ [[ 65534 =~ ^[0-9]+$ ]]
+ [[ 65534 -lt 1000 ]]
+ IFS=
+ read -r line
+ [[ -z systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false ]]
+ [[ systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false'
++ awk -F: '{print $1}'
+ username=systemd-timesync
++ echo 'systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false'
++ awk -F: '{print $3}'
+ uid=100
++ echo 'systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z systemd-timesync ]]
+ [[ -z 100 ]]
+ [[ -z /bin/false ]]
+ [[ systemd-timesync == \r\o\o\t ]]
+ [[ 100 =~ ^[0-9]+$ ]]
+ [[ 100 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=systemd-timesync '$1 == user'
++ head -1
+ shadow_line='systemd-timesync:*:20397:0:99999:7:::'
+ [[ -z systemd-timesync:*:20397:0:99999:7::: ]]
++ echo 'systemd-timesync:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false ]]
+ [[ systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false'
++ awk -F: '{print $1}'
+ username=systemd-network
++ echo 'systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false'
++ awk -F: '{print $3}'
+ uid=101
++ echo 'systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z systemd-network ]]
+ [[ -z 101 ]]
+ [[ -z /bin/false ]]
+ [[ systemd-network == \r\o\o\t ]]
+ [[ 101 =~ ^[0-9]+$ ]]
+ [[ 101 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=systemd-network '$1 == user'
++ head -1
+ shadow_line='systemd-network:*:20397:0:99999:7:::'
+ [[ -z systemd-network:*:20397:0:99999:7::: ]]
++ echo 'systemd-network:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false ]]
+ [[ systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false'
++ awk -F: '{print $1}'
+ username=systemd-resolve
++ echo 'systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false'
++ awk -F: '{print $3}'
+ uid=102
++ echo 'systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z systemd-resolve ]]
+ [[ -z 102 ]]
+ [[ -z /bin/false ]]
+ [[ systemd-resolve == \r\o\o\t ]]
+ [[ 102 =~ ^[0-9]+$ ]]
+ [[ 102 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=systemd-resolve '$1 == user'
++ head -1
+ shadow_line='systemd-resolve:*:20397:0:99999:7:::'
+ [[ -z systemd-resolve:*:20397:0:99999:7::: ]]
++ echo 'systemd-resolve:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false ]]
+ [[ systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false'
++ awk -F: '{print $1}'
+ username=systemd-bus-proxy
++ echo 'systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false'
++ awk -F: '{print $3}'
+ uid=103
++ echo 'systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z systemd-bus-proxy ]]
+ [[ -z 103 ]]
+ [[ -z /bin/false ]]
+ [[ systemd-bus-proxy == \r\o\o\t ]]
+ [[ 103 =~ ^[0-9]+$ ]]
+ [[ 103 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=systemd-bus-proxy '$1 == user'
++ head -1
+ shadow_line='systemd-bus-proxy:*:20397:0:99999:7:::'
+ [[ -z systemd-bus-proxy:*:20397:0:99999:7::: ]]
++ echo 'systemd-bus-proxy:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z _apt:x:104:65534::/nonexistent:/bin/false ]]
+ [[ _apt:x:104:65534::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo _apt:x:104:65534::/nonexistent:/bin/false
++ awk -F: '{print $1}'
+ username=_apt
++ echo _apt:x:104:65534::/nonexistent:/bin/false
++ awk -F: '{print $3}'
+ uid=104
++ echo _apt:x:104:65534::/nonexistent:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z _apt ]]
+ [[ -z 104 ]]
+ [[ -z /bin/false ]]
+ [[ _apt == \r\o\o\t ]]
+ [[ 104 =~ ^[0-9]+$ ]]
+ [[ 104 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=_apt '$1 == user'
++ head -1
+ shadow_line='_apt:*:20397:0:99999:7:::'
+ [[ -z _apt:*:20397:0:99999:7::: ]]
++ echo '_apt:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z messagebus:x:105:109::/nonexistent:/bin/false ]]
+ [[ messagebus:x:105:109::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo messagebus:x:105:109::/nonexistent:/bin/false
++ awk -F: '{print $1}'
+ username=messagebus
++ echo messagebus:x:105:109::/nonexistent:/bin/false
++ awk -F: '{print $3}'
+ uid=105
++ echo messagebus:x:105:109::/nonexistent:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z messagebus ]]
+ [[ -z 105 ]]
+ [[ -z /bin/false ]]
+ [[ messagebus == \r\o\o\t ]]
+ [[ 105 =~ ^[0-9]+$ ]]
+ [[ 105 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=messagebus '$1 == user'
++ head -1
+ shadow_line='messagebus:*:20397:0:99999:7:::'
+ [[ -z messagebus:*:20397:0:99999:7::: ]]
++ echo 'messagebus:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false ]]
+ [[ astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false =~ ^[[:space:]]*# ]]
++ echo astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
++ awk -F: '{print $1}'
+ username=astra-orientation
++ echo astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
++ awk -F: '{print $3}'
+ uid=106
++ echo astra-orientation:x:106:110::/var/cache/astra-orientation:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z astra-orientation ]]
+ [[ -z 106 ]]
+ [[ -z /bin/false ]]
+ [[ astra-orientation == \r\o\o\t ]]
+ [[ 106 =~ ^[0-9]+$ ]]
+ [[ 106 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=astra-orientation '$1 == user'
++ head -1
+ shadow_line='astra-orientation:*:20397:0:99999:7:::'
+ [[ -z astra-orientation:*:20397:0:99999:7::: ]]
++ echo 'astra-orientation:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false ]]
+ [[ pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false'
++ awk -F: '{print $1}'
+ username=pulse
++ echo 'pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false'
++ awk -F: '{print $3}'
+ uid=107
++ echo 'pulse:x:107:113:PulseAudio daemon,,,:/var/run/pulse:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z pulse ]]
+ [[ -z 107 ]]
+ [[ -z /bin/false ]]
+ [[ pulse == \r\o\o\t ]]
+ [[ 107 =~ ^[0-9]+$ ]]
+ [[ 107 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=pulse '$1 == user'
++ head -1
+ shadow_line='pulse:*:20397:0:99999:7:::'
+ [[ -z pulse:*:20397:0:99999:7::: ]]
++ echo 'pulse:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z fly-dm:x:108:116::/var/lib/fly-dm:/bin/false ]]
+ [[ fly-dm:x:108:116::/var/lib/fly-dm:/bin/false =~ ^[[:space:]]*# ]]
++ echo fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
++ awk -F: '{print $1}'
+ username=fly-dm
++ echo fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
++ awk -F: '{print $3}'
+ uid=108
++ echo fly-dm:x:108:116::/var/lib/fly-dm:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z fly-dm ]]
+ [[ -z 108 ]]
+ [[ -z /bin/false ]]
+ [[ fly-dm == \r\o\o\t ]]
+ [[ 108 =~ ^[0-9]+$ ]]
+ [[ 108 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=fly-dm '$1 == user'
++ head -1
+ shadow_line='fly-dm:*:20397:0:99999:7:::'
+ [[ -z fly-dm:*:20397:0:99999:7::: ]]
++ echo 'fly-dm:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z Debian-exim:x:109:118::/var/spool/exim4:/bin/false ]]
+ [[ Debian-exim:x:109:118::/var/spool/exim4:/bin/false =~ ^[[:space:]]*# ]]
++ echo Debian-exim:x:109:118::/var/spool/exim4:/bin/false
++ awk -F: '{print $1}'
+ username=Debian-exim
++ echo Debian-exim:x:109:118::/var/spool/exim4:/bin/false
++ awk -F: '{print $3}'
+ uid=109
++ echo Debian-exim:x:109:118::/var/spool/exim4:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z Debian-exim ]]
+ [[ -z 109 ]]
+ [[ -z /bin/false ]]
+ [[ Debian-exim == \r\o\o\t ]]
+ [[ 109 =~ ^[0-9]+$ ]]
+ [[ 109 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=Debian-exim '$1 == user'
++ head -1
+ shadow_line='Debian-exim:!:20397:0:99999:7:::'
+ [[ -z Debian-exim:!:20397:0:99999:7::: ]]
++ echo 'Debian-exim:!:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='!'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash ]]
+ [[ postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash =~ ^[[:space:]]*# ]]
++ echo 'postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash'
++ awk -F: '{print $1}'
+ username=postgres
++ echo 'postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash'
++ awk -F: '{print $3}'
+ uid=110
++ echo 'postgres:x:110:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash'
++ awk -F: '{print $7}'
+ shell=/bin/bash
+ [[ -z postgres ]]
+ [[ -z 110 ]]
+ [[ -z /bin/bash ]]
+ [[ postgres == \r\o\o\t ]]
+ [[ 110 =~ ^[0-9]+$ ]]
+ [[ 110 -lt 1000 ]]
++ awk -F: -v user=postgres '$1 == user'
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ head -1
+ shadow_line='postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::'
+ [[ -z postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7::: ]]
++ echo 'postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/'
+ is_restricted_shell /bin/bash
+ local shell=/bin/bash
+ [[ /bin/bash == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/bash == \/\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash == \/\s\b\i\n\/\f\a\l\s\e ]]
+ [[ /bin/bash == \/\u\s\r\/\b\i\n\/\f\a\l\s\e ]]
+ is_password_locked '$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/'
+ local 'password_hash=$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/'
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ == \* ]]
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ == \! ]]
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ == \!\* ]]
+ [[ $gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/ == \!* ]]
+ violations+=("$username: shell разрешает вход ($shell), но пароль не заблокирован в /etc/shadow")
+ IFS=
+ read -r line
+ [[ -z dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false ]]
+ [[ dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false =~ ^[[:space:]]*# ]]
++ echo dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
++ awk -F: '{print $1}'
+ username=dnsmasq
++ echo dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
++ awk -F: '{print $3}'
+ uid=111
++ echo dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z dnsmasq ]]
+ [[ -z 111 ]]
+ [[ -z /bin/false ]]
+ [[ dnsmasq == \r\o\o\t ]]
+ [[ 111 =~ ^[0-9]+$ ]]
+ [[ 111 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=dnsmasq '$1 == user'
++ head -1
+ shadow_line='dnsmasq:*:20397:0:99999:7:::'
+ [[ -z dnsmasq:*:20397:0:99999:7::: ]]
++ echo 'dnsmasq:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z ntp:x:112:122::/nonexistent:/bin/false ]]
+ [[ ntp:x:112:122::/nonexistent:/bin/false =~ ^[[:space:]]*# ]]
++ echo ntp:x:112:122::/nonexistent:/bin/false
++ awk -F: '{print $1}'
+ username=ntp
++ echo ntp:x:112:122::/nonexistent:/bin/false
++ awk -F: '{print $3}'
+ uid=112
++ echo ntp:x:112:122::/nonexistent:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z ntp ]]
+ [[ -z 112 ]]
+ [[ -z /bin/false ]]
+ [[ ntp == \r\o\o\t ]]
+ [[ 112 =~ ^[0-9]+$ ]]
+ [[ 112 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=ntp '$1 == user'
++ head -1
+ shadow_line='ntp:*:20397:0:99999:7:::'
+ [[ -z ntp:*:20397:0:99999:7::: ]]
++ echo 'ntp:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false ]]
+ [[ logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false'
++ awk -F: '{print $1}'
+ username=logcheck
++ echo 'logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false'
++ awk -F: '{print $3}'
+ uid=113
++ echo 'logcheck:x:113:123:logcheck system account,,,:/var/lib/logcheck:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z logcheck ]]
+ [[ -z 113 ]]
+ [[ -z /bin/false ]]
+ [[ logcheck == \r\o\o\t ]]
+ [[ 113 =~ ^[0-9]+$ ]]
+ [[ 113 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=logcheck '$1 == user'
++ head -1
+ shadow_line='logcheck:*:20397:0:99999:7:::'
+ [[ -z logcheck:*:20397:0:99999:7::: ]]
++ echo 'logcheck:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z saned:x:114:124::/var/lib/saned:/bin/false ]]
+ [[ saned:x:114:124::/var/lib/saned:/bin/false =~ ^[[:space:]]*# ]]
++ echo saned:x:114:124::/var/lib/saned:/bin/false
++ awk -F: '{print $1}'
+ username=saned
++ echo saned:x:114:124::/var/lib/saned:/bin/false
++ awk -F: '{print $3}'
+ uid=114
++ echo saned:x:114:124::/var/lib/saned:/bin/false
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z saned ]]
+ [[ -z 114 ]]
+ [[ -z /bin/false ]]
+ [[ saned == \r\o\o\t ]]
+ [[ 114 =~ ^[0-9]+$ ]]
+ [[ 114 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=saned '$1 == user'
++ head -1
+ shadow_line='saned:*:20397:0:99999:7:::'
+ [[ -z saned:*:20397:0:99999:7::: ]]
++ echo 'saned:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false ]]
+ [[ nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false'
++ awk -F: '{print $1}'
+ username=nm-openvpn
++ echo 'nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false'
++ awk -F: '{print $3}'
+ uid=115
++ echo 'nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z nm-openvpn ]]
+ [[ -z 115 ]]
+ [[ -z /bin/false ]]
+ [[ nm-openvpn == \r\o\o\t ]]
+ [[ 115 =~ ^[0-9]+$ ]]
+ [[ 115 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=nm-openvpn '$1 == user'
++ head -1
+ shadow_line='nm-openvpn:*:20397:0:99999:7:::'
+ [[ -z nm-openvpn:*:20397:0:99999:7::: ]]
++ echo 'nm-openvpn:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false ]]
+ [[ hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false'
++ awk -F: '{print $1}'
+ username=hplip
++ echo 'hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false'
++ awk -F: '{print $3}'
+ uid=116
++ echo 'hplip:x:116:7:HPLIP system user,,,:/run/hplip:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z hplip ]]
+ [[ -z 116 ]]
+ [[ -z /bin/false ]]
+ [[ hplip == \r\o\o\t ]]
+ [[ 116 =~ ^[0-9]+$ ]]
+ [[ 116 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=hplip '$1 == user'
++ head -1
+ shadow_line='hplip:*:20397:0:99999:7:::'
+ [[ -z hplip:*:20397:0:99999:7::: ]]
++ echo 'hplip:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false ]]
+ [[ avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false =~ ^[[:space:]]*# ]]
++ echo 'avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false'
++ awk -F: '{print $1}'
+ username=avahi
++ echo 'avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false'
++ awk -F: '{print $3}'
+ uid=117
++ echo 'avahi:x:117:126:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false'
++ awk -F: '{print $7}'
+ shell=/bin/false
+ [[ -z avahi ]]
+ [[ -z 117 ]]
+ [[ -z /bin/false ]]
+ [[ avahi == \r\o\o\t ]]
+ [[ 117 =~ ^[0-9]+$ ]]
+ [[ 117 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=avahi '$1 == user'
++ head -1
+ shadow_line='avahi:*:20397:0:99999:7:::'
+ [[ -z avahi:*:20397:0:99999:7::: ]]
++ echo 'avahi:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /bin/false
+ local shell=/bin/false
+ [[ /bin/false == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /bin/false == \/\b\i\n\/\f\a\l\s\e ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z sshd:x:118:65534::/run/sshd:/usr/sbin/nologin ]]
+ [[ sshd:x:118:65534::/run/sshd:/usr/sbin/nologin =~ ^[[:space:]]*# ]]
++ echo sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
++ awk -F: '{print $1}'
+ username=sshd
++ echo sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
++ awk -F: '{print $3}'
+ uid=118
++ echo sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
++ awk -F: '{print $7}'
+ shell=/usr/sbin/nologin
+ [[ -z sshd ]]
+ [[ -z 118 ]]
+ [[ -z /usr/sbin/nologin ]]
+ [[ sshd == \r\o\o\t ]]
+ [[ 118 =~ ^[0-9]+$ ]]
+ [[ 118 -lt 1000 ]]
++ echo 'root:!:20397:0:99999:7:::
daemon:*:20397:0:99999:7:::
bin:*:20397:0:99999:7:::
sys:*:20397:0:99999:7:::
sync:*:20397:0:99999:7:::
games:*:20397:0:99999:7:::
man:*:20397:0:99999:7:::
lp:*:20397:0:99999:7:::
mail:*:20397:0:99999:7:::
news:*:20397:0:99999:7:::
uucp:*:20397:0:99999:7:::
proxy:*:20397:0:99999:7:::
www-data:*:20397:0:99999:7:::
backup:*:20397:0:99999:7:::
list:*:20397:0:99999:7:::
irc:*:20397:0:99999:7:::
gnats:*:20397:0:99999:7:::
nobody:*:20397:0:99999:7:::
systemd-timesync:*:20397:0:99999:7:::
systemd-network:*:20397:0:99999:7:::
systemd-resolve:*:20397:0:99999:7:::
systemd-bus-proxy:*:20397:0:99999:7:::
_apt:*:20397:0:99999:7:::
messagebus:*:20397:0:99999:7:::
astra-orientation:*:20397:0:99999:7:::
pulse:*:20397:0:99999:7:::
fly-dm:*:20397:0:99999:7:::
Debian-exim:!:20397:0:99999:7:::
postgres:$gost12512hash$USHPwd7m$Mp/lRV2pKrdFLcizCJUzo34oiTOytSC4Tx.YfAEFQoora6t7GnFABUfPd.EFNrNDogEy1pvbhEc3O75Ar5h4O/:20397:0:99999:7:::
dnsmasq:*:20397:0:99999:7:::
ntp:*:20397:0:99999:7:::
logcheck:*:20397:0:99999:7:::
saned:*:20397:0:99999:7:::
nm-openvpn:*:20397:0:99999:7:::
hplip:*:20397:0:99999:7:::
avahi:*:20397:0:99999:7:::
sshd:*:20397:0:99999:7:::
user:$gost12512hash$dTA1m3nF$jkh6ySBAEqJnOQU2GMoQ80tiyKwEJzRkSbAT4pFT6CyXzvR.toIY1P8WlBZzx/D.qeDgfQofFaB713GhceShm/:20397:0:99999:7:::
'
++ awk -F: -v user=sshd '$1 == user'
++ head -1
+ shadow_line='sshd:*:20397:0:99999:7:::'
+ [[ -z sshd:*:20397:0:99999:7::: ]]
++ echo 'sshd:*:20397:0:99999:7:::'
++ awk -F: '{print $2}'
+ password_hash='*'
+ is_restricted_shell /usr/sbin/nologin
+ local shell=/usr/sbin/nologin
+ [[ /usr/sbin/nologin == \/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ [[ /usr/sbin/nologin == \/\u\s\r\/\s\b\i\n\/\n\o\l\o\g\i\n ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z user:x:1000:1000:,,,:/home/user:/bin/bash ]]
+ [[ user:x:1000:1000:,,,:/home/user:/bin/bash =~ ^[[:space:]]*# ]]
++ echo user:x:1000:1000:,,,:/home/user:/bin/bash
++ awk -F: '{print $1}'
+ username=user
++ echo user:x:1000:1000:,,,:/home/user:/bin/bash
++ awk -F: '{print $3}'
+ uid=1000
++ echo user:x:1000:1000:,,,:/home/user:/bin/bash
++ awk -F: '{print $7}'
+ shell=/bin/bash
+ [[ -z user ]]
+ [[ -z 1000 ]]
+ [[ -z /bin/bash ]]
+ [[ user == \r\o\o\t ]]
+ [[ 1000 =~ ^[0-9]+$ ]]
+ [[ 1000 -lt 1000 ]]
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ 1 -gt 0 ]]
+ echo 'Найдены нарушения запрета входа для root и встроенных УЗ:'
+ for violation in "${violations[@]}"
+ echo '  postgres: shell разрешает вход (/bin/bash), но пароль не заблокирован в /etc/shadow'
+ echo 'Не пройдена'
+ exit 44

================================================================================

2026-02-11 10:52:57 [INFO] 
================================================================================
[2026-02-11 10:52:57.674] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/sudoers

>>> EXIT CODE: 0

>>> STDOUT:
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:57 [INFO] 
================================================================================
[2026-02-11 10:52:57.857] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: d315f8d2-b235-45fb-a4b1-cab4871e1a2a
Script Name: sudoers без комментов

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "cat /etc/sudoers"
# Проверяем, что директивы #include и/или #includedir не активны
# (имеют вид: # (пробел) include /etc/sudoers.d или полностью закомментированы)
# Активные директивы (без пробела после # или без # вообще) - это нарушение

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Список активных (не закомментированных) директив
active_directives=()

# Проверяем каждую строку
while IFS= read -r line; do
    # Пропускаем пустые строки
    if [[ -z "$line" ]]; then
... (total 67 lines, 2152 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 710 chars, 29 lines:
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (185 chars):
Найдены активные директивы include/includedir (должны быть закомментированы):
  # See sudoers(5) for more information on "#include" directives:
  #includedir /etc/sudoers.d
Не пройдена


>>> STDERR (7709 chars):
+ set -eo pipefail
+ '[' -z '#
# This file MUST be edited with the '\''visudo'\'' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL
' ']'
+ active_directives=()
+ IFS=
+ read -r line
+ [[ -z # ]]
++ echo '#'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='#'
+ echo '#'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z # This file MUST be edited with the 'visudo' command as root. ]]
++ echo '# This file MUST be edited with the '\''visudo'\'' command as root.'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# This file MUST be edited with the '\''visudo'\'' command as root.'
+ echo '# This file MUST be edited with the '\''visudo'\'' command as root.'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z # ]]
++ echo '#'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='#'
+ echo '#'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z # Please consider adding local content in /etc/sudoers.d/ instead of ]]
++ echo '# Please consider adding local content in /etc/sudoers.d/ instead of'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# Please consider adding local content in /etc/sudoers.d/ instead of'
+ echo '# Please consider adding local content in /etc/sudoers.d/ instead of'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z # directly modifying this file. ]]
++ echo '# directly modifying this file.'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# directly modifying this file.'
+ echo '# directly modifying this file.'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z # ]]
++ echo '#'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='#'
+ echo '#'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z # See the man page for details on how to write a sudoers file. ]]
++ echo '# See the man page for details on how to write a sudoers file.'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# See the man page for details on how to write a sudoers file.'
+ echo '# See the man page for details on how to write a sudoers file.'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z # ]]
++ echo '#'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='#'
+ echo '#'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z Defaults	env_reset ]]
++ echo 'Defaults	env_reset'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='Defaults	env_reset'
+ echo 'Defaults	env_reset'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z Defaults	mail_badpass ]]
++ echo 'Defaults	mail_badpass'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='Defaults	mail_badpass'
+ echo 'Defaults	mail_badpass'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" ]]
++ echo 'Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"'
+ echo 'Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z # Host alias specification ]]
++ echo '# Host alias specification'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# Host alias specification'
+ echo '# Host alias specification'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z # User alias specification ]]
++ echo '# User alias specification'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# User alias specification'
+ echo '# User alias specification'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z # Cmnd alias specification ]]
++ echo '# Cmnd alias specification'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# Cmnd alias specification'
+ echo '# Cmnd alias specification'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z # User privilege specification ]]
++ echo '# User privilege specification'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# User privilege specification'
+ echo '# User privilege specification'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z root	ALL=(ALL:ALL) ALL ]]
++ echo 'root	ALL=(ALL:ALL) ALL'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='root	ALL=(ALL:ALL) ALL'
+ echo 'root	ALL=(ALL:ALL) ALL'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z # Allow members of group sudo to execute any command ]]
++ sed 's/^[[:space:]]*//'
++ echo '# Allow members of group sudo to execute any command'
+ trimmed_line='# Allow members of group sudo to execute any command'
+ echo '# Allow members of group sudo to execute any command'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z %sudo	ALL=(ALL:ALL) ALL ]]
++ echo '%sudo	ALL=(ALL:ALL) ALL'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='%sudo	ALL=(ALL:ALL) ALL'
+ echo '%sudo	ALL=(ALL:ALL) ALL'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z # See sudoers(5) for more information on "#include" directives: ]]
++ echo '# See sudoers(5) for more information on "#include" directives:'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='# See sudoers(5) for more information on "#include" directives:'
+ echo '# See sudoers(5) for more information on "#include" directives:'
+ grep -qiE '(include|includedir)'
+ echo '# See sudoers(5) for more information on "#include" directives:'
+ grep -qE '^#[[:space:]]+(include|includedir)'
+ echo '# See sudoers(5) for more information on "#include" directives:'
+ grep -qE '^##'
+ active_directives+=("$line")
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ -z #includedir /etc/sudoers.d ]]
++ echo '#includedir /etc/sudoers.d'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='#includedir /etc/sudoers.d'
+ echo '#includedir /etc/sudoers.d'
+ grep -qiE '(include|includedir)'
+ echo '#includedir /etc/sudoers.d'
+ grep -qE '^#[[:space:]]+(include|includedir)'
+ echo '#includedir /etc/sudoers.d'
+ grep -qE '^##'
+ active_directives+=("$line")
+ IFS=
+ read -r line
+ [[ -z %astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL ]]
++ echo '%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
++ sed 's/^[[:space:]]*//'
+ trimmed_line='%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
+ echo '%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
+ grep -qiE '(include|includedir)'
+ continue
+ IFS=
+ read -r line
+ [[ -z '' ]]
+ continue
+ IFS=
+ read -r line
+ [[ 2 -gt 0 ]]
+ echo 'Найдены активные директивы include/includedir (должны быть закомментированы):'
+ for directive in "${active_directives[@]}"
+ echo '  # See sudoers(5) for more information on "#include" directives:'
+ for directive in "${active_directives[@]}"
+ echo '  #includedir /etc/sudoers.d'
+ echo 'Не пройдена'
+ exit 44

================================================================================

2026-02-11 10:52:57 [INFO] 
================================================================================
[2026-02-11 10:52:57.993] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo grep PermitRootLogin /etc/ssh/sshd_config

>>> EXIT CODE: 0

>>> STDOUT:
#PermitRootLogin prohibit-password
# the setting of "PermitRootLogin without-password".


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.005] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 6b8bfd15-50ec-4eed-8497-29c384d499ab
Script Name: PermitRootLogin

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "sudo grep PermitRootLogin /etc/ssh/sshd_config"
# Проверяем, что указан запрет регистрации по SSH от УЗ root
# Параметр должен быть: PermitRootLogin no
# Строка должна быть активной (не закомментированной)

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Ищем активную (не закомментированную) строку с PermitRootLogin
# В sshd_config может быть несколько строк, берем последнюю активную
# Формат может быть: PermitRootLogin no или PermitRootLogin=no

# Ищем все активные строки (не закомментированные)
# Исключаем строки, начинающиеся с # или содержащие только пробелы и #
active_lines=$(echo "$CHECK_OUTPUT" | grep -iE 'PermitRootLogin' | grep -vE '^[[:space:]]*#' || true)
... (total 58 lines, 2054 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 88 chars, 3 lines:
#PermitRootLogin prohibit-password
# the setting of "PermitRootLogin without-password".


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (58 chars):
Не найдена активная директива PermitRootLogin
Не пройдена


>>> STDERR (403 chars):
+ set -eo pipefail
+ '[' -z '#PermitRootLogin prohibit-password
# the setting of "PermitRootLogin without-password".
' ']'
++ echo '#PermitRootLogin prohibit-password
# the setting of "PermitRootLogin without-password".
'
++ grep -iE PermitRootLogin
++ grep -vE '^[[:space:]]*#'
++ true
+ active_lines=
+ [[ -z '' ]]
+ echo 'Не найдена активная директива PermitRootLogin'
+ echo 'Не пройдена'
+ exit 44

================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.136] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/securetty

>>> EXIT CODE: 0

>>> STDOUT:
# /etc/securetty: list of terminals on which root is allowed to login.
# See securetty(5) and login(1).

console

# Local X displays (allows empty passwords with pam_unix's nullok_secure)
:0
:0.0
:0.1
:1
:1.0
:1.1
:2
:2.0
:2.1
:3
:3.0
:3.1
#...


# ==========================================================
#
# TTYs sorted by major number according to Documentation/devices.txt
#
# ==========================================================

# Virtual consoles
tty1
tty2
tty3
tty4
tty5
tty6
tty7
tty8
tty9
tty10
tty11
tty12
tty13
tty14
tty15
tty16
tty17
tty18
tty19
tty20
tty21
tty22
tty23
tty24
tty25
tty26
tty27
tty28
tty29
tty30
tty31
tty32
tty33
tty34
tty35
tty36
tty37
tty38
tty39
tty40
tty41
tty42
tty43
tty44
tty45
tty46
tty47
tty48
tty49
tty50
tty51
tty52
tty53
tty54
tty55
tty56
tty57
tty58
tty59
tty60
tty61
tty62
tty63

# UART serial ports
ttyS0
ttyS1
ttyS2
ttyS3
ttyS4
ttyS5
#...ttyS191

# Serial Mux devices	(Linux/PA-RISC only)
ttyB0
ttyB1
#...

# Chase serial card
ttyH0
ttyH1
#...

# Cyclades serial cards
ttyC0
ttyC1
#...ttyC31

# Digiboard serial cards
ttyD0
ttyD1
#...

# Stallion serial cards
ttyE0
ttyE1
#...ttyE255

# Specialix serial cards
ttyX0
ttyX1
#...

# Comtrol Rocketport serial cards
ttyR0
ttyR1
#...

# SDL RISCom serial cards
ttyL0
ttyL1
#...

# Hayes ESP serial card
ttyP0
ttyP1
#...

# Computone IntelliPort II serial card
ttyF0
ttyF1
#...ttyF255

# Specialix IO8+ serial card
ttyW0
ttyW1
#...

# Comtrol VS-1000 serial controller
ttyV0
ttyV1
#...

# ISI serial card
ttyM0
ttyM1
#...

# Technology Concepts serial card
ttyT0
ttyT1
#...

# Specialix RIO serial card
ttySR0
ttySR1
#...ttySR511

# Chase Research AT/PCI-Fast serial card
ttyCH0
ttyCH1
#...ttyCH63

# Moxa Intellio serial card
ttyMX0
ttyMX1
#...ttyMX127

# SmartIO serial card
ttySI0
ttySI1
#...

# USB dongles
ttyUSB0
ttyUSB1
ttyUSB2
#...

# LinkUp Systems L72xx UARTs
ttyLU0
ttyLU1
ttyLU2
ttyLU3

# StrongARM builtin serial ports
ttySA0
ttySA1
ttySA2

# SCI serial port (SuperH) ports and SC26xx serial ports
ttySC0
ttySC1
ttySC2
ttySC3
ttySC4
ttySC5
ttySC6
ttySC7
ttySC8
ttySC9

# ARM "AMBA" serial ports
ttyAM0
ttyAM1
ttyAM2
ttyAM3
ttyAM4
ttyAM5
ttyAM6
ttyAM7
ttyAM8
ttyAM9
ttyAM10
ttyAM11
ttyAM12
ttyAM13
ttyAM14
ttyAM15

# Embedded ARM AMBA PL011 ports (e.g. emulated by QEMU)
ttyAMA0
ttyAMA1
ttyAMA2
ttyAMA3

# DataBooster serial ports
ttyDB0
ttyDB1
ttyDB2
ttyDB3
ttyDB4
ttyDB5
ttyDB6
ttyDB7

# SGI Altix console ports
ttySG0

# Motorola i.MX ports
ttySMX0
ttySMX1
ttySMX2

# Marvell MPSC ports
ttyMM0
ttyMM1

# PPC CPM (SCC or SMC) ports
ttyCPM0
ttyCPM1
ttyCPM2
ttyCPM3
ttyCPM4
ttyCPM5

# Altix serial cards
ttyIOC0
ttyIOC1
#...ttyIOC31

# NEC VR4100 series SIU
ttyVR0

# NEC VR4100 series SSIU
ttyVR1

# Altix ioc4 serial cards
ttyIOC84
ttyIOC85
#...ttyIOC115

# Altix ioc3 serial cards
ttySIOC0
ttySIOC1
#...ttySIOC31

# PPC PSC ports
ttyPSC0
ttyPSC1
ttyPSC2
ttyPSC3
ttyPSC4
ttyPSC5

# ATMEL serial ports
ttyAT0
ttyAT1
#...ttyAT15

# Hilscher netX serial port
ttyNX0
ttyNX1
#...ttyNX15

# Xilinx uartlite - port
ttyUL0
ttyUL1
ttyUL2
ttyUL3

# Xen virtual console - port 0
xvc0

# pmac_zilog - port
ttyPZ0
ttyPZ1
ttyPZ2
ttyPZ3

# TX39/49 serial port
ttyTX0
ttyTX1
ttyTX2
ttyTX3
ttyTX4
ttyTX5
ttyTX6
ttyTX7

# SC26xx serial ports (see SCI serial ports (SuperH))

# MAX3100 serial ports
ttyMAX0
ttyMAX1
ttyMAX2
ttyMAX3

# OMAP serial ports
ttyO0
ttyO1
ttyO2
ttyO3

# User space serial ports
ttyU0
ttyU1

# A2232 serial card
ttyY0
ttyY1

# IBM 3270 terminal Unix tty access
3270/tty1
3270/tty2
#...

# IBM iSeries/pSeries virtual console
hvc0
hvc1
#...
#IBM pSeries console ports
hvsi0
hvsi1
hvsi2

# Equinox SST multi-port serial boards
ttyEQ0
ttyEQ1
#...ttyEQ1027

# ==========================================================
#
# Not in Documentation/Devices.txt
#
# ==========================================================

# Embedded Freescale i.MX ports
ttymxc0
ttymxc1
ttymxc2
ttymxc3
ttymxc4
ttymxc5

# LXC (Linux Containers)
lxc/console
lxc/tty1
lxc/tty2
lxc/tty3
lxc/tty4

# Serial Console for MIPS Swarm
duart0
duart1

# s390 and s390x ports in LPAR mode
ttysclp0

# ODROID XU4 serial console
ttySAC0
ttySAC1
ttySAC2
ttySAC3


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.150] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 973c6b7b-b35b-4e7f-b248-163c40ac658b
Script Name: /etc/securetty

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "cat /etc/securetty"
# Проверяем, что файл пуст или не существует
# Если файл пуст или не существует - "Пройдена", иначе - "Не пройдена"

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Проверяем, содержит ли вывод сообщение об ошибке "файл не существует"
# Обычно это: "cat: /etc/securetty: No such file or directory" или подобное
if echo "$CHECK_OUTPUT" | grep -qiE "(no such file|not found|cannot access)"; then
    # Файл не существует - проверка пройдена
    echo "Пройдена"
    exit 0
fi

... (total 36 lines, 1092 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 4141 chars, 413 lines:
# /etc/securetty: list of terminals on which root is allowed to login.
# See securetty(5) and login(1).

console

# Local X displays (allows empty passwords with pam_unix's nullok_secure)
:0
:0.0
:0.1
:1
:1.0
:1.1
:2
:2.0
:2.1
:3
:3.0
:3.1
#...


# ==========================================================
#
# TTYs sorted by major number according to Documentation/devices.txt
#
# ==========================================================

# Virtual consoles
tty1
tty2
tty3
tty4
tty5
tty6
tty7
tty8
tty9
tty10
tty11
tty12
tty13
tty14
tty15
tty16
tty17
tty18
tty19
tty20
tty21
tty22
tty23
tty24
tty25
tty26
tty27
tty28
tty29
tty30
tty31
tty32
tty33
tty34
tty35
tty36
tty37
tty38
tty39
tty40
tty41
tty42
tty43
tty44
tty45
tty46
tty47
tty48
tty49
tty50
tty51
tty52
tty53
tty54
tty55
tty56
tty57
tty58
tty59
tty60
tty61
tty62
tty63

# UART serial ports
ttyS0
ttyS1
ttyS2
ttyS3
ttyS4
ttyS5
#...ttyS191

# Serial Mux devices	(Linux/PA-RISC only)
ttyB0
ttyB1
#...

# Chase serial card
ttyH0
ttyH1
#...

# Cyclades serial cards
ttyC0
ttyC1
#...ttyC31

# Digiboard serial cards
ttyD0
ttyD1
#...

# Stallion serial cards
ttyE0
ttyE1
#...ttyE255

# Specialix serial cards
ttyX0
ttyX1
#...

# Comtrol Rocketport serial cards
ttyR0
ttyR1
#...

# SDL RISCom serial cards
ttyL0
ttyL1
#...

# Hayes ESP serial card
ttyP0
ttyP1
#...

# Computone IntelliPort II serial card
ttyF0
ttyF1
#...ttyF255

# Specialix IO8+ serial card
ttyW0
ttyW1
#...

# Comtrol VS-1000 serial controller
ttyV0
ttyV1
#...

# ISI serial card
ttyM0
ttyM1
#...

# Technology Concepts serial card
ttyT0
ttyT1
#...

# Specialix RIO serial card
ttySR0
ttySR1
#...ttySR511

# Chase Research AT/PCI-Fast serial card
ttyCH0
ttyCH1
#...ttyCH63

# Moxa Intellio serial card
ttyMX0
ttyMX1
#...ttyMX127

# SmartIO serial card
ttySI0
ttySI1
#...

# USB dongles
ttyUSB0
ttyUSB1
ttyUSB2
#...

# LinkUp Systems L72xx UARTs
ttyLU0
ttyLU1
ttyLU2
ttyLU3

# StrongARM builtin serial ports
ttySA0
ttySA1
ttySA2

# SCI serial port (SuperH) ports and SC26xx serial ports
ttySC0
ttySC1
ttySC2
ttySC3
ttySC4
ttySC5
ttySC6
ttySC7
ttySC8
ttySC9

# ARM "AMBA" serial ports
ttyAM0
ttyAM1
ttyAM2
ttyAM3
ttyAM4
ttyAM5
ttyAM6
ttyAM7
ttyAM8
ttyAM9
ttyAM10
ttyAM11
ttyAM12
ttyAM13
ttyAM14
ttyAM15

# Embedded ARM AMBA PL011 ports (e.g. emulated by QEMU)
ttyAMA0
ttyAMA1
ttyAMA2
ttyAMA3

# DataBooster serial ports
ttyDB0
ttyDB1
ttyDB2
ttyDB3
ttyDB4
ttyDB5
ttyDB6
ttyDB7

# SGI Altix console ports
ttySG0

# Motorola i.MX ports
ttySMX0
ttySMX1
ttySMX2

# Marvell MPSC ports
ttyMM0
ttyMM1

# PPC CPM (SCC or SMC) ports
ttyCPM0
ttyCPM1
ttyCPM2
ttyCPM3
ttyCPM4
ttyCPM5

# Altix serial cards
ttyIOC0
ttyIOC1
#...ttyIOC31

# NEC VR4100 series SIU
ttyVR0

# NEC VR4100 series SSIU
ttyVR1

# Altix ioc4 serial cards
ttyIOC84
ttyIOC85
#...ttyIOC115

# Altix ioc3 serial cards
ttySIOC0
ttySIOC1
#...ttySIOC31

# PPC PSC ports
ttyPSC0
ttyPSC1
ttyPSC2
ttyPSC3
ttyPSC4
ttyPSC5

# ATMEL serial ports
ttyAT0
ttyAT1
#...ttyAT15

# Hilscher netX serial port
ttyNX0
ttyNX1
#...ttyNX15

# Xilinx uartlite - port
ttyUL0
ttyUL1
ttyUL2
ttyUL3

# Xen virtual console - port 0
xvc0

# pmac_zilog - port
ttyPZ0
ttyPZ1
ttyPZ2
ttyPZ3

# TX39/49 serial port
ttyTX0
ttyTX1
ttyTX2
ttyTX3
ttyTX4
ttyTX5
ttyTX6
ttyTX7

# SC26xx serial ports (see SCI serial ports (SuperH))

# MAX3100 serial ports
ttyMAX0
ttyMAX1
ttyMAX2
ttyMAX3

# OMAP serial ports
ttyO0
ttyO1
ttyO2
ttyO3

# User space serial ports
ttyU0
ttyU1

# A2232 serial card
ttyY0
ttyY1

# IBM 3270 terminal Unix tty access
3270/tty1
3270/tty2
#...

# IBM iSeries/pSeries virtual console
hvc0
hvc1
#...
#IBM pSeries console ports
hvsi0
hvsi1
hvsi2

# Equinox SST multi-port serial boards
ttyEQ0
ttyEQ1
#...ttyEQ1027

# ==========================================================
#
# Not in Documentation/Devices.txt
#
# ==========================================================

# Embedded Freescale i.MX ports
ttymxc0
ttymxc1
ttymxc2
ttymxc3
ttymxc4
ttymxc5

# LXC (Linux Containers)
lxc/console
lxc/tty1
lxc/tty2
lxc/tty3
lxc/tty4

# Serial Console for MIPS Swarm
duart0
duart1

# s390 and s390x ports in LPAR mode
ttysclp0

# ODROID XU4 serial console
ttySAC0
ttySAC1
ttySAC2
ttySAC3


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (40 chars):
Файл /etc/securetty не пуст
Не пройдена


>>> STDERR (19583 chars):
+ set -eo pipefail
+ '[' -z '# /etc/securetty: list of terminals on which root is allowed to login.
# See securetty(5) and login(1).

console

# Local X displays (allows empty passwords with pam_unix'\''s nullok_secure)
:0
:0.0
:0.1
:1
:1.0
:1.1
:2
:2.0
:2.1
:3
:3.0
:3.1
#...


# ==========================================================
#
# TTYs sorted by major number according to Documentation/devices.txt
#
# ==========================================================

# Virtual consoles
tty1
tty2
tty3
tty4
tty5
tty6
tty7
tty8
tty9
tty10
tty11
tty12
tty13
tty14
tty15
tty16
tty17
tty18
tty19
tty20
tty21
tty22
tty23
tty24
tty25
tty26
tty27
tty28
tty29
tty30
tty31
tty32
tty33
tty34
tty35
tty36
tty37
tty38
tty39
tty40
tty41
tty42
tty43
tty44
tty45
tty46
tty47
tty48
tty49
tty50
tty51
tty52
tty53
tty54
tty55
tty56
tty57
tty58
tty59
tty60
tty61
tty62
tty63

# UART serial ports
ttyS0
ttyS1
ttyS2
ttyS3
ttyS4
ttyS5
#...ttyS191

# Serial Mux devices	(Linux/PA-RISC only)
ttyB0
ttyB1
#...

# Chase serial card
ttyH0
ttyH1
#...

# Cyclades serial cards
ttyC0
ttyC1
#...ttyC31

# Digiboard serial cards
ttyD0
ttyD1
#...

# Stallion serial cards
ttyE0
ttyE1
#...ttyE255

# Specialix serial cards
ttyX0
ttyX1
#...

# Comtrol Rocketport serial cards
ttyR0
ttyR1
#...

# SDL RISCom serial cards
ttyL0
ttyL1
#...

# Hayes ESP serial card
ttyP0
ttyP1
#...

# Computone IntelliPort II serial card
ttyF0
ttyF1
#...ttyF255

# Specialix IO8+ serial card
ttyW0
ttyW1
#...

# Comtrol VS-1000 serial controller
ttyV0
ttyV1
#...

# ISI serial card
ttyM0
ttyM1
#...

# Technology Concepts serial card
ttyT0
ttyT1
#...

# Specialix RIO serial card
ttySR0
ttySR1
#...ttySR511

# Chase Research AT/PCI-Fast serial card
ttyCH0
ttyCH1
#...ttyCH63

# Moxa Intellio serial card
ttyMX0
ttyMX1
#...ttyMX127

# SmartIO serial card
ttySI0
ttySI1
#...

# USB dongles
ttyUSB0
ttyUSB1
ttyUSB2
#...

# LinkUp Systems L72xx UARTs
ttyLU0
ttyLU1
ttyLU2
ttyLU3

# StrongARM builtin serial ports
ttySA0
ttySA1
ttySA2

# SCI serial port (SuperH) ports and SC26xx serial ports
ttySC0
ttySC1
ttySC2
ttySC3
ttySC4
ttySC5
ttySC6
ttySC7
ttySC8
ttySC9

# ARM "AMBA" serial ports
ttyAM0
ttyAM1
ttyAM2
ttyAM3
ttyAM4
ttyAM5
ttyAM6
ttyAM7
ttyAM8
ttyAM9
ttyAM10
ttyAM11
ttyAM12
ttyAM13
ttyAM14
ttyAM15

# Embedded ARM AMBA PL011 ports (e.g. emulated by QEMU)
ttyAMA0
ttyAMA1
ttyAMA2
ttyAMA3

# DataBooster serial ports
ttyDB0
ttyDB1
ttyDB2
ttyDB3
ttyDB4
ttyDB5
ttyDB6
ttyDB7

# SGI Altix console ports
ttySG0

# Motorola i.MX ports
ttySMX0
ttySMX1
ttySMX2

# Marvell MPSC ports
ttyMM0
ttyMM1

# PPC CPM (SCC or SMC) ports
ttyCPM0
ttyCPM1
ttyCPM2
ttyCPM3
ttyCPM4
ttyCPM5

# Altix serial cards
ttyIOC0
ttyIOC1
#...ttyIOC31

# NEC VR4100 series SIU
ttyVR0

# NEC VR4100 series SSIU
ttyVR1

# Altix ioc4 serial cards
ttyIOC84
ttyIOC85
#...ttyIOC115

# Altix ioc3 serial cards
ttySIOC0
ttySIOC1
#...ttySIOC31

# PPC PSC ports
ttyPSC0
ttyPSC1
ttyPSC2
ttyPSC3
ttyPSC4
ttyPSC5

# ATMEL serial ports
ttyAT0
ttyAT1
#...ttyAT15

# Hilscher netX serial port
ttyNX0
ttyNX1
#...ttyNX15

# Xilinx uartlite - port
ttyUL0
ttyUL1
ttyUL2
ttyUL3

# Xen virtual console - port 0
xvc0

# pmac_zilog - port
ttyPZ0
ttyPZ1
ttyPZ2
ttyPZ3

# TX39/49 serial port
ttyTX0
ttyTX1
ttyTX2
ttyTX3
ttyTX4
ttyTX5
ttyTX6
ttyTX7

# SC26xx serial ports (see SCI serial ports (SuperH))

# MAX3100 serial ports
ttyMAX0
ttyMAX1
ttyMAX2
ttyMAX3

# OMAP serial ports
ttyO0
ttyO1
ttyO2
ttyO3

# User space serial ports
ttyU0
ttyU1

# A2232 serial card
ttyY0
ttyY1

# IBM 3270 terminal Unix tty access
3270/tty1
3270/tty2
#...

# IBM iSeries/pSeries virtual console
hvc0
hvc1
#...
#IBM pSeries console ports
hvsi0
hvsi1
hvsi2

# Equinox SST multi-port serial boards
ttyEQ0
ttyEQ1
#...ttyEQ1027

# ==========================================================
#
# Not in Documentation/Devices.txt
#
# ==========================================================

# Embedded Freescale i.MX ports
ttymxc0
ttymxc1
ttymxc2
ttymxc3
ttymxc4
ttymxc5

# LXC (Linux Containers)
lxc/console
lxc/tty1
lxc/tty2
lxc/tty3
lxc/tty4

# Serial Console for MIPS Swarm
duart0
duart1

# s390 and s390x ports in LPAR mode
ttysclp0

# ODROID XU4 serial console
ttySAC0
ttySAC1
ttySAC2
ttySAC3
' ']'
+ grep -qiE '(no such file|not found|cannot access)'
+ echo '# /etc/securetty: list of terminals on which root is allowed to login.
# See securetty(5) and login(1).

console

# Local X displays (allows empty passwords with pam_unix'\''s nullok_secure)
:0
:0.0
:0.1
:1
:1.0
:1.1
:2
:2.0
:2.1
:3
:3.0
:3.1
#...


# ==========================================================
#
# TTYs sorted by major number according to Documentation/devices.txt
#
# ==========================================================

# Virtual consoles
tty1
tty2
tty3
tty4
tty5
tty6
tty7
tty8
tty9
tty10
tty11
tty12
tty13
tty14
tty15
tty16
tty17
tty18
tty19
tty20
tty21
tty22
tty23
tty24
tty25
tty26
tty27
tty28
tty29
tty30
tty31
tty32
tty33
tty34
tty35
tty36
tty37
tty38
tty39
tty40
tty41
tty42
tty43
tty44
tty45
tty46
tty47
tty48
tty49
tty50
tty51
tty52
tty53
tty54
tty55
tty56
tty57
tty58
tty59
tty60
tty61
tty62
tty63

# UART serial ports
ttyS0
ttyS1
ttyS2
ttyS3
ttyS4
ttyS5
#...ttyS191

# Serial Mux devices	(Linux/PA-RISC only)
ttyB0
ttyB1
#...

# Chase serial card
ttyH0
ttyH1
#...

# Cyclades serial cards
ttyC0
ttyC1
#...ttyC31

# Digiboard serial cards
ttyD0
ttyD1
#...

# Stallion serial cards
ttyE0
ttyE1
#...ttyE255

# Specialix serial cards
ttyX0
ttyX1
#...

# Comtrol Rocketport serial cards
ttyR0
ttyR1
#...

# SDL RISCom serial cards
ttyL0
ttyL1
#...

# Hayes ESP serial card
ttyP0
ttyP1
#...

# Computone IntelliPort II serial card
ttyF0
ttyF1
#...ttyF255

# Specialix IO8+ serial card
ttyW0
ttyW1
#...

# Comtrol VS-1000 serial controller
ttyV0
ttyV1
#...

# ISI serial card
ttyM0
ttyM1
#...

# Technology Concepts serial card
ttyT0
ttyT1
#...

# Specialix RIO serial card
ttySR0
ttySR1
#...ttySR511

# Chase Research AT/PCI-Fast serial card
ttyCH0
ttyCH1
#...ttyCH63

# Moxa Intellio serial card
ttyMX0
ttyMX1
#...ttyMX127

# SmartIO serial card
ttySI0
ttySI1
#...

# USB dongles
ttyUSB0
ttyUSB1
ttyUSB2
#...

# LinkUp Systems L72xx UARTs
ttyLU0
ttyLU1
ttyLU2
ttyLU3

# StrongARM builtin serial ports
ttySA0
ttySA1
ttySA2

# SCI serial port (SuperH) ports and SC26xx serial ports
ttySC0
ttySC1
ttySC2
ttySC3
ttySC4
ttySC5
ttySC6
ttySC7
ttySC8
ttySC9

# ARM "AMBA" serial ports
ttyAM0
ttyAM1
ttyAM2
ttyAM3
ttyAM4
ttyAM5
ttyAM6
ttyAM7
ttyAM8
ttyAM9
ttyAM10
ttyAM11
ttyAM12
ttyAM13
ttyAM14
ttyAM15

# Embedded ARM AMBA PL011 ports (e.g. emulated by QEMU)
ttyAMA0
ttyAMA1
ttyAMA2
ttyAMA3

# DataBooster serial ports
ttyDB0
ttyDB1
ttyDB2
ttyDB3
ttyDB4
ttyDB5
ttyDB6
ttyDB7

# SGI Altix console ports
ttySG0

# Motorola i.MX ports
ttySMX0
ttySMX1
ttySMX2

# Marvell MPSC ports
ttyMM0
ttyMM1

# PPC CPM (SCC or SMC) ports
ttyCPM0
ttyCPM1
ttyCPM2
ttyCPM3
ttyCPM4
ttyCPM5

# Altix serial cards
ttyIOC0
ttyIOC1
#...ttyIOC31

# NEC VR4100 series SIU
ttyVR0

# NEC VR4100 series SSIU
ttyVR1

# Altix ioc4 serial cards
ttyIOC84
ttyIOC85
#...ttyIOC115

# Altix ioc3 serial cards
ttySIOC0
ttySIOC1
#...ttySIOC31

# PPC PSC ports
ttyPSC0
ttyPSC1
ttyPSC2
ttyPSC3
ttyPSC4
ttyPSC5

# ATMEL serial ports
ttyAT0
ttyAT1
#...ttyAT15

# Hilscher netX serial port
ttyNX0
ttyNX1
#...ttyNX15

# Xilinx uartlite - port
ttyUL0
ttyUL1
ttyUL2
ttyUL3

# Xen virtual console - port 0
xvc0

# pmac_zilog - port
ttyPZ0
ttyPZ1
ttyPZ2
ttyPZ3

# TX39/49 serial port
ttyTX0
ttyTX1
ttyTX2
ttyTX3
ttyTX4
ttyTX5
ttyTX6
ttyTX7

# SC26xx serial ports (see SCI serial ports (SuperH))

# MAX3100 serial ports
ttyMAX0
ttyMAX1
ttyMAX2
ttyMAX3

# OMAP serial ports
ttyO0
ttyO1
ttyO2
ttyO3

# User space serial ports
ttyU0
ttyU1

# A2232 serial card
ttyY0
ttyY1

# IBM 3270 terminal Unix tty access
3270/tty1
3270/tty2
#...

# IBM iSeries/pSeries virtual console
hvc0
hvc1
#...
#IBM pSeries console ports
hvsi0
hvsi1
hvsi2

# Equinox SST multi-port serial boards
ttyEQ0
ttyEQ1
#...ttyEQ1027

# ==========================================================
#
# Not in Documentation/Devices.txt
#
# ==========================================================

# Embedded Freescale i.MX ports
ttymxc0
ttymxc1
ttymxc2
ttymxc3
ttymxc4
ttymxc5

# LXC (Linux Containers)
lxc/console
lxc/tty1
lxc/tty2
lxc/tty3
lxc/tty4

# Serial Console for MIPS Swarm
duart0
duart1

# s390 and s390x ports in LPAR mode
ttysclp0

# ODROID XU4 serial console
ttySAC0
ttySAC1
ttySAC2
ttySAC3
'
++ echo '# /etc/securetty: list of terminals on which root is allowed to login.
# See securetty(5) and login(1).

console

# Local X displays (allows empty passwords with pam_unix'\''s nullok_secure)
:0
:0.0
:0.1
:1
:1.0
:1.1
:2
:2.0
:2.1
:3
:3.0
:3.1
#...


# ==========================================================
#
# TTYs sorted by major number according to Documentation/devices.txt
#
# ==========================================================

# Virtual consoles
tty1
tty2
tty3
tty4
tty5
tty6
tty7
tty8
tty9
tty10
tty11
tty12
tty13
tty14
tty15
tty16
tty17
tty18
tty19
tty20
tty21
tty22
tty23
tty24
tty25
tty26
tty27
tty28
tty29
tty30
tty31
tty32
tty33
tty34
tty35
tty36
tty37
tty38
tty39
tty40
tty41
tty42
tty43
tty44
tty45
tty46
tty47
tty48
tty49
tty50
tty51
tty52
tty53
tty54
tty55
tty56
tty57
tty58
tty59
tty60
tty61
tty62
tty63

# UART serial ports
ttyS0
ttyS1
ttyS2
ttyS3
ttyS4
ttyS5
#...ttyS191

# Serial Mux devices	(Linux/PA-RISC only)
ttyB0
ttyB1
#...

# Chase serial card
ttyH0
ttyH1
#...

# Cyclades serial cards
ttyC0
ttyC1
#...ttyC31

# Digiboard serial cards
ttyD0
ttyD1
#...

# Stallion serial cards
ttyE0
ttyE1
#...ttyE255

# Specialix serial cards
ttyX0
ttyX1
#...

# Comtrol Rocketport serial cards
ttyR0
ttyR1
#...

# SDL RISCom serial cards
ttyL0
ttyL1
#...

# Hayes ESP serial card
ttyP0
ttyP1
#...

# Computone IntelliPort II serial card
ttyF0
ttyF1
#...ttyF255

# Specialix IO8+ serial card
ttyW0
ttyW1
#...

# Comtrol VS-1000 serial controller
ttyV0
ttyV1
#...

# ISI serial card
ttyM0
ttyM1
#...

# Technology Concepts serial card
ttyT0
ttyT1
#...

# Specialix RIO serial card
ttySR0
ttySR1
#...ttySR511

# Chase Research AT/PCI-Fast serial card
ttyCH0
ttyCH1
#...ttyCH63

# Moxa Intellio serial card
ttyMX0
ttyMX1
#...ttyMX127

# SmartIO serial card
ttySI0
ttySI1
#...

# USB dongles
ttyUSB0
ttyUSB1
ttyUSB2
#...

# LinkUp Systems L72xx UARTs
ttyLU0
ttyLU1
ttyLU2
ttyLU3

# StrongARM builtin serial ports
ttySA0
ttySA1
ttySA2

# SCI serial port (SuperH) ports and SC26xx serial ports
ttySC0
ttySC1
ttySC2
ttySC3
ttySC4
ttySC5
ttySC6
ttySC7
ttySC8
ttySC9

# ARM "AMBA" serial ports
ttyAM0
ttyAM1
ttyAM2
ttyAM3
ttyAM4
ttyAM5
ttyAM6
ttyAM7
ttyAM8
ttyAM9
ttyAM10
ttyAM11
ttyAM12
ttyAM13
ttyAM14
ttyAM15

# Embedded ARM AMBA PL011 ports (e.g. emulated by QEMU)
ttyAMA0
ttyAMA1
ttyAMA2
ttyAMA3

# DataBooster serial ports
ttyDB0
ttyDB1
ttyDB2
ttyDB3
ttyDB4
ttyDB5
ttyDB6
ttyDB7

# SGI Altix console ports
ttySG0

# Motorola i.MX ports
ttySMX0
ttySMX1
ttySMX2

# Marvell MPSC ports
ttyMM0
ttyMM1

# PPC CPM (SCC or SMC) ports
ttyCPM0
ttyCPM1
ttyCPM2
ttyCPM3
ttyCPM4
ttyCPM5

# Altix serial cards
ttyIOC0
ttyIOC1
#...ttyIOC31

# NEC VR4100 series SIU
ttyVR0

# NEC VR4100 series SSIU
ttyVR1

# Altix ioc4 serial cards
ttyIOC84
ttyIOC85
#...ttyIOC115

# Altix ioc3 serial cards
ttySIOC0
ttySIOC1
#...ttySIOC31

# PPC PSC ports
ttyPSC0
ttyPSC1
ttyPSC2
ttyPSC3
ttyPSC4
ttyPSC5

# ATMEL serial ports
ttyAT0
ttyAT1
#...ttyAT15

# Hilscher netX serial port
ttyNX0
ttyNX1
#...ttyNX15

# Xilinx uartlite - port
ttyUL0
ttyUL1
ttyUL2
ttyUL3

# Xen virtual console - port 0
xvc0

# pmac_zilog - port
ttyPZ0
ttyPZ1
ttyPZ2
ttyPZ3

# TX39/49 serial port
ttyTX0
ttyTX1
ttyTX2
ttyTX3
ttyTX4
ttyTX5
ttyTX6
ttyTX7

# SC26xx serial ports (see SCI serial ports (SuperH))

# MAX3100 serial ports
ttyMAX0
ttyMAX1
ttyMAX2
ttyMAX3

# OMAP serial ports
ttyO0
ttyO1
ttyO2
ttyO3

# User space serial ports
ttyU0
ttyU1

# A2232 serial card
ttyY0
ttyY1

# IBM 3270 terminal Unix tty access
3270/tty1
3270/tty2
#...

# IBM iSeries/pSeries virtual console
hvc0
hvc1
#...
#IBM pSeries console ports
hvsi0
hvsi1
hvsi2

# Equinox SST multi-port serial boards
ttyEQ0
ttyEQ1
#...ttyEQ1027

# ==========================================================
#
# Not in Documentation/Devices.txt
#
# ==========================================================

# Embedded Freescale i.MX ports
ttymxc0
ttymxc1
ttymxc2
ttymxc3
ttymxc4
ttymxc5

# LXC (Linux Containers)
lxc/console
lxc/tty1
lxc/tty2
lxc/tty3
lxc/tty4

# Serial Console for MIPS Swarm
duart0
duart1

# s390 and s390x ports in LPAR mode
ttysclp0

# ODROID XU4 serial console
ttySAC0
ttySAC1
ttySAC2
ttySAC3
'
++ tr -d '[:space:]'
+ trimmed_output='#/etc/securetty:listofterminalsonwhichrootisallowedtologin.#Seesecuretty(5)andlogin(1).console#LocalXdisplays(allowsemptypasswordswithpam_unix'\''snullok_secure):0:0.0:0.1:1:1.0:1.1:2:2.0:2.1:3:3.0:3.1#...#==========================================================##TTYssortedbymajornumberaccordingtoDocumentation/devices.txt##==========================================================#Virtualconsolestty1tty2tty3tty4tty5tty6tty7tty8tty9tty10tty11tty12tty13tty14tty15tty16tty17tty18tty19tty20tty21tty22tty23tty24tty25tty26tty27tty28tty29tty30tty31tty32tty33tty34tty35tty36tty37tty38tty39tty40tty41tty42tty43tty44tty45tty46tty47tty48tty49tty50tty51tty52tty53tty54tty55tty56tty57tty58tty59tty60tty61tty62tty63#UARTserialportsttyS0ttyS1ttyS2ttyS3ttyS4ttyS5#...ttyS191#SerialMuxdevices(Linux/PA-RISConly)ttyB0ttyB1#...#ChaseserialcardttyH0ttyH1#...#CycladesserialcardsttyC0ttyC1#...ttyC31#DigiboardserialcardsttyD0ttyD1#...#StallionserialcardsttyE0ttyE1#...ttyE255#SpecialixserialcardsttyX0ttyX1#...#ComtrolRocketportserialcardsttyR0ttyR1#...#SDLRISComserialcardsttyL0ttyL1#...#HayesESPserialcardttyP0ttyP1#...#ComputoneIntelliPortIIserialcardttyF0ttyF1#...ttyF255#SpecialixIO8+serialcardttyW0ttyW1#...#ComtrolVS-1000serialcontrollerttyV0ttyV1#...#ISIserialcardttyM0ttyM1#...#TechnologyConceptsserialcardttyT0ttyT1#...#SpecialixRIOserialcardttySR0ttySR1#...ttySR511#ChaseResearchAT/PCI-FastserialcardttyCH0ttyCH1#...ttyCH63#MoxaIntellioserialcardttyMX0ttyMX1#...ttyMX127#SmartIOserialcardttySI0ttySI1#...#USBdonglesttyUSB0ttyUSB1ttyUSB2#...#LinkUpSystemsL72xxUARTsttyLU0ttyLU1ttyLU2ttyLU3#StrongARMbuiltinserialportsttySA0ttySA1ttySA2#SCIserialport(SuperH)portsandSC26xxserialportsttySC0ttySC1ttySC2ttySC3ttySC4ttySC5ttySC6ttySC7ttySC8ttySC9#ARM"AMBA"serialportsttyAM0ttyAM1ttyAM2ttyAM3ttyAM4ttyAM5ttyAM6ttyAM7ttyAM8ttyAM9ttyAM10ttyAM11ttyAM12ttyAM13ttyAM14ttyAM15#EmbeddedARMAMBAPL011ports(e.g.emulatedbyQEMU)ttyAMA0ttyAMA1ttyAMA2ttyAMA3#DataBoosterserialportsttyDB0ttyDB1ttyDB2ttyDB3ttyDB4ttyDB5ttyDB6ttyDB7#SGIAltixconsoleportsttySG0#Motorolai.MXportsttySMX0ttySMX1ttySMX2#MarvellMPSCportsttyMM0ttyMM1#PPCCPM(SCCorSMC)portsttyCPM0ttyCPM1ttyCPM2ttyCPM3ttyCPM4ttyCPM5#AltixserialcardsttyIOC0ttyIOC1#...ttyIOC31#NECVR4100seriesSIUttyVR0#NECVR4100seriesSSIUttyVR1#Altixioc4serialcardsttyIOC84ttyIOC85#...ttyIOC115#Altixioc3serialcardsttySIOC0ttySIOC1#...ttySIOC31#PPCPSCportsttyPSC0ttyPSC1ttyPSC2ttyPSC3ttyPSC4ttyPSC5#ATMELserialportsttyAT0ttyAT1#...ttyAT15#HilschernetXserialportttyNX0ttyNX1#...ttyNX15#Xilinxuartlite-portttyUL0ttyUL1ttyUL2ttyUL3#Xenvirtualconsole-port0xvc0#pmac_zilog-portttyPZ0ttyPZ1ttyPZ2ttyPZ3#TX39/49serialportttyTX0ttyTX1ttyTX2ttyTX3ttyTX4ttyTX5ttyTX6ttyTX7#SC26xxserialports(seeSCIserialports(SuperH))#MAX3100serialportsttyMAX0ttyMAX1ttyMAX2ttyMAX3#OMAPserialportsttyO0ttyO1ttyO2ttyO3#UserspaceserialportsttyU0ttyU1#A2232serialcardttyY0ttyY1#IBM3270terminalUnixttyaccess3270/tty13270/tty2#...#IBMiSeries/pSeriesvirtualconsolehvc0hvc1#...#IBMpSeriesconsoleportshvsi0hvsi1hvsi2#EquinoxSSTmulti-portserialboardsttyEQ0ttyEQ1#...ttyEQ1027#==========================================================##NotinDocumentation/Devices.txt##==========================================================#EmbeddedFreescalei.MXportsttymxc0ttymxc1ttymxc2ttymxc3ttymxc4ttymxc5#LXC(LinuxContainers)lxc/consolelxc/tty1lxc/tty2lxc/tty3lxc/tty4#SerialConsoleforMIPSSwarmduart0duart1#s390ands390xportsinLPARmodettysclp0#ODROIDXU4serialconsolettySAC0ttySAC1ttySAC2ttySAC3'
+ [[ -z #/etc/securetty:listofterminalsonwhichrootisallowedtologin.#Seesecuretty(5)andlogin(1).console#LocalXdisplays(allowsemptypasswordswithpam_unix'snullok_secure):0:0.0:0.1:1:1.0:1.1:2:2.0:2.1:3:3.0:3.1#...#==========================================================##TTYssortedbymajornumberaccordingtoDocumentation/devices.txt##==========================================================#Virtualconsolestty1tty2tty3tty4tty5tty6tty7tty8tty9tty10tty11tty12tty13tty14tty15tty16tty17tty18tty19tty20tty21tty22tty23tty24tty25tty26tty27tty28tty29tty30tty31tty32tty33tty34tty35tty36tty37tty38tty39tty40tty41tty42tty43tty44tty45tty46tty47tty48tty49tty50tty51tty52tty53tty54tty55tty56tty57tty58tty59tty60tty61tty62tty63#UARTserialportsttyS0ttyS1ttyS2ttyS3ttyS4ttyS5#...ttyS191#SerialMuxdevices(Linux/PA-RISConly)ttyB0ttyB1#...#ChaseserialcardttyH0ttyH1#...#CycladesserialcardsttyC0ttyC1#...ttyC31#DigiboardserialcardsttyD0ttyD1#...#StallionserialcardsttyE0ttyE1#...ttyE255#SpecialixserialcardsttyX0ttyX1#...#ComtrolRocketportserialcardsttyR0ttyR1#...#SDLRISComserialcardsttyL0ttyL1#...#HayesESPserialcardttyP0ttyP1#...#ComputoneIntelliPortIIserialcardttyF0ttyF1#...ttyF255#SpecialixIO8+serialcardttyW0ttyW1#...#ComtrolVS-1000serialcontrollerttyV0ttyV1#...#ISIserialcardttyM0ttyM1#...#TechnologyConceptsserialcardttyT0ttyT1#...#SpecialixRIOserialcardttySR0ttySR1#...ttySR511#ChaseResearchAT/PCI-FastserialcardttyCH0ttyCH1#...ttyCH63#MoxaIntellioserialcardttyMX0ttyMX1#...ttyMX127#SmartIOserialcardttySI0ttySI1#...#USBdonglesttyUSB0ttyUSB1ttyUSB2#...#LinkUpSystemsL72xxUARTsttyLU0ttyLU1ttyLU2ttyLU3#StrongARMbuiltinserialportsttySA0ttySA1ttySA2#SCIserialport(SuperH)portsandSC26xxserialportsttySC0ttySC1ttySC2ttySC3ttySC4ttySC5ttySC6ttySC7ttySC8ttySC9#ARM"AMBA"serialportsttyAM0ttyAM1ttyAM2ttyAM3ttyAM4ttyAM5ttyAM6ttyAM7ttyAM8ttyAM9ttyAM10ttyAM11ttyAM12ttyAM13ttyAM14ttyAM15#EmbeddedARMAMBAPL011ports(e.g.emulatedbyQEMU)ttyAMA0ttyAMA1ttyAMA2ttyAMA3#DataBoosterserialportsttyDB0ttyDB1ttyDB2ttyDB3ttyDB4ttyDB5ttyDB6ttyDB7#SGIAltixconsoleportsttySG0#Motorolai.MXportsttySMX0ttySMX1ttySMX2#MarvellMPSCportsttyMM0ttyMM1#PPCCPM(SCCorSMC)portsttyCPM0ttyCPM1ttyCPM2ttyCPM3ttyCPM4ttyCPM5#AltixserialcardsttyIOC0ttyIOC1#...ttyIOC31#NECVR4100seriesSIUttyVR0#NECVR4100seriesSSIUttyVR1#Altixioc4serialcardsttyIOC84ttyIOC85#...ttyIOC115#Altixioc3serialcardsttySIOC0ttySIOC1#...ttySIOC31#PPCPSCportsttyPSC0ttyPSC1ttyPSC2ttyPSC3ttyPSC4ttyPSC5#ATMELserialportsttyAT0ttyAT1#...ttyAT15#HilschernetXserialportttyNX0ttyNX1#...ttyNX15#Xilinxuartlite-portttyUL0ttyUL1ttyUL2ttyUL3#Xenvirtualconsole-port0xvc0#pmac_zilog-portttyPZ0ttyPZ1ttyPZ2ttyPZ3#TX39/49serialportttyTX0ttyTX1ttyTX2ttyTX3ttyTX4ttyTX5ttyTX6ttyTX7#SC26xxserialports(seeSCIserialports(SuperH))#MAX3100serialportsttyMAX0ttyMAX1ttyMAX2ttyMAX3#OMAPserialportsttyO0ttyO1ttyO2ttyO3#UserspaceserialportsttyU0ttyU1#A2232serialcardttyY0ttyY1#IBM3270terminalUnixttyaccess3270/tty13270/tty2#...#IBMiSeries/pSeriesvirtualconsolehvc0hvc1#...#IBMpSeriesconsoleportshvsi0hvsi1hvsi2#EquinoxSSTmulti-portserialboardsttyEQ0ttyEQ1#...ttyEQ1027#==========================================================##NotinDocumentation/Devices.txt##==========================================================#EmbeddedFreescalei.MXportsttymxc0ttymxc1ttymxc2ttymxc3ttymxc4ttymxc5#LXC(LinuxContainers)lxc/consolelxc/tty1lxc/tty2lxc/tty3lxc/tty4#SerialConsoleforMIPSSwarmduart0duart1#s390ands390xportsinLPARmodettysclp0#ODROIDXU4serialconsolettySAC0ttySAC1ttySAC2ttySAC3 ]]
+ echo 'Файл /etc/securetty не пуст'
+ echo 'Не пройдена'
+ exit 44

================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.286] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo netstat -n

>>> EXIT CODE: 0

>>> STDOUT:
Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 192.168.56.102:22       192.168.56.106:9474     ESTABLISHED
tcp        0    112 192.168.56.102:22       192.168.56.106:23133    ESTABLISHED
tcp        0      0 192.168.56.102:22       192.168.56.106:8354     ESTABLISHED
udp        0      0 127.0.0.1:50178         127.0.0.1:50178         ESTABLISHED
Active UNIX domain sockets (w/o servers)
Proto RefCnt Flags       Type       State         I-Node   Path
unix  3      [ ]         DGRAM      CONNECTED     16281    /run/systemd/notify
unix  2      [ ]         DGRAM                    16282    /run/systemd/cgroups-agent
unix  2      [ ]         DGRAM                    137042   /run/user/1000/systemd/notify
unix  2      [ ]         DGRAM                    133349   /run/user/108/systemd/notify
unix  23     [ ]         DGRAM      CONNECTED     16302    /run/systemd/journal/dev-log
unix  2      [ ]         DGRAM                    16303    /run/systemd/journal/syslog
unix  7      [ ]         DGRAM      CONNECTED     16305    /run/systemd/journal/socket
unix  2      [ ]         DGRAM      CONNECTED     78953    /var/lib/samba/private/msg.sock/16440
unix  2      [ ]         DGRAM      CONNECTED     78467    /var/lib/samba/private/msg.sock/16454
unix  2      [ ]         DGRAM      CONNECTED     76677    /var/lib/samba/private/msg.sock/16455
unix  2      [ ]         DGRAM                    78469    /var/lib/samba/private/msg.sock/16456
unix  2      [ ]         DGRAM      CONNECTED     78596    /var/lib/samba/private/msg.sock/16506
unix  2      [ ]         DGRAM      CONNECTED     15100    
unix  3      [ ]         STREAM     CONNECTED     139698   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138869   
unix  2      [ ]         DGRAM      CONNECTED     20591    
unix  3      [ ]         STREAM     CONNECTED     15260    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139818   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     133492   
unix  3      [ ]         STREAM     CONNECTED     138185   
unix  3      [ ]         STREAM     CONNECTED     18974    
unix  3      [ ]         STREAM     CONNECTED     139715   
unix  3      [ ]         STREAM     CONNECTED     132668   
unix  3      [ ]         STREAM     CONNECTED     131833   
unix  3      [ ]         STREAM     CONNECTED     138219   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139043   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138170   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139835   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     22075    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139791   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     22083    
unix  3      [ ]         STREAM     CONNECTED     138886   /tmp/dbus-COEPxU4mVs
unix  2      [ ]         DGRAM      CONNECTED     183640   
unix  3      [ ]         STREAM     CONNECTED     137146   
unix  3      [ ]         STREAM     CONNECTED     22424    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     137132   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139041   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138032   
unix  3      [ ]         STREAM     CONNECTED     78969    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     22780    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138870   
unix  3      [ ]         DGRAM      CONNECTED     133350   
unix  3      [ ]         STREAM     CONNECTED     137129   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138015   @/tmp/.X11-unix/X0
unix  3      [ ]         DGRAM      CONNECTED     16283    
unix  2      [ ]         DGRAM      CONNECTED     138739   
unix  3      [ ]         STREAM     CONNECTED     139025   
unix  3      [ ]         STREAM     CONNECTED     139848   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     15334    
unix  3      [ ]         STREAM     CONNECTED     138223   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     132669   
unix  3      [ ]         STREAM     CONNECTED     76198    
unix  2      [ ]         DGRAM      CONNECTED     140296   
unix  3      [ ]         STREAM     CONNECTED     138086   
unix  3      [ ]         STREAM     CONNECTED     139738   /tmp/dbus-COEPxU4mVs
unix  2      [ ]         DGRAM      CONNECTED     24885    
unix  3      [ ]         STREAM     CONNECTED     137134   
unix  3      [ ]         DGRAM      CONNECTED     137044   
unix  3      [ ]         STREAM     CONNECTED     137737   /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     131919   
unix  3      [ ]         STREAM     CONNECTED     137179   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     21086    
unix  2      [ ]         DGRAM      CONNECTED     182169   
unix  3      [ ]         STREAM     CONNECTED     133471   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     19899    
unix  2      [ ]         STREAM     CONNECTED     190581   
unix  3      [ ]         STREAM     CONNECTED     137178   
unix  3      [ ]         STREAM     CONNECTED     25095    
unix  3      [ ]         STREAM     CONNECTED     139828   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     139816   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139742   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     138991   
unix  3      [ ]         STREAM     CONNECTED     133405   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     75405    
unix  3      [ ]         STREAM     CONNECTED     137104   
unix  2      [ ]         STREAM     CONNECTED     137101   
unix  3      [ ]         STREAM     CONNECTED     137142   
unix  3      [ ]         STREAM     CONNECTED     138871   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         DGRAM      CONNECTED     137043   
unix  3      [ ]         STREAM     CONNECTED     138521   /run/dbus/system_bus_socket
unix  2      [ ]         STREAM     CONNECTED     182764   
unix  3      [ ]         STREAM     CONNECTED     18975    
unix  2      [ ]         DGRAM      CONNECTED     138826   
unix  3      [ ]         STREAM     CONNECTED     23568    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139051   
unix  3      [ ]         STREAM     CONNECTED     139814   
unix  3      [ ]         STREAM     CONNECTED     137123   
unix  3      [ ]         STREAM     CONNECTED     184480   
unix  3      [ ]         STREAM     CONNECTED     133493   
unix  3      [ ]         STREAM     CONNECTED     134357   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138175   
unix  3      [ ]         STREAM     CONNECTED     139015   
unix  3      [ ]         STREAM     CONNECTED     139778   
unix  2      [ ]         DGRAM      CONNECTED     132597   
unix  3      [ ]         STREAM     CONNECTED     26665    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     190585   
unix  3      [ ]         STREAM     CONNECTED     138222   @/tmp/.ICE-unix/24946
unix  3      [ ]         DGRAM      CONNECTED     16284    
unix  3      [ ]         STREAM     CONNECTED     139054   
unix  3      [ ]         STREAM     CONNECTED     139837   
unix  3      [ ]         STREAM     CONNECTED     138112   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139862   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     138125   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     138817   
unix  3      [ ]         STREAM     CONNECTED     18304    
unix  3      [ ]         STREAM     CONNECTED     139680   
unix  3      [ ]         STREAM     CONNECTED     137167   
unix  3      [ ]         STREAM     CONNECTED     138137   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     19116    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     137929   
unix  3      [ ]         STREAM     CONNECTED     139559   
unix  3      [ ]         STREAM     CONNECTED     132667   
unix  3      [ ]         STREAM     CONNECTED     132595   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139908   
unix  2      [ ]         STREAM     CONNECTED     178057   
unix  3      [ ]         STREAM     CONNECTED     137107   
unix  3      [ ]         STREAM     CONNECTED     138816   
unix  3      [ ]         STREAM     CONNECTED     138731   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138165   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     78968    
unix  3      [ ]         STREAM     CONNECTED     138091   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139877   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     137159   
unix  3      [ ]         STREAM     CONNECTED     181446   
unix  3      [ ]         STREAM     CONNECTED     139060   
unix  3      [ ]         STREAM     CONNECTED     139751   /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     184524   
unix  2      [ ]         DGRAM                    15267    
unix  3      [ ]         STREAM     CONNECTED     139876   
unix  3      [ ]         STREAM     CONNECTED     137973   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     131909   
unix  3      [ ]         STREAM     CONNECTED     139838   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     137155   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138068   @/tmp/.X11-unix/X0
unix  3      [ ]         DGRAM      CONNECTED     134340   
unix  3      [ ]         STREAM     CONNECTED     23444    
unix  3      [ ]         STREAM     CONNECTED     137136   
unix  3      [ ]         STREAM     CONNECTED     137144   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     191580   
unix  3      [ ]         STREAM     CONNECTED     138176   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139047   
unix  3      [ ]         STREAM     CONNECTED     137128   
unix  3      [ ]         STREAM     CONNECTED     15335    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     15027    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139567   
unix  3      [ ]         STREAM     CONNECTED     132603   
unix  3      [ ]         STREAM     CONNECTED     139036   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138993   
unix  3      [ ]         STREAM     CONNECTED     133498   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     21087    
unix  3      [ ]         STREAM     CONNECTED     20381    
unix  3      [ ]         STREAM     CONNECTED     139058   /run/user/1000/pulse/native
unix  3      [ ]         STREAM     CONNECTED     137133   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     137067   
unix  2      [ ]         DGRAM      CONNECTED     23566    
unix  3      [ ]         STREAM     CONNECTED     138054   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139695   
unix  3      [ ]         STREAM     CONNECTED     139836   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     15163    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     20382    
unix  3      [ ]         STREAM     CONNECTED     139050   
unix  3      [ ]         STREAM     CONNECTED     139806   
unix  3      [ ]         STREAM     CONNECTED     138990   
unix  3      [ ]         STREAM     CONNECTED     139039   /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     59520    
unix  3      [ ]         STREAM     CONNECTED     137157   
unix  3      [ ]         STREAM     CONNECTED     18976    /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     20379    
unix  3      [ ]         STREAM     CONNECTED     138160   
unix  3      [ ]         STREAM     CONNECTED     138929   
unix  3      [ ]         STREAM     CONNECTED     138033   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139763   
unix  2      [ ]         DGRAM      CONNECTED     131915   
unix  2      [ ]         DGRAM      CONNECTED     19199    
unix  3      [ ]         STREAM     CONNECTED     134370   
unix  3      [ ]         STREAM     CONNECTED     181445   
unix  3      [ ]         STREAM     CONNECTED     139059   
unix  3      [ ]         STREAM     CONNECTED     139841   
unix  3      [ ]         STREAM     CONNECTED     138172   /tmp/dbus-DqDL2zbVEk
unix  2      [ ]         DGRAM      CONNECTED     191576   
unix  3      [ ]         STREAM     CONNECTED     75406    
unix  3      [ ]         STREAM     CONNECTED     137099   
unix  3      [ ]         STREAM     CONNECTED     15259    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138173   
unix  3      [ ]         STREAM     CONNECTED     134362   
unix  3      [ ]         STREAM     CONNECTED     19900    
unix  3      [ ]         STREAM     CONNECTED     137139   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139042   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139098   
unix  2      [ ]         DGRAM      CONNECTED     23877    
unix  3      [ ]         STREAM     CONNECTED     139729   
unix  2      [ ]         DGRAM      CONNECTED     181439   
unix  3      [ ]         STREAM     CONNECTED     137158   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139813   
unix  3      [ ]         STREAM     CONNECTED     139693   /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     22958    
unix  3      [ ]         STREAM     CONNECTED     138174   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     132666   
unix  3      [ ]         STREAM     CONNECTED     139780   
unix  3      [ ]         STREAM     CONNECTED     137169   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     138064   
unix  3      [ ]         DGRAM      CONNECTED     134341   
unix  3      [ ]         STREAM     CONNECTED     138109   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     138048   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     76196    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     182767   
unix  3      [ ]         STREAM     CONNECTED     138167   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     134344   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139002   
unix  3      [ ]         STREAM     CONNECTED     22076    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138128   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139807   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         DGRAM      CONNECTED     133351   
unix  3      [ ]         STREAM     CONNECTED     76197    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     178060   
unix  3      [ ]         STREAM     CONNECTED     191581   
unix  3      [ ]         STREAM     CONNECTED     139907   
unix  3      [ ]         STREAM     CONNECTED     138156   
unix  3      [ ]         STREAM     CONNECTED     137931   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139842   
unix  3      [ ]         STREAM     CONNECTED     137125   
unix  3      [ ]         STREAM     CONNECTED     137119   
unix  3      [ ]         STREAM     CONNECTED     20577    
unix  3      [ ]         STREAM     CONNECTED     139056   
unix  3      [ ]         STREAM     CONNECTED     139817   
unix  3      [ ]         STREAM     CONNECTED     138116   @/tmp/.X11-unix/X0
unix  2      [ ]         DGRAM      CONNECTED     138992   
unix  2      [ ]         DGRAM      CONNECTED     134324   
unix  3      [ ]         STREAM     CONNECTED     18960    
unix  3      [ ]         STREAM     CONNECTED     137984   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     137149   
unix  3      [ ]         STREAM     CONNECTED     138036   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     184481   
unix  3      [ ]         STREAM     CONNECTED     24917    
unix  2      [ ]         STREAM     CONNECTED     182166   
unix  3      [ ]         STREAM     CONNECTED     139834   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     21669    
unix  3      [ ]         STREAM     CONNECTED     137096   
unix  3      [ ]         STREAM     CONNECTED     137093   
unix  3      [ ]         STREAM     CONNECTED     15237    
unix  3      [ ]         STREAM     CONNECTED     138045   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     138743   
unix  3      [ ]         STREAM     CONNECTED     139057   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139038   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138148   
unix  3      [ ]         STREAM     CONNECTED     139788   
unix  3      [ ]         STREAM     CONNECTED     134323   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     137148   
unix  3      [ ]         STREAM     CONNECTED     137923   
unix  3      [ ]         STREAM     CONNECTED     137168   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     133394   
unix  3      [ ]         STREAM     CONNECTED     75413    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     137084   
unix  3      [ ]         STREAM     CONNECTED     132594   
unix  3      [ ]         STREAM     CONNECTED     15160    
unix  3      [ ]         STREAM     CONNECTED     139026   
unix  3      [ ]         STREAM     CONNECTED     139815   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138910   
unix  3      [ ]         STREAM     CONNECTED     139694   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     20386    
unix  3      [ ]         STREAM     CONNECTED     139100   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     139061   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     133404   
unix  3      [ ]         STREAM     CONNECTED     138157   
unix  3      [ ]         STREAM     CONNECTED     23442    
unix  3      [ ]         STREAM     CONNECTED     138039   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139099   
unix  3      [ ]         STREAM     CONNECTED     19035    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138000   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139803   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     137143   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138177   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139790   
unix  3      [ ]         STREAM     CONNECTED     21053    
unix  3      [ ]         STREAM     CONNECTED     20506    
unix  2      [ ]         DGRAM      CONNECTED     19898    
unix  3      [ ]         STREAM     CONNECTED     137145   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138085   
unix  3      [ ]         STREAM     CONNECTED     23567    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139049   
unix  3      [ ]         STREAM     CONNECTED     132604   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139853   
unix  3      [ ]         STREAM     CONNECTED     139734   


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.310] PROCESSOR SCRIPT EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 05ebad85-daac-484f-b97d-b6c20ca1f8fa
Script Name: netstat соединения

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "sudo netstat -n"
# Проверяем, что отображаются подключения с указанием IP-адреса или DNS-имени хоста
# В выводе netstat должны быть строки с активными соединениями, содержащие IP-адреса или DNS-имена

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Проверяем, содержит ли вывод информацию о сетевых соединениях
# Ищем строки с IP-адресами (формат: x.x.x.x:port) или DNS-именами (формат: hostname:port)
# В netstat -n всегда выводятся IP-адреса, но могут быть и DNS-имена если флаг -n не использован

# Ищем строки с IP-адресами IPv4 (формат: x.x.x.x:port где x - число от 0 до 255)
# Пример: 192.168.1.1:22 или 10.0.0.1:54321
ipv4_pattern='[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}:[0-9]+'

... (total 55 lines, 2314 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 20219 chars, 292 lines:
Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 192.168.56.102:22       192.168.56.106:9474     ESTABLISHED
tcp        0    112 192.168.56.102:22       192.168.56.106:23133    ESTABLISHED
tcp        0      0 192.168.56.102:22       192.168.56.106:8354     ESTABLISHED
udp        0      0 127.0.0.1:50178         127.0.0.1:50178         ESTABLISHED
Active UNIX domain sockets (w/o servers)
Proto RefCnt Flags       Type       State         I-Node   Path
unix  3      [ ]         DGRAM      CONNECTED     16281    /run/systemd/notify
unix  2      [ ]         DGRAM                    16282    /run/systemd/cgroups-agent
unix  2      [ ]         DGRAM                    137042   /run/user/1000/systemd/notify
unix  2      [ ]         DGRAM                    133349   /run/user/108/systemd/notify
unix  23     [ ]         DGRAM      CONNECTED     16302    /run/systemd/journal/dev-log
unix  2      [ ]         DGRAM                    16303    /run/systemd/journal/syslog
unix  7      [ ]         DGRAM      CONNECTED     16305    /run/systemd/journal/socket
unix  2      [ ]         DGRAM      CONNECTED     78953    /var/lib/samba/private/msg.sock/16440
unix  2      [ ]         DGRAM      CONNECTED     78467    /var/lib/samba/private/msg.sock/16454
unix  2      [ ]         DGRAM      CONNECTED     76677    /var/lib/samba/private/msg.sock/16455
unix  2      [ ]         DGRAM                    78469    /var/lib/samba/private/msg.sock/16456
unix  2      [ ]         DGRAM      CONNECTED     78596    /var/lib/samba/private/msg.sock/16506
unix  2      [ ]         DGRAM      CONNECTED     15100    
unix  3      [ ]         STREAM     CONNECTED     139698   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138869   
unix  2      [ ]         DGRAM      CONNECTED     20591    
unix  3      [ ]         STREAM     CONNECTED     15260    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139818   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     133492   
unix  3      [ ]         STREAM     CONNECTED     138185   
unix  3      [ ]         STREAM     CONNECTED     18974    
unix  3      [ ]         STREAM     CONNECTED     139715   
unix  3      [ ]         STREAM     CONNECTED     132668   
unix  3      [ ]         STREAM     CONNECTED     131833   
unix  3      [ ]         STREAM     CONNECTED     138219   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139043   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138170   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139835   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     22075    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139791   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     22083    
unix  3      [ ]         STREAM     CONNECTED     138886   /tmp/dbus-COEPxU4mVs
unix  2      [ ]         DGRAM      CONNECTED     183640   
unix  3      [ ]         STREAM     CONNECTED     137146   
unix  3      [ ]         STREAM     CONNECTED     22424    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     137132   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139041   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138032   
unix  3      [ ]         STREAM     CONNECTED     78969    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     22780    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138870   
unix  3      [ ]         DGRAM      CONNECTED     133350   
unix  3      [ ]         STREAM     CONNECTED     137129   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138015   @/tmp/.X11-unix/X0
unix  3      [ ]         DGRAM      CONNECTED     16283    
unix  2      [ ]         DGRAM      CONNECTED     138739   
unix  3      [ ]         STREAM     CONNECTED     139025   
unix  3      [ ]         STREAM     CONNECTED     139848   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     15334    
unix  3      [ ]         STREAM     CONNECTED     138223   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     132669   
unix  3      [ ]         STREAM     CONNECTED     76198    
unix  2      [ ]         DGRAM      CONNECTED     140296   
unix  3      [ ]         STREAM     CONNECTED     138086   
unix  3      [ ]         STREAM     CONNECTED     139738   /tmp/dbus-COEPxU4mVs
unix  2      [ ]         DGRAM      CONNECTED     24885    
unix  3      [ ]         STREAM     CONNECTED     137134   
unix  3      [ ]         DGRAM      CONNECTED     137044   
unix  3      [ ]         STREAM     CONNECTED     137737   /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     131919   
unix  3      [ ]         STREAM     CONNECTED     137179   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     21086    
unix  2      [ ]         DGRAM      CONNECTED     182169   
unix  3      [ ]         STREAM     CONNECTED     133471   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     19899    
unix  2      [ ]         STREAM     CONNECTED     190581   
unix  3      [ ]         STREAM     CONNECTED     137178   
unix  3      [ ]         STREAM     CONNECTED     25095    
unix  3      [ ]         STREAM     CONNECTED     139828   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     139816   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139742   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     138991   
unix  3      [ ]         STREAM     CONNECTED     133405   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     75405    
unix  3      [ ]         STREAM     CONNECTED     137104   
unix  2      [ ]         STREAM     CONNECTED     137101   
unix  3      [ ]         STREAM     CONNECTED     137142   
unix  3      [ ]         STREAM     CONNECTED     138871   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         DGRAM      CONNECTED     137043   
unix  3      [ ]         STREAM     CONNECTED     138521   /run/dbus/system_bus_socket
unix  2      [ ]         STREAM     CONNECTED     182764   
unix  3      [ ]         STREAM     CONNECTED     18975    
unix  2      [ ]         DGRAM      CONNECTED     138826   
unix  3      [ ]         STREAM     CONNECTED     23568    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139051   
unix  3      [ ]         STREAM     CONNECTED     139814   
unix  3      [ ]         STREAM     CONNECTED     137123   
unix  3      [ ]         STREAM     CONNECTED     184480   
unix  3      [ ]         STREAM     CONNECTED     133493   
unix  3      [ ]         STREAM     CONNECTED     134357   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138175   
unix  3      [ ]         STREAM     CONNECTED     139015   
unix  3      [ ]         STREAM     CONNECTED     139778   
unix  2      [ ]         DGRAM      CONNECTED     132597   
unix  3      [ ]         STREAM     CONNECTED     26665    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     190585   
unix  3      [ ]         STREAM     CONNECTED     138222   @/tmp/.ICE-unix/24946
unix  3      [ ]         DGRAM      CONNECTED     16284    
unix  3      [ ]         STREAM     CONNECTED     139054   
unix  3      [ ]         STREAM     CONNECTED     139837   
unix  3      [ ]         STREAM     CONNECTED     138112   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139862   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     138125   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     138817   
unix  3      [ ]         STREAM     CONNECTED     18304    
unix  3      [ ]         STREAM     CONNECTED     139680   
unix  3      [ ]         STREAM     CONNECTED     137167   
unix  3      [ ]         STREAM     CONNECTED     138137   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     19116    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     137929   
unix  3      [ ]         STREAM     CONNECTED     139559   
unix  3      [ ]         STREAM     CONNECTED     132667   
unix  3      [ ]         STREAM     CONNECTED     132595   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139908   
unix  2      [ ]         STREAM     CONNECTED     178057   
unix  3      [ ]         STREAM     CONNECTED     137107   
unix  3      [ ]         STREAM     CONNECTED     138816   
unix  3      [ ]         STREAM     CONNECTED     138731   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138165   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     78968    
unix  3      [ ]         STREAM     CONNECTED     138091   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139877   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     137159   
unix  3      [ ]         STREAM     CONNECTED     181446   
unix  3      [ ]         STREAM     CONNECTED     139060   
unix  3      [ ]         STREAM     CONNECTED     139751   /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     184524   
unix  2      [ ]         DGRAM                    15267    
unix  3      [ ]         STREAM     CONNECTED     139876   
unix  3      [ ]         STREAM     CONNECTED     137973   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     131909   
unix  3      [ ]         STREAM     CONNECTED     139838   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     137155   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138068   @/tmp/.X11-unix/X0
unix  3      [ ]         DGRAM      CONNECTED     134340   
unix  3      [ ]         STREAM     CONNECTED     23444    
unix  3      [ ]         STREAM     CONNECTED     137136   
unix  3      [ ]         STREAM     CONNECTED     137144   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     191580   
unix  3      [ ]         STREAM     CONNECTED     138176   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139047   
unix  3      [ ]         STREAM     CONNECTED     137128   
unix  3      [ ]         STREAM     CONNECTED     15335    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     15027    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139567   
unix  3      [ ]         STREAM     CONNECTED     132603   
unix  3      [ ]         STREAM     CONNECTED     139036   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138993   
unix  3      [ ]         STREAM     CONNECTED     133498   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     21087    
unix  3      [ ]         STREAM     CONNECTED     20381    
unix  3      [ ]         STREAM     CONNECTED     139058   /run/user/1000/pulse/native
unix  3      [ ]         STREAM     CONNECTED     137133   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     137067   
unix  2      [ ]         DGRAM      CONNECTED     23566    
unix  3      [ ]         STREAM     CONNECTED     138054   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139695   
unix  3      [ ]         STREAM     CONNECTED     139836   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     15163    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     20382    
unix  3      [ ]         STREAM     CONNECTED     139050   
unix  3      [ ]         STREAM     CONNECTED     139806   
unix  3      [ ]         STREAM     CONNECTED     138990   
unix  3      [ ]         STREAM     CONNECTED     139039   /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     59520    
unix  3      [ ]         STREAM     CONNECTED     137157   
unix  3      [ ]         STREAM     CONNECTED     18976    /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     20379    
unix  3      [ ]         STREAM     CONNECTED     138160   
unix  3      [ ]         STREAM     CONNECTED     138929   
unix  3      [ ]         STREAM     CONNECTED     138033   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139763   
unix  2      [ ]         DGRAM      CONNECTED     131915   
unix  2      [ ]         DGRAM      CONNECTED     19199    
unix  3      [ ]         STREAM     CONNECTED     134370   
unix  3      [ ]         STREAM     CONNECTED     181445   
unix  3      [ ]         STREAM     CONNECTED     139059   
unix  3      [ ]         STREAM     CONNECTED     139841   
unix  3      [ ]         STREAM     CONNECTED     138172   /tmp/dbus-DqDL2zbVEk
unix  2      [ ]         DGRAM      CONNECTED     191576   
unix  3      [ ]         STREAM     CONNECTED     75406    
unix  3      [ ]         STREAM     CONNECTED     137099   
unix  3      [ ]         STREAM     CONNECTED     15259    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138173   
unix  3      [ ]         STREAM     CONNECTED     134362   
unix  3      [ ]         STREAM     CONNECTED     19900    
unix  3      [ ]         STREAM     CONNECTED     137139   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139042   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139098   
unix  2      [ ]         DGRAM      CONNECTED     23877    
unix  3      [ ]         STREAM     CONNECTED     139729   
unix  2      [ ]         DGRAM      CONNECTED     181439   
unix  3      [ ]         STREAM     CONNECTED     137158   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139813   
unix  3      [ ]         STREAM     CONNECTED     139693   /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     22958    
unix  3      [ ]         STREAM     CONNECTED     138174   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     132666   
unix  3      [ ]         STREAM     CONNECTED     139780   
unix  3      [ ]         STREAM     CONNECTED     137169   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     138064   
unix  3      [ ]         DGRAM      CONNECTED     134341   
unix  3      [ ]         STREAM     CONNECTED     138109   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     138048   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     76196    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     182767   
unix  3      [ ]         STREAM     CONNECTED     138167   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     134344   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139002   
unix  3      [ ]         STREAM     CONNECTED     22076    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138128   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139807   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         DGRAM      CONNECTED     133351   
unix  3      [ ]         STREAM     CONNECTED     76197    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     178060   
unix  3      [ ]         STREAM     CONNECTED     191581   
unix  3      [ ]         STREAM     CONNECTED     139907   
unix  3      [ ]         STREAM     CONNECTED     138156   
unix  3      [ ]         STREAM     CONNECTED     137931   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139842   
unix  3      [ ]         STREAM     CONNECTED     137125   
unix  3      [ ]         STREAM     CONNECTED     137119   
unix  3      [ ]         STREAM     CONNECTED     20577    
unix  3      [ ]         STREAM     CONNECTED     139056   
unix  3      [ ]         STREAM     CONNECTED     139817   
unix  3      [ ]         STREAM     CONNECTED     138116   @/tmp/.X11-unix/X0
unix  2      [ ]         DGRAM      CONNECTED     138992   
unix  2      [ ]         DGRAM      CONNECTED     134324   
unix  3      [ ]         STREAM     CONNECTED     18960    
unix  3      [ ]         STREAM     CONNECTED     137984   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     137149   
unix  3      [ ]         STREAM     CONNECTED     138036   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     184481   
unix  3      [ ]         STREAM     CONNECTED     24917    
unix  2      [ ]         STREAM     CONNECTED     182166   
unix  3      [ ]         STREAM     CONNECTED     139834   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     21669    
unix  3      [ ]         STREAM     CONNECTED     137096   
unix  3      [ ]         STREAM     CONNECTED     137093   
unix  3      [ ]         STREAM     CONNECTED     15237    
unix  3      [ ]         STREAM     CONNECTED     138045   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     138743   
unix  3      [ ]         STREAM     CONNECTED     139057   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139038   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138148   
unix  3      [ ]         STREAM     CONNECTED     139788   
unix  3      [ ]         STREAM     CONNECTED     134323   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     137148   
unix  3      [ ]         STREAM     CONNECTED     137923   
unix  3      [ ]         STREAM     CONNECTED     137168   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     133394   
unix  3      [ ]         STREAM     CONNECTED     75413    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     137084   
unix  3      [ ]         STREAM     CONNECTED     132594   
unix  3      [ ]         STREAM     CONNECTED     15160    
unix  3      [ ]         STREAM     CONNECTED     139026   
unix  3      [ ]         STREAM     CONNECTED     139815   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138910   
unix  3      [ ]         STREAM     CONNECTED     139694   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     20386    
unix  3      [ ]         STREAM     CONNECTED     139100   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     139061   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     133404   
unix  3      [ ]         STREAM     CONNECTED     138157   
unix  3      [ ]         STREAM     CONNECTED     23442    
unix  3      [ ]         STREAM     CONNECTED     138039   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139099   
unix  3      [ ]         STREAM     CONNECTED     19035    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138000   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139803   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     137143   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138177   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139790   
unix  3      [ ]         STREAM     CONNECTED     21053    
unix  3      [ ]         STREAM     CONNECTED     20506    
unix  2      [ ]         DGRAM      CONNECTED     19898    
unix  3      [ ]         STREAM     CONNECTED     137145   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138085   
unix  3      [ ]         STREAM     CONNECTED     23567    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139049   
unix  3      [ ]         STREAM     CONNECTED     132604   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139853   
unix  3      [ ]         STREAM     CONNECTED     139734   


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 0 (SUCCESS)

>>> STDOUT (9 chars):
Пройдена


>>> STDERR (41963 chars):
+ set -eo pipefail
+ '[' -z 'Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 192.168.56.102:22       192.168.56.106:9474     ESTABLISHED
tcp        0    112 192.168.56.102:22       192.168.56.106:23133    ESTABLISHED
tcp        0      0 192.168.56.102:22       192.168.56.106:8354     ESTABLISHED
udp        0      0 127.0.0.1:50178         127.0.0.1:50178         ESTABLISHED
Active UNIX domain sockets (w/o servers)
Proto RefCnt Flags       Type       State         I-Node   Path
unix  3      [ ]         DGRAM      CONNECTED     16281    /run/systemd/notify
unix  2      [ ]         DGRAM                    16282    /run/systemd/cgroups-agent
unix  2      [ ]         DGRAM                    137042   /run/user/1000/systemd/notify
unix  2      [ ]         DGRAM                    133349   /run/user/108/systemd/notify
unix  23     [ ]         DGRAM      CONNECTED     16302    /run/systemd/journal/dev-log
unix  2      [ ]         DGRAM                    16303    /run/systemd/journal/syslog
unix  7      [ ]         DGRAM      CONNECTED     16305    /run/systemd/journal/socket
unix  2      [ ]         DGRAM      CONNECTED     78953    /var/lib/samba/private/msg.sock/16440
unix  2      [ ]         DGRAM      CONNECTED     78467    /var/lib/samba/private/msg.sock/16454
unix  2      [ ]         DGRAM      CONNECTED     76677    /var/lib/samba/private/msg.sock/16455
unix  2      [ ]         DGRAM                    78469    /var/lib/samba/private/msg.sock/16456
unix  2      [ ]         DGRAM      CONNECTED     78596    /var/lib/samba/private/msg.sock/16506
unix  2      [ ]         DGRAM      CONNECTED     15100    
unix  3      [ ]         STREAM     CONNECTED     139698   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138869   
unix  2      [ ]         DGRAM      CONNECTED     20591    
unix  3      [ ]         STREAM     CONNECTED     15260    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139818   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     133492   
unix  3      [ ]         STREAM     CONNECTED     138185   
unix  3      [ ]         STREAM     CONNECTED     18974    
unix  3      [ ]         STREAM     CONNECTED     139715   
unix  3      [ ]         STREAM     CONNECTED     132668   
unix  3      [ ]         STREAM     CONNECTED     131833   
unix  3      [ ]         STREAM     CONNECTED     138219   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139043   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138170   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139835   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     22075    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139791   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     22083    
unix  3      [ ]         STREAM     CONNECTED     138886   /tmp/dbus-COEPxU4mVs
unix  2      [ ]         DGRAM      CONNECTED     183640   
unix  3      [ ]         STREAM     CONNECTED     137146   
unix  3      [ ]         STREAM     CONNECTED     22424    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     137132   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139041   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138032   
unix  3      [ ]         STREAM     CONNECTED     78969    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     22780    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138870   
unix  3      [ ]         DGRAM      CONNECTED     133350   
unix  3      [ ]         STREAM     CONNECTED     137129   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138015   @/tmp/.X11-unix/X0
unix  3      [ ]         DGRAM      CONNECTED     16283    
unix  2      [ ]         DGRAM      CONNECTED     138739   
unix  3      [ ]         STREAM     CONNECTED     139025   
unix  3      [ ]         STREAM     CONNECTED     139848   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     15334    
unix  3      [ ]         STREAM     CONNECTED     138223   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     132669   
unix  3      [ ]         STREAM     CONNECTED     76198    
unix  2      [ ]         DGRAM      CONNECTED     140296   
unix  3      [ ]         STREAM     CONNECTED     138086   
unix  3      [ ]         STREAM     CONNECTED     139738   /tmp/dbus-COEPxU4mVs
unix  2      [ ]         DGRAM      CONNECTED     24885    
unix  3      [ ]         STREAM     CONNECTED     137134   
unix  3      [ ]         DGRAM      CONNECTED     137044   
unix  3      [ ]         STREAM     CONNECTED     137737   /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     131919   
unix  3      [ ]         STREAM     CONNECTED     137179   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     21086    
unix  2      [ ]         DGRAM      CONNECTED     182169   
unix  3      [ ]         STREAM     CONNECTED     133471   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     19899    
unix  2      [ ]         STREAM     CONNECTED     190581   
unix  3      [ ]         STREAM     CONNECTED     137178   
unix  3      [ ]         STREAM     CONNECTED     25095    
unix  3      [ ]         STREAM     CONNECTED     139828   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     139816   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139742   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     138991   
unix  3      [ ]         STREAM     CONNECTED     133405   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     75405    
unix  3      [ ]         STREAM     CONNECTED     137104   
unix  2      [ ]         STREAM     CONNECTED     137101   
unix  3      [ ]         STREAM     CONNECTED     137142   
unix  3      [ ]         STREAM     CONNECTED     138871   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         DGRAM      CONNECTED     137043   
unix  3      [ ]         STREAM     CONNECTED     138521   /run/dbus/system_bus_socket
unix  2      [ ]         STREAM     CONNECTED     182764   
unix  3      [ ]         STREAM     CONNECTED     18975    
unix  2      [ ]         DGRAM      CONNECTED     138826   
unix  3      [ ]         STREAM     CONNECTED     23568    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139051   
unix  3      [ ]         STREAM     CONNECTED     139814   
unix  3      [ ]         STREAM     CONNECTED     137123   
unix  3      [ ]         STREAM     CONNECTED     184480   
unix  3      [ ]         STREAM     CONNECTED     133493   
unix  3      [ ]         STREAM     CONNECTED     134357   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138175   
unix  3      [ ]         STREAM     CONNECTED     139015   
unix  3      [ ]         STREAM     CONNECTED     139778   
unix  2      [ ]         DGRAM      CONNECTED     132597   
unix  3      [ ]         STREAM     CONNECTED     26665    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     190585   
unix  3      [ ]         STREAM     CONNECTED     138222   @/tmp/.ICE-unix/24946
unix  3      [ ]         DGRAM      CONNECTED     16284    
unix  3      [ ]         STREAM     CONNECTED     139054   
unix  3      [ ]         STREAM     CONNECTED     139837   
unix  3      [ ]         STREAM     CONNECTED     138112   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139862   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     138125   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     138817   
unix  3      [ ]         STREAM     CONNECTED     18304    
unix  3      [ ]         STREAM     CONNECTED     139680   
unix  3      [ ]         STREAM     CONNECTED     137167   
unix  3      [ ]         STREAM     CONNECTED     138137   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     19116    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     137929   
unix  3      [ ]         STREAM     CONNECTED     139559   
unix  3      [ ]         STREAM     CONNECTED     132667   
unix  3      [ ]         STREAM     CONNECTED     132595   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139908   
unix  2      [ ]         STREAM     CONNECTED     178057   
unix  3      [ ]         STREAM     CONNECTED     137107   
unix  3      [ ]         STREAM     CONNECTED     138816   
unix  3      [ ]         STREAM     CONNECTED     138731   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138165   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     78968    
unix  3      [ ]         STREAM     CONNECTED     138091   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139877   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     137159   
unix  3      [ ]         STREAM     CONNECTED     181446   
unix  3      [ ]         STREAM     CONNECTED     139060   
unix  3      [ ]         STREAM     CONNECTED     139751   /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     184524   
unix  2      [ ]         DGRAM                    15267    
unix  3      [ ]         STREAM     CONNECTED     139876   
unix  3      [ ]         STREAM     CONNECTED     137973   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     131909   
unix  3      [ ]         STREAM     CONNECTED     139838   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     137155   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138068   @/tmp/.X11-unix/X0
unix  3      [ ]         DGRAM      CONNECTED     134340   
unix  3      [ ]         STREAM     CONNECTED     23444    
unix  3      [ ]         STREAM     CONNECTED     137136   
unix  3      [ ]         STREAM     CONNECTED     137144   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     191580   
unix  3      [ ]         STREAM     CONNECTED     138176   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139047   
unix  3      [ ]         STREAM     CONNECTED     137128   
unix  3      [ ]         STREAM     CONNECTED     15335    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     15027    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139567   
unix  3      [ ]         STREAM     CONNECTED     132603   
unix  3      [ ]         STREAM     CONNECTED     139036   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138993   
unix  3      [ ]         STREAM     CONNECTED     133498   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     21087    
unix  3      [ ]         STREAM     CONNECTED     20381    
unix  3      [ ]         STREAM     CONNECTED     139058   /run/user/1000/pulse/native
unix  3      [ ]         STREAM     CONNECTED     137133   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     137067   
unix  2      [ ]         DGRAM      CONNECTED     23566    
unix  3      [ ]         STREAM     CONNECTED     138054   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139695   
unix  3      [ ]         STREAM     CONNECTED     139836   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     15163    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     20382    
unix  3      [ ]         STREAM     CONNECTED     139050   
unix  3      [ ]         STREAM     CONNECTED     139806   
unix  3      [ ]         STREAM     CONNECTED     138990   
unix  3      [ ]         STREAM     CONNECTED     139039   /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     59520    
unix  3      [ ]         STREAM     CONNECTED     137157   
unix  3      [ ]         STREAM     CONNECTED     18976    /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     20379    
unix  3      [ ]         STREAM     CONNECTED     138160   
unix  3      [ ]         STREAM     CONNECTED     138929   
unix  3      [ ]         STREAM     CONNECTED     138033   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139763   
unix  2      [ ]         DGRAM      CONNECTED     131915   
unix  2      [ ]         DGRAM      CONNECTED     19199    
unix  3      [ ]         STREAM     CONNECTED     134370   
unix  3      [ ]         STREAM     CONNECTED     181445   
unix  3      [ ]         STREAM     CONNECTED     139059   
unix  3      [ ]         STREAM     CONNECTED     139841   
unix  3      [ ]         STREAM     CONNECTED     138172   /tmp/dbus-DqDL2zbVEk
unix  2      [ ]         DGRAM      CONNECTED     191576   
unix  3      [ ]         STREAM     CONNECTED     75406    
unix  3      [ ]         STREAM     CONNECTED     137099   
unix  3      [ ]         STREAM     CONNECTED     15259    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138173   
unix  3      [ ]         STREAM     CONNECTED     134362   
unix  3      [ ]         STREAM     CONNECTED     19900    
unix  3      [ ]         STREAM     CONNECTED     137139   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139042   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139098   
unix  2      [ ]         DGRAM      CONNECTED     23877    
unix  3      [ ]         STREAM     CONNECTED     139729   
unix  2      [ ]         DGRAM      CONNECTED     181439   
unix  3      [ ]         STREAM     CONNECTED     137158   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139813   
unix  3      [ ]         STREAM     CONNECTED     139693   /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     22958    
unix  3      [ ]         STREAM     CONNECTED     138174   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     132666   
unix  3      [ ]         STREAM     CONNECTED     139780   
unix  3      [ ]         STREAM     CONNECTED     137169   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     138064   
unix  3      [ ]         DGRAM      CONNECTED     134341   
unix  3      [ ]         STREAM     CONNECTED     138109   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     138048   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     76196    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     182767   
unix  3      [ ]         STREAM     CONNECTED     138167   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     134344   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139002   
unix  3      [ ]         STREAM     CONNECTED     22076    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138128   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139807   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         DGRAM      CONNECTED     133351   
unix  3      [ ]         STREAM     CONNECTED     76197    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     178060   
unix  3      [ ]         STREAM     CONNECTED     191581   
unix  3      [ ]         STREAM     CONNECTED     139907   
unix  3      [ ]         STREAM     CONNECTED     138156   
unix  3      [ ]         STREAM     CONNECTED     137931   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139842   
unix  3      [ ]         STREAM     CONNECTED     137125   
unix  3      [ ]         STREAM     CONNECTED     137119   
unix  3      [ ]         STREAM     CONNECTED     20577    
unix  3      [ ]         STREAM     CONNECTED     139056   
unix  3      [ ]         STREAM     CONNECTED     139817   
unix  3      [ ]         STREAM     CONNECTED     138116   @/tmp/.X11-unix/X0
unix  2      [ ]         DGRAM      CONNECTED     138992   
unix  2      [ ]         DGRAM      CONNECTED     134324   
unix  3      [ ]         STREAM     CONNECTED     18960    
unix  3      [ ]         STREAM     CONNECTED     137984   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     137149   
unix  3      [ ]         STREAM     CONNECTED     138036   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     184481   
unix  3      [ ]         STREAM     CONNECTED     24917    
unix  2      [ ]         STREAM     CONNECTED     182166   
unix  3      [ ]         STREAM     CONNECTED     139834   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     21669    
unix  3      [ ]         STREAM     CONNECTED     137096   
unix  3      [ ]         STREAM     CONNECTED     137093   
unix  3      [ ]         STREAM     CONNECTED     15237    
unix  3      [ ]         STREAM     CONNECTED     138045   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     138743   
unix  3      [ ]         STREAM     CONNECTED     139057   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139038   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138148   
unix  3      [ ]         STREAM     CONNECTED     139788   
unix  3      [ ]         STREAM     CONNECTED     134323   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     137148   
unix  3      [ ]         STREAM     CONNECTED     137923   
unix  3      [ ]         STREAM     CONNECTED     137168   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     133394   
unix  3      [ ]         STREAM     CONNECTED     75413    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     137084   
unix  3      [ ]         STREAM     CONNECTED     132594   
unix  3      [ ]         STREAM     CONNECTED     15160    
unix  3      [ ]         STREAM     CONNECTED     139026   
unix  3      [ ]         STREAM     CONNECTED     139815   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138910   
unix  3      [ ]         STREAM     CONNECTED     139694   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     20386    
unix  3      [ ]         STREAM     CONNECTED     139100   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     139061   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     133404   
unix  3      [ ]         STREAM     CONNECTED     138157   
unix  3      [ ]         STREAM     CONNECTED     23442    
unix  3      [ ]         STREAM     CONNECTED     138039   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139099   
unix  3      [ ]         STREAM     CONNECTED     19035    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138000   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139803   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     137143   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138177   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139790   
unix  3      [ ]         STREAM     CONNECTED     21053    
unix  3      [ ]         STREAM     CONNECTED     20506    
unix  2      [ ]         DGRAM      CONNECTED     19898    
unix  3      [ ]         STREAM     CONNECTED     137145   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138085   
unix  3      [ ]         STREAM     CONNECTED     23567    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139049   
unix  3      [ ]         STREAM     CONNECTED     132604   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139853   
unix  3      [ ]         STREAM     CONNECTED     139734   
' ']'
+ ipv4_pattern='[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}:[0-9]+'
+ ipv6_pattern='\[[0-9a-fA-F:]+:[0-9]+\]'
+ dns_pattern='[a-zA-Z][a-zA-Z0-9._-]*:[0-9]+'
++ grep -E '([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}:[0-9]+|\[[0-9a-fA-F:]+:[0-9]+\]|[a-zA-Z][a-zA-Z0-9._-]*:[0-9]+)'
++ echo 'Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 192.168.56.102:22       192.168.56.106:9474     ESTABLISHED
tcp        0    112 192.168.56.102:22       192.168.56.106:23133    ESTABLISHED
tcp        0      0 192.168.56.102:22       192.168.56.106:8354     ESTABLISHED
udp        0      0 127.0.0.1:50178         127.0.0.1:50178         ESTABLISHED
Active UNIX domain sockets (w/o servers)
Proto RefCnt Flags       Type       State         I-Node   Path
unix  3      [ ]         DGRAM      CONNECTED     16281    /run/systemd/notify
unix  2      [ ]         DGRAM                    16282    /run/systemd/cgroups-agent
unix  2      [ ]         DGRAM                    137042   /run/user/1000/systemd/notify
unix  2      [ ]         DGRAM                    133349   /run/user/108/systemd/notify
unix  23     [ ]         DGRAM      CONNECTED     16302    /run/systemd/journal/dev-log
unix  2      [ ]         DGRAM                    16303    /run/systemd/journal/syslog
unix  7      [ ]         DGRAM      CONNECTED     16305    /run/systemd/journal/socket
unix  2      [ ]         DGRAM      CONNECTED     78953    /var/lib/samba/private/msg.sock/16440
unix  2      [ ]         DGRAM      CONNECTED     78467    /var/lib/samba/private/msg.sock/16454
unix  2      [ ]         DGRAM      CONNECTED     76677    /var/lib/samba/private/msg.sock/16455
unix  2      [ ]         DGRAM                    78469    /var/lib/samba/private/msg.sock/16456
unix  2      [ ]         DGRAM      CONNECTED     78596    /var/lib/samba/private/msg.sock/16506
unix  2      [ ]         DGRAM      CONNECTED     15100    
unix  3      [ ]         STREAM     CONNECTED     139698   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138869   
unix  2      [ ]         DGRAM      CONNECTED     20591    
unix  3      [ ]         STREAM     CONNECTED     15260    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139818   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     133492   
unix  3      [ ]         STREAM     CONNECTED     138185   
unix  3      [ ]         STREAM     CONNECTED     18974    
unix  3      [ ]         STREAM     CONNECTED     139715   
unix  3      [ ]         STREAM     CONNECTED     132668   
unix  3      [ ]         STREAM     CONNECTED     131833   
unix  3      [ ]         STREAM     CONNECTED     138219   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139043   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138170   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139835   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     22075    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139791   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     22083    
unix  3      [ ]         STREAM     CONNECTED     138886   /tmp/dbus-COEPxU4mVs
unix  2      [ ]         DGRAM      CONNECTED     183640   
unix  3      [ ]         STREAM     CONNECTED     137146   
unix  3      [ ]         STREAM     CONNECTED     22424    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     137132   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139041   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138032   
unix  3      [ ]         STREAM     CONNECTED     78969    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     22780    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138870   
unix  3      [ ]         DGRAM      CONNECTED     133350   
unix  3      [ ]         STREAM     CONNECTED     137129   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138015   @/tmp/.X11-unix/X0
unix  3      [ ]         DGRAM      CONNECTED     16283    
unix  2      [ ]         DGRAM      CONNECTED     138739   
unix  3      [ ]         STREAM     CONNECTED     139025   
unix  3      [ ]         STREAM     CONNECTED     139848   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     15334    
unix  3      [ ]         STREAM     CONNECTED     138223   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     132669   
unix  3      [ ]         STREAM     CONNECTED     76198    
unix  2      [ ]         DGRAM      CONNECTED     140296   
unix  3      [ ]         STREAM     CONNECTED     138086   
unix  3      [ ]         STREAM     CONNECTED     139738   /tmp/dbus-COEPxU4mVs
unix  2      [ ]         DGRAM      CONNECTED     24885    
unix  3      [ ]         STREAM     CONNECTED     137134   
unix  3      [ ]         DGRAM      CONNECTED     137044   
unix  3      [ ]         STREAM     CONNECTED     137737   /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     131919   
unix  3      [ ]         STREAM     CONNECTED     137179   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     21086    
unix  2      [ ]         DGRAM      CONNECTED     182169   
unix  3      [ ]         STREAM     CONNECTED     133471   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     19899    
unix  2      [ ]         STREAM     CONNECTED     190581   
unix  3      [ ]         STREAM     CONNECTED     137178   
unix  3      [ ]         STREAM     CONNECTED     25095    
unix  3      [ ]         STREAM     CONNECTED     139828   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     139816   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139742   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     138991   
unix  3      [ ]         STREAM     CONNECTED     133405   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     75405    
unix  3      [ ]         STREAM     CONNECTED     137104   
unix  2      [ ]         STREAM     CONNECTED     137101   
unix  3      [ ]         STREAM     CONNECTED     137142   
unix  3      [ ]         STREAM     CONNECTED     138871   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         DGRAM      CONNECTED     137043   
unix  3      [ ]         STREAM     CONNECTED     138521   /run/dbus/system_bus_socket
unix  2      [ ]         STREAM     CONNECTED     182764   
unix  3      [ ]         STREAM     CONNECTED     18975    
unix  2      [ ]         DGRAM      CONNECTED     138826   
unix  3      [ ]         STREAM     CONNECTED     23568    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139051   
unix  3      [ ]         STREAM     CONNECTED     139814   
unix  3      [ ]         STREAM     CONNECTED     137123   
unix  3      [ ]         STREAM     CONNECTED     184480   
unix  3      [ ]         STREAM     CONNECTED     133493   
unix  3      [ ]         STREAM     CONNECTED     134357   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138175   
unix  3      [ ]         STREAM     CONNECTED     139015   
unix  3      [ ]         STREAM     CONNECTED     139778   
unix  2      [ ]         DGRAM      CONNECTED     132597   
unix  3      [ ]         STREAM     CONNECTED     26665    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     190585   
unix  3      [ ]         STREAM     CONNECTED     138222   @/tmp/.ICE-unix/24946
unix  3      [ ]         DGRAM      CONNECTED     16284    
unix  3      [ ]         STREAM     CONNECTED     139054   
unix  3      [ ]         STREAM     CONNECTED     139837   
unix  3      [ ]         STREAM     CONNECTED     138112   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139862   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     138125   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     138817   
unix  3      [ ]         STREAM     CONNECTED     18304    
unix  3      [ ]         STREAM     CONNECTED     139680   
unix  3      [ ]         STREAM     CONNECTED     137167   
unix  3      [ ]         STREAM     CONNECTED     138137   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     19116    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     137929   
unix  3      [ ]         STREAM     CONNECTED     139559   
unix  3      [ ]         STREAM     CONNECTED     132667   
unix  3      [ ]         STREAM     CONNECTED     132595   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139908   
unix  2      [ ]         STREAM     CONNECTED     178057   
unix  3      [ ]         STREAM     CONNECTED     137107   
unix  3      [ ]         STREAM     CONNECTED     138816   
unix  3      [ ]         STREAM     CONNECTED     138731   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138165   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     78968    
unix  3      [ ]         STREAM     CONNECTED     138091   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139877   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     137159   
unix  3      [ ]         STREAM     CONNECTED     181446   
unix  3      [ ]         STREAM     CONNECTED     139060   
unix  3      [ ]         STREAM     CONNECTED     139751   /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     184524   
unix  2      [ ]         DGRAM                    15267    
unix  3      [ ]         STREAM     CONNECTED     139876   
unix  3      [ ]         STREAM     CONNECTED     137973   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     131909   
unix  3      [ ]         STREAM     CONNECTED     139838   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     137155   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138068   @/tmp/.X11-unix/X0
unix  3      [ ]         DGRAM      CONNECTED     134340   
unix  3      [ ]         STREAM     CONNECTED     23444    
unix  3      [ ]         STREAM     CONNECTED     137136   
unix  3      [ ]         STREAM     CONNECTED     137144   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     191580   
unix  3      [ ]         STREAM     CONNECTED     138176   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     139047   
unix  3      [ ]         STREAM     CONNECTED     137128   
unix  3      [ ]         STREAM     CONNECTED     15335    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     15027    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139567   
unix  3      [ ]         STREAM     CONNECTED     132603   
unix  3      [ ]         STREAM     CONNECTED     139036   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138993   
unix  3      [ ]         STREAM     CONNECTED     133498   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     21087    
unix  3      [ ]         STREAM     CONNECTED     20381    
unix  3      [ ]         STREAM     CONNECTED     139058   /run/user/1000/pulse/native
unix  3      [ ]         STREAM     CONNECTED     137133   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     137067   
unix  2      [ ]         DGRAM      CONNECTED     23566    
unix  3      [ ]         STREAM     CONNECTED     138054   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139695   
unix  3      [ ]         STREAM     CONNECTED     139836   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     15163    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     20382    
unix  3      [ ]         STREAM     CONNECTED     139050   
unix  3      [ ]         STREAM     CONNECTED     139806   
unix  3      [ ]         STREAM     CONNECTED     138990   
unix  3      [ ]         STREAM     CONNECTED     139039   /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     59520    
unix  3      [ ]         STREAM     CONNECTED     137157   
unix  3      [ ]         STREAM     CONNECTED     18976    /run/dbus/system_bus_socket
unix  2      [ ]         DGRAM      CONNECTED     20379    
unix  3      [ ]         STREAM     CONNECTED     138160   
unix  3      [ ]         STREAM     CONNECTED     138929   
unix  3      [ ]         STREAM     CONNECTED     138033   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139763   
unix  2      [ ]         DGRAM      CONNECTED     131915   
unix  2      [ ]         DGRAM      CONNECTED     19199    
unix  3      [ ]         STREAM     CONNECTED     134370   
unix  3      [ ]         STREAM     CONNECTED     181445   
unix  3      [ ]         STREAM     CONNECTED     139059   
unix  3      [ ]         STREAM     CONNECTED     139841   
unix  3      [ ]         STREAM     CONNECTED     138172   /tmp/dbus-DqDL2zbVEk
unix  2      [ ]         DGRAM      CONNECTED     191576   
unix  3      [ ]         STREAM     CONNECTED     75406    
unix  3      [ ]         STREAM     CONNECTED     137099   
unix  3      [ ]         STREAM     CONNECTED     15259    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138173   
unix  3      [ ]         STREAM     CONNECTED     134362   
unix  3      [ ]         STREAM     CONNECTED     19900    
unix  3      [ ]         STREAM     CONNECTED     137139   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139042   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139098   
unix  2      [ ]         DGRAM      CONNECTED     23877    
unix  3      [ ]         STREAM     CONNECTED     139729   
unix  2      [ ]         DGRAM      CONNECTED     181439   
unix  3      [ ]         STREAM     CONNECTED     137158   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     139813   
unix  3      [ ]         STREAM     CONNECTED     139693   /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     22958    
unix  3      [ ]         STREAM     CONNECTED     138174   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     132666   
unix  3      [ ]         STREAM     CONNECTED     139780   
unix  3      [ ]         STREAM     CONNECTED     137169   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     138064   
unix  3      [ ]         DGRAM      CONNECTED     134341   
unix  3      [ ]         STREAM     CONNECTED     138109   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     138048   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     76196    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     182767   
unix  3      [ ]         STREAM     CONNECTED     138167   /tmp/dbus-DqDL2zbVEk
unix  3      [ ]         STREAM     CONNECTED     134344   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     139002   
unix  3      [ ]         STREAM     CONNECTED     22076    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138128   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139807   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         DGRAM      CONNECTED     133351   
unix  3      [ ]         STREAM     CONNECTED     76197    /run/systemd/journal/stdout
unix  2      [ ]         DGRAM      CONNECTED     178060   
unix  3      [ ]         STREAM     CONNECTED     191581   
unix  3      [ ]         STREAM     CONNECTED     139907   
unix  3      [ ]         STREAM     CONNECTED     138156   
unix  3      [ ]         STREAM     CONNECTED     137931   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139842   
unix  3      [ ]         STREAM     CONNECTED     137125   
unix  3      [ ]         STREAM     CONNECTED     137119   
unix  3      [ ]         STREAM     CONNECTED     20577    
unix  3      [ ]         STREAM     CONNECTED     139056   
unix  3      [ ]         STREAM     CONNECTED     139817   
unix  3      [ ]         STREAM     CONNECTED     138116   @/tmp/.X11-unix/X0
unix  2      [ ]         DGRAM      CONNECTED     138992   
unix  2      [ ]         DGRAM      CONNECTED     134324   
unix  3      [ ]         STREAM     CONNECTED     18960    
unix  3      [ ]         STREAM     CONNECTED     137984   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     137149   
unix  3      [ ]         STREAM     CONNECTED     138036   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     184481   
unix  3      [ ]         STREAM     CONNECTED     24917    
unix  2      [ ]         STREAM     CONNECTED     182166   
unix  3      [ ]         STREAM     CONNECTED     139834   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     21669    
unix  3      [ ]         STREAM     CONNECTED     137096   
unix  3      [ ]         STREAM     CONNECTED     137093   
unix  3      [ ]         STREAM     CONNECTED     15237    
unix  3      [ ]         STREAM     CONNECTED     138045   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     138743   
unix  3      [ ]         STREAM     CONNECTED     139057   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139038   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     138148   
unix  3      [ ]         STREAM     CONNECTED     139788   
unix  3      [ ]         STREAM     CONNECTED     134323   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     137148   
unix  3      [ ]         STREAM     CONNECTED     137923   
unix  3      [ ]         STREAM     CONNECTED     137168   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     133394   
unix  3      [ ]         STREAM     CONNECTED     75413    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     137084   
unix  3      [ ]         STREAM     CONNECTED     132594   
unix  3      [ ]         STREAM     CONNECTED     15160    
unix  3      [ ]         STREAM     CONNECTED     139026   
unix  3      [ ]         STREAM     CONNECTED     139815   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138910   
unix  3      [ ]         STREAM     CONNECTED     139694   /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     20386    
unix  3      [ ]         STREAM     CONNECTED     139100   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     139061   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     133404   
unix  3      [ ]         STREAM     CONNECTED     138157   
unix  3      [ ]         STREAM     CONNECTED     23442    
unix  3      [ ]         STREAM     CONNECTED     138039   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139099   
unix  3      [ ]         STREAM     CONNECTED     19035    /run/systemd/journal/stdout
unix  3      [ ]         STREAM     CONNECTED     138000   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139803   /tmp/dbus-COEPxU4mVs
unix  3      [ ]         STREAM     CONNECTED     137143   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138177   @/tmp/.X11-unix/X0
unix  3      [ ]         STREAM     CONNECTED     139790   
unix  3      [ ]         STREAM     CONNECTED     21053    
unix  3      [ ]         STREAM     CONNECTED     20506    
unix  2      [ ]         DGRAM      CONNECTED     19898    
unix  3      [ ]         STREAM     CONNECTED     137145   @/tmp/.ICE-unix/24946
unix  3      [ ]         STREAM     CONNECTED     138085   
unix  3      [ ]         STREAM     CONNECTED     23567    /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139049   
unix  3      [ ]         STREAM     CONNECTED     132604   /run/dbus/system_bus_socket
unix  3      [ ]         STREAM     CONNECTED     139853   
unix  3      [ ]         STREAM     CONNECTED     139734   
'
++ grep -vE '^[[:space:]]*(Active|Proto|Recv-Q|Send-Q|Local|Foreign|State)[[:space:]]*$'
++ grep -vE '^[[:space:]]*$'
+ connections_with_ip='tcp        0      0 192.168.56.102:22       192.168.56.106:9474     ESTABLISHED
tcp        0    112 192.168.56.102:22       192.168.56.106:23133    ESTABLISHED
tcp        0      0 192.168.56.102:22       192.168.56.106:8354     ESTABLISHED
udp        0      0 127.0.0.1:50178         127.0.0.1:50178         ESTABLISHED'
+ [[ -z tcp        0      0 192.168.56.102:22       192.168.56.106:9474     ESTABLISHED
tcp        0    112 192.168.56.102:22       192.168.56.106:23133    ESTABLISHED
tcp        0      0 192.168.56.102:22       192.168.56.106:8354     ESTABLISHED
udp        0      0 127.0.0.1:50178         127.0.0.1:50178         ESTABLISHED ]]
++ echo 'tcp        0      0 192.168.56.102:22       192.168.56.106:9474     ESTABLISHED
tcp        0    112 192.168.56.102:22       192.168.56.106:23133    ESTABLISHED
tcp        0      0 192.168.56.102:22       192.168.56.106:8354     ESTABLISHED
udp        0      0 127.0.0.1:50178         127.0.0.1:50178         ESTABLISHED'
++ wc -l
+ connection_count=4
+ [[ 4 -eq 0 ]]
+ echo Пройдена
+ exit 0

================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.450] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo systemctl is-active auditd

>>> EXIT CODE: 0

>>> STDOUT:
active


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.461] PROCESSOR SCRIPT EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 9bbe2798-bc25-4374-855e-00208ea4bc5e
Script Name: auditd active

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "sudo systemctl is-active auditd"
# Проверяем, что служба auditd активна
# Если ответ "active", то "Пройдена"

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Убираем ведущие и завершающие пробелы, переводы строк
status=$(echo "$CHECK_OUTPUT" | tr -d '\n\r' | sed 's/^[[:space:]]*//;s/[[:space:]]*$//')

# Проверяем, что статус равен "active"
if [[ "$status" == "active" ]]; then
    echo "Пройдена"
    exit 0
else
... (total 25 lines, 675 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 7 chars, 2 lines:
active


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 0 (SUCCESS)

>>> STDOUT (9 chars):
Пройдена


>>> STDERR (193 chars):
+ set -eo pipefail
+ '[' -z 'active
' ']'
++ echo 'active
'
++ tr -d '\n\r'
++ sed 's/^[[:space:]]*//;s/[[:space:]]*$//'
+ status=active
+ [[ active == \a\c\t\i\v\e ]]
+ echo Пройдена
+ exit 0

================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.596] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /var/log/audit/audit.log | tail -n 50

>>> EXIT CODE: 0

>>> STDOUT:
type=USER_END msg=audit(1763116626.987:13569): pid=31590 uid=0 auid=1000 ses=1007 subj=0:63:0:0 msg='op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_DISP msg=audit(1763116626.987:13570): pid=31590 uid=0 auid=1000 ses=1007 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_CMD msg=audit(1763116627.015:13571): pid=31608 uid=1000 auid=1000 ses=1008 subj=0:63:0:0 msg='cwd="/home/user" cmd=636174202F6574632F736563757265747479 terminal=? res=success'
type=CRED_REFR msg=audit(1763116627.015:13572): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_START msg=audit(1763116627.015:13573): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_END msg=audit(1763116627.019:13574): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=CRED_DISP msg=audit(1763116627.019:13575): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_AUTH msg=audit(1763116627.083:13576): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_ACCT msg=audit(1763116627.087:13577): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.091:13578): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=LOGIN msg=audit(1763116627.091:13579): pid=31610 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1009 res=1
type=SYSCALL msg=audit(1763116627.091:13579): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7ffca5915a00 a2=4 a3=871 items=0 ppid=1386 pid=31610 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1009 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.091:13579): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.107:13580): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.107:13581): pid=31615 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_END msg=audit(1763116627.131:13582): pid=31598 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_DISP msg=audit(1763116627.131:13583): pid=31598 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_CMD msg=audit(1763116627.159:13584): pid=31620 uid=1000 auid=1000 ses=1009 subj=0:63:0:0 msg='cwd="/home/user" cmd=6E657473746174202D6E terminal=? res=success'
type=CRED_REFR msg=audit(1763116627.159:13585): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_START msg=audit(1763116627.159:13586): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_END msg=audit(1763116627.167:13587): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=CRED_DISP msg=audit(1763116627.167:13588): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_AUTH msg=audit(1763116627.247:13589): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_ACCT msg=audit(1763116627.251:13590): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.255:13591): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=LOGIN msg=audit(1763116627.255:13592): pid=31622 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1010 res=1
type=SYSCALL msg=audit(1763116627.255:13592): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7fff26ba7f30 a2=4 a3=871 items=0 ppid=1386 pid=31622 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1010 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.255:13592): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.275:13593): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.275:13594): pid=31627 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_END msg=audit(1763116627.283:13595): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_DISP msg=audit(1763116627.283:13596): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_CMD msg=audit(1763116627.327:13597): pid=31632 uid=1000 auid=1000 ses=1010 subj=0:63:0:0 msg='cwd="/home/user" cmd=73797374656D63746C2069732D61637469766520617564697464 terminal=? res=success'
type=CRED_REFR msg=audit(1763116627.327:13598): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_START msg=audit(1763116627.327:13599): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_END msg=audit(1763116627.331:13600): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=CRED_DISP msg=audit(1763116627.331:13601): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_AUTH msg=audit(1763116627.395:13602): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_ACCT msg=audit(1763116627.395:13603): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.399:13604): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=LOGIN msg=audit(1763116627.399:13605): pid=31634 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1011 res=1
type=SYSCALL msg=audit(1763116627.399:13605): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7ffea984c9a0 a2=4 a3=871 items=0 ppid=1386 pid=31634 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1011 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.399:13605): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.415:13606): pid=31634 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.415:13607): pid=31639 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_END msg=audit(1763116627.447:13608): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_DISP msg=audit(1763116627.447:13609): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_CMD msg=audit(1763116627.467:13610): pid=31645 uid=1000 auid=1000 ses=1011 subj=0:63:0:0 msg='cwd="/home/user" cmd=636174202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=? res=success'
type=CRED_REFR msg=audit(1763116627.467:13611): pid=31645 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_START msg=audit(1763116627.467:13612): pid=31645 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.616] PROCESSOR SCRIPT EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Script ID: ff558989-08d5-4a27-8dcd-6764beebf0cc
Script Name: audit log 90 days

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "cat /var/log/audit/audit.log" (или "sudo cat /var/log/audit/audit.log")
# Проверяем, что в журнале содержатся события за последние 90 дней
# Формат audit.log: type=... msg=audit(1234567890.123:456): ... где 1234567890.123 - Unix timestamp

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Вычисляем timestamp для даты 90 дней назад
# Получаем текущий timestamp и вычитаем 90 дней (в секундах)
current_timestamp=$(date +%s)
days_ago_90=$((current_timestamp - 90 * 24 * 60 * 60))

# Извлекаем все timestamps из лог-файла
# Формат: msg=audit(1234567890.123:456): где 1234567890.123 - timestamp
# Используем grep для поиска всех строк с msg=audit(...) и извлекаем timestamp
... (total 54 lines, 1746 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 10315 chars, 51 lines:
type=USER_END msg=audit(1763116626.987:13569): pid=31590 uid=0 auid=1000 ses=1007 subj=0:63:0:0 msg='op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_DISP msg=audit(1763116626.987:13570): pid=31590 uid=0 auid=1000 ses=1007 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_CMD msg=audit(1763116627.015:13571): pid=31608 uid=1000 auid=1000 ses=1008 subj=0:63:0:0 msg='cwd="/home/user" cmd=636174202F6574632F736563757265747479 terminal=? res=success'
type=CRED_REFR msg=audit(1763116627.015:13572): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_START msg=audit(1763116627.015:13573): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_END msg=audit(1763116627.019:13574): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=CRED_DISP msg=audit(1763116627.019:13575): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_AUTH msg=audit(1763116627.083:13576): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_ACCT msg=audit(1763116627.087:13577): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.091:13578): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=LOGIN msg=audit(1763116627.091:13579): pid=31610 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1009 res=1
type=SYSCALL msg=audit(1763116627.091:13579): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7ffca5915a00 a2=4 a3=871 items=0 ppid=1386 pid=31610 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1009 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.091:13579): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.107:13580): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.107:13581): pid=31615 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_END msg=audit(1763116627.131:13582): pid=31598 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_DISP msg=audit(1763116627.131:13583): pid=31598 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_CMD msg=audit(1763116627.159:13584): pid=31620 uid=1000 auid=1000 ses=1009 subj=0:63:0:0 msg='cwd="/home/user" cmd=6E657473746174202D6E terminal=? res=success'
type=CRED_REFR msg=audit(1763116627.159:13585): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_START msg=audit(1763116627.159:13586): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_END msg=audit(1763116627.167:13587): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=CRED_DISP msg=audit(1763116627.167:13588): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_AUTH msg=audit(1763116627.247:13589): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_ACCT msg=audit(1763116627.251:13590): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.255:13591): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=LOGIN msg=audit(1763116627.255:13592): pid=31622 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1010 res=1
type=SYSCALL msg=audit(1763116627.255:13592): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7fff26ba7f30 a2=4 a3=871 items=0 ppid=1386 pid=31622 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1010 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.255:13592): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.275:13593): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.275:13594): pid=31627 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_END msg=audit(1763116627.283:13595): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_DISP msg=audit(1763116627.283:13596): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_CMD msg=audit(1763116627.327:13597): pid=31632 uid=1000 auid=1000 ses=1010 subj=0:63:0:0 msg='cwd="/home/user" cmd=73797374656D63746C2069732D61637469766520617564697464 terminal=? res=success'
type=CRED_REFR msg=audit(1763116627.327:13598): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_START msg=audit(1763116627.327:13599): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_END msg=audit(1763116627.331:13600): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=CRED_DISP msg=audit(1763116627.331:13601): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_AUTH msg=audit(1763116627.395:13602): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_ACCT msg=audit(1763116627.395:13603): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.399:13604): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=LOGIN msg=audit(1763116627.399:13605): pid=31634 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1011 res=1
type=SYSCALL msg=audit(1763116627.399:13605): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7ffea984c9a0 a2=4 a3=871 items=0 ppid=1386 pid=31634 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1011 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.399:13605): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.415:13606): pid=31634 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_ACQ msg=audit(1763116627.415:13607): pid=31639 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_END msg=audit(1763116627.447:13608): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=CRED_DISP msg=audit(1763116627.447:13609): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'
type=USER_CMD msg=audit(1763116627.467:13610): pid=31645 uid=1000 auid=1000 ses=1011 subj=0:63:0:0 msg='cwd="/home/user" cmd=636174202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=? res=success'
type=CRED_REFR msg=audit(1763116627.467:13611): pid=31645 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'
type=USER_START msg=audit(1763116627.467:13612): pid=31645 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 0 (SUCCESS)

>>> STDOUT (9 chars):
Пройдена


>>> STDERR (22660 chars):
+ set -eo pipefail
+ '[' -z 'type=USER_END msg=audit(1763116626.987:13569): pid=31590 uid=0 auid=1000 ses=1007 subj=0:63:0:0 msg='\''op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_DISP msg=audit(1763116626.987:13570): pid=31590 uid=0 auid=1000 ses=1007 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_CMD msg=audit(1763116627.015:13571): pid=31608 uid=1000 auid=1000 ses=1008 subj=0:63:0:0 msg='\''cwd="/home/user" cmd=636174202F6574632F736563757265747479 terminal=? res=success'\''
type=CRED_REFR msg=audit(1763116627.015:13572): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_START msg=audit(1763116627.015:13573): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_END msg=audit(1763116627.019:13574): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=CRED_DISP msg=audit(1763116627.019:13575): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_AUTH msg=audit(1763116627.083:13576): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_ACCT msg=audit(1763116627.087:13577): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.091:13578): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=LOGIN msg=audit(1763116627.091:13579): pid=31610 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1009 res=1
type=SYSCALL msg=audit(1763116627.091:13579): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7ffca5915a00 a2=4 a3=871 items=0 ppid=1386 pid=31610 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1009 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.091:13579): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.107:13580): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.107:13581): pid=31615 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_END msg=audit(1763116627.131:13582): pid=31598 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_DISP msg=audit(1763116627.131:13583): pid=31598 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_CMD msg=audit(1763116627.159:13584): pid=31620 uid=1000 auid=1000 ses=1009 subj=0:63:0:0 msg='\''cwd="/home/user" cmd=6E657473746174202D6E terminal=? res=success'\''
type=CRED_REFR msg=audit(1763116627.159:13585): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_START msg=audit(1763116627.159:13586): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_END msg=audit(1763116627.167:13587): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=CRED_DISP msg=audit(1763116627.167:13588): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_AUTH msg=audit(1763116627.247:13589): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_ACCT msg=audit(1763116627.251:13590): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.255:13591): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=LOGIN msg=audit(1763116627.255:13592): pid=31622 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1010 res=1
type=SYSCALL msg=audit(1763116627.255:13592): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7fff26ba7f30 a2=4 a3=871 items=0 ppid=1386 pid=31622 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1010 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.255:13592): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.275:13593): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.275:13594): pid=31627 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_END msg=audit(1763116627.283:13595): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_DISP msg=audit(1763116627.283:13596): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_CMD msg=audit(1763116627.327:13597): pid=31632 uid=1000 auid=1000 ses=1010 subj=0:63:0:0 msg='\''cwd="/home/user" cmd=73797374656D63746C2069732D61637469766520617564697464 terminal=? res=success'\''
type=CRED_REFR msg=audit(1763116627.327:13598): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_START msg=audit(1763116627.327:13599): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_END msg=audit(1763116627.331:13600): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=CRED_DISP msg=audit(1763116627.331:13601): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_AUTH msg=audit(1763116627.395:13602): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_ACCT msg=audit(1763116627.395:13603): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.399:13604): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=LOGIN msg=audit(1763116627.399:13605): pid=31634 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1011 res=1
type=SYSCALL msg=audit(1763116627.399:13605): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7ffea984c9a0 a2=4 a3=871 items=0 ppid=1386 pid=31634 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1011 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.399:13605): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.415:13606): pid=31634 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='\''op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.415:13607): pid=31639 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_END msg=audit(1763116627.447:13608): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_DISP msg=audit(1763116627.447:13609): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_CMD msg=audit(1763116627.467:13610): pid=31645 uid=1000 auid=1000 ses=1011 subj=0:63:0:0 msg='\''cwd="/home/user" cmd=636174202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=? res=success'\''
type=CRED_REFR msg=audit(1763116627.467:13611): pid=31645 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_START msg=audit(1763116627.467:13612): pid=31645 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='\''op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
' ']'
++ date +%s
+ current_timestamp=1770807178
+ days_ago_90=1763031178
++ grep -oE 'msg=audit\([0-9]+\.[0-9]+:[0-9]+\)'
++ echo 'type=USER_END msg=audit(1763116626.987:13569): pid=31590 uid=0 auid=1000 ses=1007 subj=0:63:0:0 msg='\''op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_DISP msg=audit(1763116626.987:13570): pid=31590 uid=0 auid=1000 ses=1007 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_CMD msg=audit(1763116627.015:13571): pid=31608 uid=1000 auid=1000 ses=1008 subj=0:63:0:0 msg='\''cwd="/home/user" cmd=636174202F6574632F736563757265747479 terminal=? res=success'\''
type=CRED_REFR msg=audit(1763116627.015:13572): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_START msg=audit(1763116627.015:13573): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_END msg=audit(1763116627.019:13574): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=CRED_DISP msg=audit(1763116627.019:13575): pid=31608 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_AUTH msg=audit(1763116627.083:13576): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_ACCT msg=audit(1763116627.087:13577): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.091:13578): pid=31610 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=LOGIN msg=audit(1763116627.091:13579): pid=31610 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1009 res=1
type=SYSCALL msg=audit(1763116627.091:13579): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7ffca5915a00 a2=4 a3=871 items=0 ppid=1386 pid=31610 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1009 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.091:13579): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.107:13580): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.107:13581): pid=31615 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_END msg=audit(1763116627.131:13582): pid=31598 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_DISP msg=audit(1763116627.131:13583): pid=31598 uid=0 auid=1000 ses=1008 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_CMD msg=audit(1763116627.159:13584): pid=31620 uid=1000 auid=1000 ses=1009 subj=0:63:0:0 msg='\''cwd="/home/user" cmd=6E657473746174202D6E terminal=? res=success'\''
type=CRED_REFR msg=audit(1763116627.159:13585): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_START msg=audit(1763116627.159:13586): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_END msg=audit(1763116627.167:13587): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=CRED_DISP msg=audit(1763116627.167:13588): pid=31620 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_AUTH msg=audit(1763116627.247:13589): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_ACCT msg=audit(1763116627.251:13590): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.255:13591): pid=31622 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=LOGIN msg=audit(1763116627.255:13592): pid=31622 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1010 res=1
type=SYSCALL msg=audit(1763116627.255:13592): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7fff26ba7f30 a2=4 a3=871 items=0 ppid=1386 pid=31622 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1010 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.255:13592): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.275:13593): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.275:13594): pid=31627 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_END msg=audit(1763116627.283:13595): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_DISP msg=audit(1763116627.283:13596): pid=31610 uid=0 auid=1000 ses=1009 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_CMD msg=audit(1763116627.327:13597): pid=31632 uid=1000 auid=1000 ses=1010 subj=0:63:0:0 msg='\''cwd="/home/user" cmd=73797374656D63746C2069732D61637469766520617564697464 terminal=? res=success'\''
type=CRED_REFR msg=audit(1763116627.327:13598): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_START msg=audit(1763116627.327:13599): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_END msg=audit(1763116627.331:13600): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:session_close acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=CRED_DISP msg=audit(1763116627.331:13601): pid=31632 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_AUTH msg=audit(1763116627.395:13602): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:authentication acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_ACCT msg=audit(1763116627.395:13603): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:accounting acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.399:13604): pid=31634 uid=0 auid=4294967295 ses=4294967295 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=LOGIN msg=audit(1763116627.399:13605): pid=31634 uid=0 subj=0:63:0:0 old-auid=4294967295 auid=1000 tty=(none) old-ses=4294967295 ses=1011 res=1
type=SYSCALL msg=audit(1763116627.399:13605): arch=c000003e syscall=1 success=yes exit=4 a0=4 a1=7ffea984c9a0 a2=4 a3=871 items=0 ppid=1386 pid=31634 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=1011 comm="sshd" exe="/usr/sbin/sshd" subj=0:63:0:0 key=(null)
type=PROCTITLE msg=audit(1763116627.399:13605): proctitle=737368643A2075736572205B707269765D
type=USER_START msg=audit(1763116627.415:13606): pid=31634 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='\''op=PAM:session_open acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_ACQ msg=audit(1763116627.415:13607): pid=31639 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=USER_END msg=audit(1763116627.447:13608): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:session_close acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
type=CRED_DISP msg=audit(1763116627.447:13609): pid=31622 uid=0 auid=1000 ses=1010 subj=0:63:0:0 msg='\''op=PAM:setcred acct="user" exe="/usr/sbin/sshd" hostname=192.168.56.106 addr=192.168.56.106 terminal=ssh res=success'\''
++ sed -E 's/msg=audit\(([0-9]+)\.[0-9]+:[0-9]+\)/\1/'
type=USER_CMD msg=audit(1763116627.467:13610): pid=31645 uid=1000 auid=1000 ses=1011 subj=0:63:0:0 msg='\''cwd="/home/user" cmd=636174202F7661722F6C6F672F61756469742F61756469742E6C6F67 terminal=? res=success'\''
type=CRED_REFR msg=audit(1763116627.467:13611): pid=31645 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='\''op=PAM:setcred acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
type=USER_START msg=audit(1763116627.467:13612): pid=31645 uid=0 auid=1000 ses=1011 subj=0:63:0:0 msg='\''op=PAM:session_open acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=? res=success'\''
'
+ timestamps='1763116626
1763116626
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627'
+ [[ -z 1763116626
1763116626
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627
1763116627 ]]
+ found_recent_event=false
+ IFS=
+ read -r timestamp_str
+ [[ -z 1763116626 ]]
+ [[ 1763116626 -ge 1763031178 ]]
+ found_recent_event=true
+ break
+ [[ true == true ]]
+ echo Пройдена
+ exit 0

================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.746] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/sudoers

>>> EXIT CODE: 0

>>> STDOUT:
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL


>>> STDERR:
(empty)
================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.837] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 37e69f41-4d0b-4e42-8cd5-3326b8ffdb62
Script Name: /etc/sudoers groups

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "cat /etc/sudoers"
# ETALON_INPUT — эталонный список групп безопасности
# Необходимо получить список групп безопасности, имеющих полномочия на применение команды sudo
# Список групп приводится после строки "#includedir /etc/sudoers.d"
# Формат: %astra-admin    ALL=(ALL:ALL) NOPASSWD: ALL
# Сравнить с эталонным списком и вывести ACTUAL_DATA: value1, value2

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

if [ -z "${ETALON_INPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Находим строку "#includedir /etc/sudoers.d" (может быть с пробелами после #)
... (total 139 lines, 4914 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 710 chars, 29 lines:
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL


>>> REFERENCE DATA (ETALON_INPUT) - 24 chars, 4 lines:
group1
gorpu2
root
cdrom

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (25 chars):
ACTUAL_DATA: astra-admin


>>> STDERR (6544 chars):
+ set -eo pipefail
+ '[' -z '#
# This file MUST be edited with the '\''visudo'\'' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL
' ']'
+ '[' -z 'group1
gorpu2
root
cdrom' ']'
+ found_includedir=false
+ groups_after_includedir=
+ IFS=
+ read -r line
+ echo '#'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# This file MUST be edited with the '\''visudo'\'' command as root.'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '#'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# Please consider adding local content in /etc/sudoers.d/ instead of'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# directly modifying this file.'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '#'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# See the man page for details on how to write a sudoers file.'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '#'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo 'Defaults	env_reset'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo 'Defaults	mail_badpass'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo 'Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# Host alias specification'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# User alias specification'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# Cmnd alias specification'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# User privilege specification'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo 'root	ALL=(ALL:ALL) ALL'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# Allow members of group sudo to execute any command'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '%sudo	ALL=(ALL:ALL) ALL'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# See sudoers(5) for more information on "#include" directives:'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '#includedir /etc/sudoers.d'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ found_includedir=true
+ continue
+ IFS=
+ read -r line
+ echo '%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ true == true ]]
+ echo '%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
+ grep -qE '^[[:space:]]*%'
++ echo '%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
++ sed -E 's/^[[:space:]]*%([a-zA-Z0-9_-]+).*/\1/'
+ group_name=astra-admin
+ [[ -n astra-admin ]]
+ [[ -z '' ]]
+ groups_after_includedir=astra-admin
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ true == true ]]
+ echo ''
+ grep -qE '^[[:space:]]*%'
+ IFS=
+ read -r line
+ [[ true == false ]]
+ [[ -z astra-admin ]]
++ echo astra-admin
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ actual_groups=astra-admin
+ echo 'ACTUAL_DATA: astra-admin'
++ normalize 'group1
gorpu2
root
cdrom'
++ local 'input=group1
gorpu2
root
cdrom'
++ echo 'group1
gorpu2
root
cdrom'
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ expected_normalized=cdrom,gorpu2,group1,root
++ normalize astra-admin
++ local input=astra-admin
++ echo astra-admin
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ actual_normalized=astra-admin
+ IFS=,
+ read -ra expected_array
+ IFS=,
+ read -ra actual_array
+ expected_count=4
+ actual_count=1
+ [[ 4 -ne 1 ]]
+ exit 44

================================================================================

2026-02-11 10:52:58 [INFO] 
================================================================================
[2026-02-11 10:52:58.974] SSH COMMAND EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo /opt/kaspersky/klnagent64/bin/klnagchk

>>> EXIT CODE: 1

>>> STDOUT:
(empty)

>>> STDERR:
sudo: /opt/kaspersky/klnagent64/bin/klnagchk: command not found

================================================================================

2026-02-11 10:52:59 [INFO] 
================================================================================
[2026-02-11 10:52:59.354] SSH COMMAND EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo kesl-control --app-info

>>> EXIT CODE: 1

>>> STDOUT:
(empty)

>>> STDERR:
sudo: kesl-control: command not found

================================================================================

2026-02-11 10:52:59 [INFO] 
================================================================================
[2026-02-11 10:52:59.806] PROCESSOR SCRIPT EXECUTION - SUCCESS
Host: Windows Server 1 (192.168.56.103:5985)
Script ID: 98d75646-ac4d-4b42-8fa3-310390dbd09c
Script Name: test1

>>> PROCESSOR SCRIPT (preview):
echo 'Оператор'

>>> INPUT DATA (CHECK_OUTPUT) - 10 chars, 2 lines:
test\user


>>> REFERENCE DATA (ETALON_INPUT) - 0 chars, 1 lines:
(empty)

>>> EXIT CODE: 0 (SUCCESS)

>>> STDOUT (9 chars):
Оператор


>>> STDERR (16 chars):
+ echo Оператор

================================================================================

2026-02-11 10:59:43 [INFO] 
================================================================================
[2026-02-11 10:59:43.093] SSH CONNECTION: login - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user
Auth Type: password
Connection Type: ssh
================================================================================

2026-02-11 10:59:43 [INFO] 
================================================================================
[2026-02-11 10:59:43.310] SSH CHECK: SUDO - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo -n id

>>> EXIT CODE: 0

>>> STDOUT:
uid=0(root) gid=0(root) группы=0(root)

================================================================================

2026-02-11 10:59:43 [INFO] 
================================================================================
[2026-02-11 10:59:43.448] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
echo 'IyEvdXNyL2Jpbi9lbnYgYmFzaAoKCmNhdCAvZXRjL2hvc3Rz' | base64 -d > /tmp/ib_profile_f0baacd17b47.sh && chmod +x /tmp/ib_profile_f0baacd17b47.sh && sudo -n bash /tmp/ib_profile_f0baacd17b47.sh; rc=$?; rm -f /tmp/ib_profile_f0baacd17b47.sh; exit $rc

>>> EXIT CODE: 0

>>> STDOUT:
127.0.0.1	localhost
127.0.1.1	astra

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters


>>> STDERR:
(empty)
================================================================================

