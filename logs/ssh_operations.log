[2026-02-04 11:22:31.843] SSH LOG FILE CLEARED - Starting new project execution
================================================================================

2026-02-04 11:22:31 [INFO] SSH log file cleared at 2026-02-04 11:22:31.843
2026-02-04 11:22:31 [INFO] 
================================================================================
[2026-02-04 11:22:31.926] SSH CONNECTION: login - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user
Auth Type: password
Connection Type: ssh
================================================================================

2026-02-04 11:22:32 [INFO] 
================================================================================
[2026-02-04 11:22:32.070] SSH CHECK: SUDO - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo -n id

>>> EXIT CODE: 0

>>> STDOUT:
uid=0(root) gid=0(root) группы=0(root)

================================================================================

2026-02-04 11:22:32 [INFO] 
================================================================================
[2026-02-04 11:22:32.200] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/sssd/sssd.conf

>>> EXIT CODE: 0

>>> STDOUT:
[sssd]
config_version=2
services = pam

[domain/ad.example.com]
auth_provider = ad

#simple_allow_users = user1,user2,user3
simple_allow_groups = group1,group1,group3


>>> STDERR:
(empty)
================================================================================

2026-02-04 11:22:32 [INFO] 
================================================================================
[2026-02-04 11:22:32.221] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 9d1c22b4-713e-4b7f-ba5c-1385c25bf586
Script Name: sssd.conf

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash
set -euo pipefail

# CHECK_OUTPUT — уже содержит вывод команды с хоста
# ETALON_INPUT — эталонные данные

if [[ -z "${CHECK_OUTPUT:-}" ]]; then
exit 5001 # Отсутствует переменная
fi

if [[ -z "${ETALON_INPUT:-}" ]]; then
exit 5001
fi

# Ищем строку в полученных данных (НЕ в файле!)
# ИСПРАВЛЕНИЕ: добавили [^#] чтобы исключить закомментированные строки
line="$(echo "$CHECK_OUTPUT" | grep -E '^[[:space:]]*[^#]simple_allow_users[[:space:]]*=' || true)"

if [[ -z "$line" ]]; then
# Проверим, может закомментирована
... (total 38 lines, 1002 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 167 chars, 10 lines:
[sssd]
config_version=2
services = pam

[domain/ad.example.com]
auth_provider = ad

#simple_allow_users = user1,user2,user3
simple_allow_groups = group1,group1,group3


>>> REFERENCE DATA (ETALON_INPUT) - 11 chars, 2 lines:
user1
user2

>>> EXIT CODE: 162 (Signal 34)

>>> STDOUT (0 chars):
(empty)

>>> STDERR (0 chars):
(empty)
================================================================================

