[2026-02-05 08:58:52.038] SSH LOG FILE CLEARED - Starting new project execution
================================================================================

2026-02-05 08:58:52 [INFO] SSH log file cleared at 2026-02-05 08:58:52.038
2026-02-05 08:58:52 [INFO] 
================================================================================
[2026-02-05 08:58:52.121] SSH CONNECTION: login - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user
Auth Type: password
Connection Type: ssh
================================================================================

2026-02-05 08:58:52 [INFO] 
================================================================================
[2026-02-05 08:58:52.226] SSH CHECK: SUDO - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo -n id

>>> EXIT CODE: 0

>>> STDOUT:
uid=0(root) gid=0(root) группы=0(root)

================================================================================

2026-02-05 08:58:52 [INFO] 
================================================================================
[2026-02-05 08:58:52.326] SSH COMMAND EXECUTION - SUCCESS
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo cat /etc/sudoers

>>> EXIT CODE: 0

>>> STDOUT:
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL


>>> STDERR:
(empty)
================================================================================

2026-02-05 08:58:52 [INFO] 
================================================================================
[2026-02-05 08:58:52.419] PROCESSOR SCRIPT EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Script ID: 37e69f41-4d0b-4e42-8cd5-3326b8ffdb62
Script Name: /etc/sudoers groups

>>> PROCESSOR SCRIPT (preview):
#!/usr/bin/env bash

set -eo pipefail

# CHECK_OUTPUT — вывод команды "cat /etc/sudoers"
# ETALON_INPUT — эталонный список групп безопасности
# Необходимо получить список групп безопасности, имеющих полномочия на применение команды sudo
# Список групп приводится после строки "#includedir /etc/sudoers.d"
# Формат: %astra-admin    ALL=(ALL:ALL) NOPASSWD: ALL
# Сравнить с эталонным списком и вывести ACTUAL_DATA: value1, value2

if [ -z "${CHECK_OUTPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

if [ -z "${ETALON_INPUT:-}" ]; then
    exit 51 # Отсутствует переменная
fi

# Находим строку "#includedir /etc/sudoers.d" (может быть с пробелами после #)
... (total 139 lines, 4914 chars)

>>> INPUT DATA (CHECK_OUTPUT) - 710 chars, 29 lines:
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL


>>> REFERENCE DATA (ETALON_INPUT) - 16 chars, 2 lines:
astra-admin
root

>>> EXIT CODE: 44 (Неверное значение)

>>> STDOUT (25 chars):
ACTUAL_DATA: astra-admin


>>> STDERR (6504 chars):
+ set -eo pipefail
+ '[' -z '#
# This file MUST be edited with the '\''visudo'\'' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root	ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo	ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL
' ']'
+ '[' -z 'astra-admin
root' ']'
+ found_includedir=false
+ groups_after_includedir=
+ IFS=
+ read -r line
+ echo '#'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# This file MUST be edited with the '\''visudo'\'' command as root.'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '#'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# Please consider adding local content in /etc/sudoers.d/ instead of'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# directly modifying this file.'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '#'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# See the man page for details on how to write a sudoers file.'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '#'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo 'Defaults	env_reset'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo 'Defaults	mail_badpass'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo 'Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# Host alias specification'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# User alias specification'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# Cmnd alias specification'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# User privilege specification'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo 'root	ALL=(ALL:ALL) ALL'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# Allow members of group sudo to execute any command'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '%sudo	ALL=(ALL:ALL) ALL'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '# See sudoers(5) for more information on "#include" directives:'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ false == true ]]
+ IFS=
+ read -r line
+ echo '#includedir /etc/sudoers.d'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ found_includedir=true
+ continue
+ IFS=
+ read -r line
+ echo '%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ true == true ]]
+ echo '%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
+ grep -qE '^[[:space:]]*%'
++ echo '%astra-admin	ALL=(ALL:ALL) NOPASSWD: ALL'
++ sed -E 's/^[[:space:]]*%([a-zA-Z0-9_-]+).*/\1/'
+ group_name=astra-admin
+ [[ -n astra-admin ]]
+ [[ -z '' ]]
+ groups_after_includedir=astra-admin
+ IFS=
+ read -r line
+ echo ''
+ grep -qE '^[[:space:]]*#[[:space:]]*includedir[[:space:]]+/etc/sudoers\.d'
+ [[ true == true ]]
+ echo ''
+ grep -qE '^[[:space:]]*%'
+ IFS=
+ read -r line
+ [[ true == false ]]
+ [[ -z astra-admin ]]
++ echo astra-admin
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ actual_groups=astra-admin
+ echo 'ACTUAL_DATA: astra-admin'
++ normalize 'astra-admin
root'
++ local 'input=astra-admin
root'
++ echo 'astra-admin
root'
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ expected_normalized=astra-admin,root
++ normalize astra-admin
++ local input=astra-admin
++ echo astra-admin
++ tr '\n\t ' ,
++ sed 's/,,*/,/g'
++ sed 's/^,\|,$//g'
++ awk -F, '{for(i=1;i<=NF;i++) if($i!="") print $i}'
++ sort -u
++ tr '\n' ,
++ sed 's/,$//'
+ actual_normalized=astra-admin
+ IFS=,
+ read -ra expected_array
+ IFS=,
+ read -ra actual_array
+ expected_count=2
+ actual_count=1
+ [[ 2 -ne 1 ]]
+ exit 44

================================================================================

2026-02-05 08:58:52 [INFO] 
================================================================================
[2026-02-05 08:58:52.519] SSH COMMAND EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo /opt/kaspersky/klnagent64/bin/klnagchk

>>> EXIT CODE: 1

>>> STDOUT:
(empty)

>>> STDERR:
sudo: /opt/kaspersky/klnagent64/bin/klnagchk: command not found

================================================================================

2026-02-05 08:58:52 [INFO] 
================================================================================
[2026-02-05 08:58:52.619] SSH COMMAND EXECUTION - FAILED
Host: Linux Server 1 (192.168.56.102:22)
Username: user

>>> COMMAND SENT:
sudo kesl-control --app-info

>>> EXIT CODE: 1

>>> STDOUT:
(empty)

>>> STDERR:
sudo: kesl-control: command not found

================================================================================

